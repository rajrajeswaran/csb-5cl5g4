parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"D9Nj":[function(require,module,exports) {

},{}],"YA3p":[function(require,module,exports) {
module.exports=t;var i=null;try{i=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(L){}function t(i,t,n){this.low=0|i,this.high=0|t,this.unsigned=!!n}function n(i){return!0===(i&&i.__isLong__)}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0}),t.isLong=n;var h={},s={};function e(i,t){var n,e,r;return t?(r=0<=(i>>>=0)&&i<256)&&(e=s[i])?e:(n=u(i,(0|i)<0?-1:0,!0),r&&(s[i]=n),n):(r=-128<=(i|=0)&&i<128)&&(e=h[i])?e:(n=u(i,i<0?-1:0,!1),r&&(h[i]=n),n)}function r(i,t){if(isNaN(i))return t?N:m;if(t){if(i<0)return N;if(i>=c)return p}else{if(i<=-w)return _;if(i+1>=w)return q}return i<0?r(-i,t).neg():u(i%d|0,i/d|0,t)}function u(i,n,h){return new t(i,n,h)}t.fromInt=e,t.fromNumber=r,t.fromBits=u;var o=Math.pow;function g(i,t,n){if(0===i.length)throw Error("empty string");if("NaN"===i||"Infinity"===i||"+Infinity"===i||"-Infinity"===i)return m;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var h;if((h=i.indexOf("-"))>0)throw Error("interior hyphen");if(0===h)return g(i.substring(1),t,n).neg();for(var s=r(o(n,8)),e=m,u=0;u<i.length;u+=8){var f=Math.min(8,i.length-u),l=parseInt(i.substring(u,u+f),n);if(f<8){var a=r(o(n,f));e=e.mul(a).add(r(l))}else e=(e=e.mul(s)).add(r(l))}return e.unsigned=t,e}function f(i,t){return"number"==typeof i?r(i,t):"string"==typeof i?g(i,t):u(i.low,i.high,"boolean"==typeof t?t:i.unsigned)}t.fromString=g,t.fromValue=f;var l=65536,a=1<<24,d=l*l,c=d*d,w=c/2,v=e(a),m=e(0);t.ZERO=m;var N=e(0,!0);t.UZERO=N;var E=e(1);t.ONE=E;var y=e(1,!0);t.UONE=y;var b=e(-1);t.NEG_ONE=b;var q=u(-1,2147483647,!1);t.MAX_VALUE=q;var p=u(-1,-1,!0);t.MAX_UNSIGNED_VALUE=p;var _=u(0,-2147483648,!1);t.MIN_VALUE=_;var B=t.prototype;B.toInt=function(){return this.unsigned?this.low>>>0:this.low},B.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},B.toString=function(i){if((i=i||10)<2||36<i)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(_)){var t=r(i),n=this.div(t),h=n.mul(t).sub(this);return n.toString(i)+h.toInt().toString(i)}return"-"+this.neg().toString(i)}for(var s=r(o(i,6),this.unsigned),e=this,u="";;){var g=e.div(s),f=(e.sub(g.mul(s)).toInt()>>>0).toString(i);if((e=g).isZero())return f+u;for(;f.length<6;)f="0"+f;u=""+f+u}},B.getHighBits=function(){return this.high},B.getHighBitsUnsigned=function(){return this.high>>>0},B.getLowBits=function(){return this.low},B.getLowBitsUnsigned=function(){return this.low>>>0},B.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var i=0!=this.high?this.high:this.low,t=31;t>0&&0==(i&1<<t);t--);return 0!=this.high?t+33:t+1},B.isZero=function(){return 0===this.high&&0===this.low},B.eqz=B.isZero,B.isNegative=function(){return!this.unsigned&&this.high<0},B.isPositive=function(){return this.unsigned||this.high>=0},B.isOdd=function(){return 1==(1&this.low)},B.isEven=function(){return 0==(1&this.low)},B.equals=function(i){return n(i)||(i=f(i)),(this.unsigned===i.unsigned||this.high>>>31!=1||i.high>>>31!=1)&&(this.high===i.high&&this.low===i.low)},B.eq=B.equals,B.notEquals=function(i){return!this.eq(i)},B.neq=B.notEquals,B.ne=B.notEquals,B.lessThan=function(i){return this.comp(i)<0},B.lt=B.lessThan,B.lessThanOrEqual=function(i){return this.comp(i)<=0},B.lte=B.lessThanOrEqual,B.le=B.lessThanOrEqual,B.greaterThan=function(i){return this.comp(i)>0},B.gt=B.greaterThan,B.greaterThanOrEqual=function(i){return this.comp(i)>=0},B.gte=B.greaterThanOrEqual,B.ge=B.greaterThanOrEqual,B.compare=function(i){if(n(i)||(i=f(i)),this.eq(i))return 0;var t=this.isNegative(),h=i.isNegative();return t&&!h?-1:!t&&h?1:this.unsigned?i.high>>>0>this.high>>>0||i.high===this.high&&i.low>>>0>this.low>>>0?-1:1:this.sub(i).isNegative()?-1:1},B.comp=B.compare,B.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(E)},B.neg=B.negate,B.add=function(i){n(i)||(i=f(i));var t=this.high>>>16,h=65535&this.high,s=this.low>>>16,e=65535&this.low,r=i.high>>>16,o=65535&i.high,g=i.low>>>16,l=0,a=0,d=0,c=0;return d+=(c+=e+(65535&i.low))>>>16,a+=(d+=s+g)>>>16,l+=(a+=h+o)>>>16,l+=t+r,u((d&=65535)<<16|(c&=65535),(l&=65535)<<16|(a&=65535),this.unsigned)},B.subtract=function(i){return n(i)||(i=f(i)),this.add(i.neg())},B.sub=B.subtract,B.multiply=function(t){if(this.isZero())return m;if(n(t)||(t=f(t)),i)return u(i.mul(this.low,this.high,t.low,t.high),i.get_high(),this.unsigned);if(t.isZero())return m;if(this.eq(_))return t.isOdd()?_:m;if(t.eq(_))return this.isOdd()?_:m;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(v)&&t.lt(v))return r(this.toNumber()*t.toNumber(),this.unsigned);var h=this.high>>>16,s=65535&this.high,e=this.low>>>16,o=65535&this.low,g=t.high>>>16,l=65535&t.high,a=t.low>>>16,d=65535&t.low,c=0,w=0,N=0,E=0;return N+=(E+=o*d)>>>16,w+=(N+=e*d)>>>16,N&=65535,w+=(N+=o*a)>>>16,c+=(w+=s*d)>>>16,w&=65535,c+=(w+=e*a)>>>16,w&=65535,c+=(w+=o*l)>>>16,c+=h*d+s*a+e*l+o*g,u((N&=65535)<<16|(E&=65535),(c&=65535)<<16|(w&=65535),this.unsigned)},B.mul=B.multiply,B.divide=function(t){if(n(t)||(t=f(t)),t.isZero())throw Error("division by zero");var h,s,e;if(i)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?u((this.unsigned?i.div_u:i.div_s)(this.low,this.high,t.low,t.high),i.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?N:m;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return N;if(t.gt(this.shru(1)))return y;e=N}else{if(this.eq(_))return t.eq(E)||t.eq(b)?_:t.eq(_)?E:(h=this.shr(1).div(t).shl(1)).eq(m)?t.isNegative()?E:b:(s=this.sub(t.mul(h)),e=h.add(s.div(t)));if(t.eq(_))return this.unsigned?N:m;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();e=m}for(s=this;s.gte(t);){h=Math.max(1,Math.floor(s.toNumber()/t.toNumber()));for(var g=Math.ceil(Math.log(h)/Math.LN2),l=g<=48?1:o(2,g-48),a=r(h),d=a.mul(t);d.isNegative()||d.gt(s);)d=(a=r(h-=l,this.unsigned)).mul(t);a.isZero()&&(a=E),e=e.add(a),s=s.sub(d)}return e},B.div=B.divide,B.modulo=function(t){return n(t)||(t=f(t)),i?u((this.unsigned?i.rem_u:i.rem_s)(this.low,this.high,t.low,t.high),i.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},B.mod=B.modulo,B.rem=B.modulo,B.not=function(){return u(~this.low,~this.high,this.unsigned)},B.and=function(i){return n(i)||(i=f(i)),u(this.low&i.low,this.high&i.high,this.unsigned)},B.or=function(i){return n(i)||(i=f(i)),u(this.low|i.low,this.high|i.high,this.unsigned)},B.xor=function(i){return n(i)||(i=f(i)),u(this.low^i.low,this.high^i.high,this.unsigned)},B.shiftLeft=function(i){return n(i)&&(i=i.toInt()),0==(i&=63)?this:i<32?u(this.low<<i,this.high<<i|this.low>>>32-i,this.unsigned):u(0,this.low<<i-32,this.unsigned)},B.shl=B.shiftLeft,B.shiftRight=function(i){return n(i)&&(i=i.toInt()),0==(i&=63)?this:i<32?u(this.low>>>i|this.high<<32-i,this.high>>i,this.unsigned):u(this.high>>i-32,this.high>=0?0:-1,this.unsigned)},B.shr=B.shiftRight,B.shiftRightUnsigned=function(i){if(n(i)&&(i=i.toInt()),0===(i&=63))return this;var t=this.high;return i<32?u(this.low>>>i|t<<32-i,t>>>i,this.unsigned):u(32===i?t:t>>>i-32,0,this.unsigned)},B.shru=B.shiftRightUnsigned,B.shr_u=B.shiftRightUnsigned,B.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},B.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},B.toBytes=function(i){return i?this.toBytesLE():this.toBytesBE()},B.toBytesLE=function(){var i=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&i,i>>>8&255,i>>>16&255,i>>>24]},B.toBytesBE=function(){var i=this.high,t=this.low;return[i>>>24,i>>>16&255,i>>>8&255,255&i,t>>>24,t>>>16&255,t>>>8&255,255&t]},t.fromBytes=function(i,n,h){return h?t.fromBytesLE(i,n):t.fromBytesBE(i,n)},t.fromBytesLE=function(i,n){return new t(i[0]|i[1]<<8|i[2]<<16|i[3]<<24,i[4]|i[5]<<8|i[6]<<16|i[7]<<24,n)},t.fromBytesBE=function(i,n){return new t(i[4]<<24|i[5]<<16|i[6]<<8|i[7],i[0]<<24|i[1]<<16|i[2]<<8|i[3],n)};
},{}],"EzcF":[function(require,module,exports) {
"use strict";function n(n,e){for(var r=new Array(arguments.length-1),t=0,l=2,o=!0;l<arguments.length;)r[t++]=arguments[l++];return new Promise(function(l,u){r[t]=function(n){if(o)if(o=!1,n)u(n);else{for(var e=new Array(arguments.length-1),r=0;r<e.length;)e[r++]=arguments[r];l.apply(null,e)}};try{n.apply(e||null,r)}catch(a){o&&(o=!1,u(a))}})}module.exports=n;
},{}],"FsFQ":[function(require,module,exports) {
"use strict";var r=exports;r.length=function(r){var e=r.length;if(!e)return 0;for(var a=0;--e%4>1&&"="===r.charAt(e);)++a;return Math.ceil(3*r.length)/4-a};for(var e=new Array(64),a=new Array(123),t=0;t<64;)a[e[t]=t<26?t+65:t<52?t+71:t<62?t-4:t-59|43]=t++;r.encode=function(r,a,t){for(var n,i=null,o=[],c=0,s=0;a<t;){var h=r[a++];switch(s){case 0:o[c++]=e[h>>2],n=(3&h)<<4,s=1;break;case 1:o[c++]=e[n|h>>4],n=(15&h)<<2,s=2;break;case 2:o[c++]=e[n|h>>6],o[c++]=e[63&h],s=0}c>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),c=0)}return s&&(o[c++]=e[n],o[c++]=61,1===s&&(o[c++]=61)),i?(c&&i.push(String.fromCharCode.apply(String,o.slice(0,c))),i.join("")):String.fromCharCode.apply(String,o.slice(0,c))};var n="invalid encoding";r.decode=function(r,e,t){for(var i,o=t,c=0,s=0;s<r.length;){var h=r.charCodeAt(s++);if(61===h&&c>1)break;if(void 0===(h=a[h]))throw Error(n);switch(c){case 0:i=h,c=1;break;case 1:e[t++]=i<<2|(48&h)>>4,i=h,c=2;break;case 2:e[t++]=(15&i)<<4|(60&h)>>2,i=h,c=3;break;case 3:e[t++]=(3&i)<<6|h,c=0}}if(1===c)throw Error(n);return t-o},r.test=function(r){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(r)};
},{}],"JI1S":[function(require,module,exports) {
"use strict";function t(){this._listeners={}}module.exports=t,t.prototype.on=function(t,s,e){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:s,ctx:e||this}),this},t.prototype.off=function(t,s){if(void 0===t)this._listeners={};else if(void 0===s)this._listeners[t]=[];else for(var e=this._listeners[t],i=0;i<e.length;)e[i].fn===s?e.splice(i,1):++i;return this},t.prototype.emit=function(t){var s=this._listeners[t];if(s){for(var e=[],i=1;i<arguments.length;)e.push(arguments[i++]);for(i=0;i<s.length;)s[i].fn.apply(s[i++].ctx,e)}return this};
},{}],"M11I":[function(require,module,exports) {
"use strict";function n(n){return"undefined"!=typeof Float32Array?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),r=128===t[3];function o(n,r,o){e[0]=n,r[o]=t[0],r[o+1]=t[1],r[o+2]=t[2],r[o+3]=t[3]}function u(n,r,o){e[0]=n,r[o]=t[3],r[o+1]=t[2],r[o+2]=t[1],r[o+3]=t[0]}function i(n,r){return t[0]=n[r],t[1]=n[r+1],t[2]=n[r+2],t[3]=n[r+3],e[0]}function a(n,r){return t[3]=n[r],t[2]=n[r+1],t[1]=n[r+2],t[0]=n[r+3],e[0]}n.writeFloatLE=r?o:u,n.writeFloatBE=r?u:o,n.readFloatLE=r?i:a,n.readFloatBE=r?a:i}():function(){function u(n,e,t,r){var o=e<0?1:0;if(o&&(e=-e),0===e)n(1/e>0?0:2147483648,t,r);else if(isNaN(e))n(2143289344,t,r);else if(e>3.4028234663852886e38)n((o<<31|2139095040)>>>0,t,r);else if(e<1.1754943508222875e-38)n((o<<31|Math.round(e/1.401298464324817e-45))>>>0,t,r);else{var u=Math.floor(Math.log(e)/Math.LN2);n((o<<31|u+127<<23|8388607&Math.round(e*Math.pow(2,-u)*8388608))>>>0,t,r)}}function i(n,e,t){var r=n(e,t),o=2*(r>>31)+1,u=r>>>23&255,i=8388607&r;return 255===u?i?NaN:o*(1/0):0===u?1.401298464324817e-45*o*i:o*Math.pow(2,u-150)*(i+8388608)}n.writeFloatLE=u.bind(null,e),n.writeFloatBE=u.bind(null,t),n.readFloatLE=i.bind(null,r),n.readFloatBE=i.bind(null,o)}(),"undefined"!=typeof Float64Array?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),r=128===t[7];function o(n,r,o){e[0]=n,r[o]=t[0],r[o+1]=t[1],r[o+2]=t[2],r[o+3]=t[3],r[o+4]=t[4],r[o+5]=t[5],r[o+6]=t[6],r[o+7]=t[7]}function u(n,r,o){e[0]=n,r[o]=t[7],r[o+1]=t[6],r[o+2]=t[5],r[o+3]=t[4],r[o+4]=t[3],r[o+5]=t[2],r[o+6]=t[1],r[o+7]=t[0]}function i(n,r){return t[0]=n[r],t[1]=n[r+1],t[2]=n[r+2],t[3]=n[r+3],t[4]=n[r+4],t[5]=n[r+5],t[6]=n[r+6],t[7]=n[r+7],e[0]}function a(n,r){return t[7]=n[r],t[6]=n[r+1],t[5]=n[r+2],t[4]=n[r+3],t[3]=n[r+4],t[2]=n[r+5],t[1]=n[r+6],t[0]=n[r+7],e[0]}n.writeDoubleLE=r?o:u,n.writeDoubleBE=r?u:o,n.readDoubleLE=r?i:a,n.readDoubleBE=r?a:i}():function(){function u(n,e,t,r,o,u){var i=r<0?1:0;if(i&&(r=-r),0===r)n(0,o,u+e),n(1/r>0?0:2147483648,o,u+t);else if(isNaN(r))n(0,o,u+e),n(2146959360,o,u+t);else if(r>1.7976931348623157e308)n(0,o,u+e),n((i<<31|2146435072)>>>0,o,u+t);else{var a;if(r<2.2250738585072014e-308)n((a=r/5e-324)>>>0,o,u+e),n((i<<31|a/4294967296)>>>0,o,u+t);else{var l=Math.floor(Math.log(r)/Math.LN2);1024===l&&(l=1023),n(4503599627370496*(a=r*Math.pow(2,-l))>>>0,o,u+e),n((i<<31|l+1023<<20|1048576*a&1048575)>>>0,o,u+t)}}}function i(n,e,t,r,o){var u=n(r,o+e),i=n(r,o+t),a=2*(i>>31)+1,l=i>>>20&2047,f=4294967296*(1048575&i)+u;return 2047===l?f?NaN:a*(1/0):0===l?5e-324*a*f:a*Math.pow(2,l-1075)*(f+4503599627370496)}n.writeDoubleLE=u.bind(null,e,0,4),n.writeDoubleBE=u.bind(null,t,4,0),n.readDoubleLE=i.bind(null,r,0,4),n.readDoubleBE=i.bind(null,o,4,0)}(),n}function e(n,e,t){e[t]=255&n,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function t(n,e,t){e[t]=n>>>24,e[t+1]=n>>>16&255,e[t+2]=n>>>8&255,e[t+3]=255&n}function r(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0}function o(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}module.exports=n(n);
},{}],"MXG9":[function(require,module,exports) {
"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire;
},{}],"HIDA":[function(require,module,exports) {
"use strict";var r=exports;r.length=function(r){for(var t=0,n=0,e=0;e<r.length;++e)(n=r.charCodeAt(e))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&r.charCodeAt(e+1))?(++e,t+=4):t+=3;return t},r.read=function(r,t,n){if(n-t<1)return"";for(var e,o=null,a=[],i=0;t<n;)(e=r[t++])<128?a[i++]=e:e>191&&e<224?a[i++]=(31&e)<<6|63&r[t++]:e>239&&e<365?(e=((7&e)<<18|(63&r[t++])<<12|(63&r[t++])<<6|63&r[t++])-65536,a[i++]=55296+(e>>10),a[i++]=56320+(1023&e)):a[i++]=(15&e)<<12|(63&r[t++])<<6|63&r[t++],i>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),i=0);return o?(i&&o.push(String.fromCharCode.apply(String,a.slice(0,i))),o.join("")):String.fromCharCode.apply(String,a.slice(0,i))},r.write=function(r,t,n){for(var e,o,a=n,i=0;i<r.length;++i)(e=r.charCodeAt(i))<128?t[n++]=e:e<2048?(t[n++]=e>>6|192,t[n++]=63&e|128):55296==(64512&e)&&56320==(64512&(o=r.charCodeAt(i+1)))?(e=65536+((1023&e)<<10)+(1023&o),++i,t[n++]=e>>18|240,t[n++]=e>>12&63|128,t[n++]=e>>6&63|128,t[n++]=63&e|128):(t[n++]=e>>12|224,t[n++]=e>>6&63|128,t[n++]=63&e|128);return n-a};
},{}],"yqBl":[function(require,module,exports) {
"use strict";function r(r,n,t){var u=t||8192,e=u>>>1,l=null,c=u;return function(t){if(t<1||t>e)return r(t);c+t>u&&(l=r(u),c=0);var i=n.call(l,c,c+=t);return 7&c&&(c=1+(7|c)),i}}module.exports=r;
},{}],"mM8D":[function(require,module,exports) {
"use strict";module.exports=i;var t=require("../util/minimal");function i(t,i){this.lo=t>>>0,this.hi=i>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var r=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(t){if(0===t)return o;var r=t<0;r&&(t=-t);var h=t>>>0,n=(t-h)/4294967296>>>0;return r&&(n=~n>>>0,h=~h>>>0,++h>4294967295&&(h=0,++n>4294967295&&(n=0))),new i(h,n)},i.from=function(r){if("number"==typeof r)return i.fromNumber(r);if(t.isString(r)){if(!t.Long)return i.fromNumber(parseInt(r,10));r=t.Long.fromString(r)}return r.low||r.high?new i(r.low>>>0,r.high>>>0):o},i.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var i=1+~this.lo>>>0,o=~this.hi>>>0;return i||(o=o+1>>>0),-(i+4294967296*o)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(i){return t.Long?new t.Long(0|this.lo,0|this.hi,Boolean(i)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(i)}};var h=String.prototype.charCodeAt;i.fromHash=function(t){return t===r?o:new i((h.call(t,0)|h.call(t,1)<<8|h.call(t,2)<<16|h.call(t,3)<<24)>>>0,(h.call(t,4)|h.call(t,5)<<8|h.call(t,6)<<16|h.call(t,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},i.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},i.prototype.length=function(){var t=this.lo,i=(this.lo>>>28|this.hi<<4)>>>0,o=this.hi>>>24;return 0===o?0===i?t<16384?t<128?1:2:t<2097152?3:4:i<16384?i<128?5:6:i<2097152?7:8:o<128?9:10};
},{"../util/minimal":"OqZT"}],"FRly":[function(require,module,exports) {
"use strict";exports.byteLength=u,exports.toByteArray=i,exports.fromByteArray=d;for(var r=[],t=[],e="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)r[o]=n[o],t[n.charCodeAt(o)]=o;function h(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=r.indexOf("=");return-1===e&&(e=t),[e,e===t?0:4-e%4]}function u(r){var t=h(r),e=t[0],n=t[1];return 3*(e+n)/4-n}function c(r,t,e){return 3*(t+e)/4-e}function i(r){var n,o,a=h(r),u=a[0],i=a[1],f=new e(c(r,u,i)),A=0,d=i>0?u-4:u;for(o=0;o<d;o+=4)n=t[r.charCodeAt(o)]<<18|t[r.charCodeAt(o+1)]<<12|t[r.charCodeAt(o+2)]<<6|t[r.charCodeAt(o+3)],f[A++]=n>>16&255,f[A++]=n>>8&255,f[A++]=255&n;return 2===i&&(n=t[r.charCodeAt(o)]<<2|t[r.charCodeAt(o+1)]>>4,f[A++]=255&n),1===i&&(n=t[r.charCodeAt(o)]<<10|t[r.charCodeAt(o+1)]<<4|t[r.charCodeAt(o+2)]>>2,f[A++]=n>>8&255,f[A++]=255&n),f}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function A(r,t,e){for(var n,o=[],a=t;a<e;a+=3)n=(r[a]<<16&16711680)+(r[a+1]<<8&65280)+(255&r[a+2]),o.push(f(n));return o.join("")}function d(t){for(var e,n=t.length,o=n%3,a=[],h=0,u=n-o;h<u;h+=16383)a.push(A(t,h,h+16383>u?u:h+16383));return 1===o?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),a.join("")}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63;
},{}],"Quj6":[function(require,module,exports) {
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};
},{}],"aqZJ":[function(require,module,exports) {
var r={}.toString;module.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)};
},{}],"aMB2":[function(require,module,exports) {

var global = arguments[3];
var t=arguments[3],r=require("base64-js"),e=require("ieee754"),n=require("isarray");function i(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(r){return!1}}function o(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,r){if(o()<r)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r)).__proto__=f.prototype:(null===t&&(t=new f(r)),t.length=r),t}function f(t,r,e){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,r,e)}function s(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?g(t,r,e,n):"string"==typeof r?l(t,r,e):y(t,r)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function a(t,r,e,n){return h(r),r<=0?u(t,r):void 0!==e?"string"==typeof n?u(t,r).fill(e,n):u(t,r).fill(e):u(t,r)}function c(t,r){if(h(r),t=u(t,r<0?0:0|w(r)),!f.TYPED_ARRAY_SUPPORT)for(var e=0;e<r;++e)t[e]=0;return t}function l(t,r,e){if("string"==typeof e&&""!==e||(e="utf8"),!f.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(r,e),i=(t=u(t,n)).write(r,e);return i!==n&&(t=t.slice(0,i)),t}function p(t,r){var e=r.length<0?0:0|w(r.length);t=u(t,e);for(var n=0;n<e;n+=1)t[n]=255&r[n];return t}function g(t,r,e,n){if(r.byteLength,e<0||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");return r=void 0===e&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n),f.TYPED_ARRAY_SUPPORT?(t=r).__proto__=f.prototype:t=p(t,r),t}function y(t,r){if(f.isBuffer(r)){var e=0|w(r.length);return 0===(t=u(t,e)).length?t:(r.copy(t,0,0,e),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||W(r.length)?u(t,0):p(t,r);if("Buffer"===r.type&&n(r.data))return p(t,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function w(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function d(t){return+t!=t&&(t=0),f.alloc(+t)}function v(t,r){if(f.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return K(t).length;default:if(n)return $(t).length;r=(""+r).toLowerCase(),n=!0}}function E(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return x(this,r,e);case"utf8":case"utf-8":return Y(this,r,e);case"ascii":return L(this,r,e);case"latin1":case"binary":return D(this,r,e);case"base64":return S(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function R(t,r,e,n,i){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1}else if(e<0){if(!i)return-1;e=0}if("string"==typeof r&&(r=f.from(r,n)),f.isBuffer(r))return 0===r.length?-1:_(t,r,e,n,i);if("number"==typeof r)return r&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):_(t,[r],e,n,i);throw new TypeError("val must be string, number or Buffer")}function _(t,r,e,n,i){var o,u=1,f=t.length,s=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;u=2,f/=2,s/=2,e/=2}function h(t,r){return 1===u?t[r]:t.readUInt16BE(r*u)}if(i){var a=-1;for(o=e;o<f;o++)if(h(t,o)===h(r,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===s)return a*u}else-1!==a&&(o-=o-a),a=-1}else for(e+s>f&&(e=f-s),o=e;o>=0;o--){for(var c=!0,l=0;l<s;l++)if(h(t,o+l)!==h(r,l)){c=!1;break}if(c)return o}return-1}function A(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var o=r.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var f=parseInt(r.substr(2*u,2),16);if(isNaN(f))return u;t[e+u]=f}return u}function m(t,r,e,n){return Q($(r,t.length-e),t,e,n)}function P(t,r,e,n){return Q(G(r),t,e,n)}function T(t,r,e,n){return P(t,r,e,n)}function B(t,r,e,n){return Q(K(r),t,e,n)}function U(t,r,e,n){return Q(H(r,t.length-e),t,e,n)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function Y(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;i<e;){var o,u,f,s,h=t[i],a=null,c=h>239?4:h>223?3:h>191?2:1;if(i+c<=e)switch(c){case 1:h<128&&(a=h);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&h)<<6|63&o)>127&&(a=s);break;case 3:o=t[i+1],u=t[i+2],128==(192&o)&&128==(192&u)&&(s=(15&h)<<12|(63&o)<<6|63&u)>2047&&(s<55296||s>57343)&&(a=s);break;case 4:o=t[i+1],u=t[i+2],f=t[i+3],128==(192&o)&&128==(192&u)&&128==(192&f)&&(s=(15&h)<<18|(63&o)<<12|(63&u)<<6|63&f)>65535&&s<1114112&&(a=s)}null===a?(a=65533,c=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=c}return O(n)}exports.Buffer=f,exports.SlowBuffer=d,exports.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:i(),exports.kMaxLength=o(),f.poolSize=8192,f._augment=function(t){return t.__proto__=f.prototype,t},f.from=function(t,r,e){return s(null,t,r,e)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(t,r,e){return a(null,t,r,e)},f.allocUnsafe=function(t){return c(null,t)},f.allocUnsafeSlow=function(t){return c(null,t)},f.isBuffer=function(t){return!(null==t||!t._isBuffer)},f.compare=function(t,r){if(!f.isBuffer(t)||!f.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,i=0,o=Math.min(e,n);i<o;++i)if(t[i]!==r[i]){e=t[i],n=r[i];break}return e<n?-1:n<e?1:0},f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(t,r){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return f.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var i=f.allocUnsafe(r),o=0;for(e=0;e<t.length;++e){var u=t[e];if(!f.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,o),o+=u.length}return i},f.byteLength=v,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)b(this,r,r+1);return this},f.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)b(this,r,r+3),b(this,r+1,r+2);return this},f.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)b(this,r,r+7),b(this,r+1,r+6),b(this,r+2,r+5),b(this,r+3,r+4);return this},f.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Y(this,0,t):E.apply(this,arguments)},f.prototype.equals=function(t){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===f.compare(this,t)},f.prototype.inspect=function(){var t="",r=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},f.prototype.compare=function(t,r,e,n,i){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),r<0||e>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&r>=e)return 0;if(n>=i)return-1;if(r>=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),u=(e>>>=0)-(r>>>=0),s=Math.min(o,u),h=this.slice(n,i),a=t.slice(r,e),c=0;c<s;++c)if(h[c]!==a[c]){o=h[c],u=a[c];break}return o<u?-1:u<o?1:0},f.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},f.prototype.indexOf=function(t,r,e){return R(this,t,r,e,!0)},f.prototype.lastIndexOf=function(t,r,e){return R(this,t,r,e,!1)},f.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(e)?(e|=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return A(this,t,r,e);case"utf8":case"utf-8":return m(this,t,r,e);case"ascii":return P(this,t,r,e);case"latin1":case"binary":return T(this,t,r,e);case"base64":return B(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function O(t){var r=t.length;if(r<=I)return String.fromCharCode.apply(String,t);for(var e="",n=0;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=I));return e}function L(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(127&t[i]);return n}function D(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n}function x(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;++o)i+=Z(t[o]);return i}function C(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function M(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function k(t,r,e,n,i,o){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<o)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function N(t,r,e,n){r<0&&(r=65535+r+1);for(var i=0,o=Math.min(t.length-e,2);i<o;++i)t[e+i]=(r&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function z(t,r,e,n){r<0&&(r=4294967295+r+1);for(var i=0,o=Math.min(t.length-e,4);i<o;++i)t[e+i]=r>>>8*(n?i:3-i)&255}function F(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function j(t,r,n,i,o){return o||F(t,r,n,4,3.4028234663852886e38,-3.4028234663852886e38),e.write(t,r,n,i,23,4),n+4}function q(t,r,n,i,o){return o||F(t,r,n,8,1.7976931348623157e308,-1.7976931348623157e308),e.write(t,r,n,i,52,8),n+8}f.prototype.slice=function(t,r){var e,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t),f.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,r)).__proto__=f.prototype;else{var i=r-t;e=new f(i,void 0);for(var o=0;o<i;++o)e[o]=this[o+t]}return e},f.prototype.readUIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n},f.prototype.readUIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n},f.prototype.readUInt8=function(t,r){return r||M(t,1,this.length),this[t]},f.prototype.readUInt16LE=function(t,r){return r||M(t,2,this.length),this[t]|this[t+1]<<8},f.prototype.readUInt16BE=function(t,r){return r||M(t,2,this.length),this[t]<<8|this[t+1]},f.prototype.readUInt32LE=function(t,r){return r||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},f.prototype.readUInt32BE=function(t,r){return r||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},f.prototype.readIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*r)),n},f.prototype.readIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*r)),o},f.prototype.readInt8=function(t,r){return r||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},f.prototype.readInt16LE=function(t,r){r||M(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt16BE=function(t,r){r||M(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt32LE=function(t,r){return r||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},f.prototype.readInt32BE=function(t,r){return r||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},f.prototype.readFloatLE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!0,23,4)},f.prototype.readFloatBE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!1,23,4)},f.prototype.readDoubleLE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!0,52,8)},f.prototype.readDoubleBE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!1,52,8)},f.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=1,o=0;for(this[r]=255&t;++o<e&&(i*=256);)this[r+o]=t/i&255;return r+e},f.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=e-1,o=1;for(this[r+i]=255&t;--i>=0&&(o*=256);)this[r+i]=t/o&255;return r+e},f.prototype.writeUInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,255,0),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},f.prototype.writeUInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeUInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeUInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):z(this,t,r,!0),r+4},f.prototype.writeUInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=0,u=1,f=0;for(this[r]=255&t;++o<e&&(u*=256);)t<0&&0===f&&0!==this[r+o-1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=e-1,u=1,f=0;for(this[r+o]=255&t;--o>=0&&(u*=256);)t<0&&0===f&&0!==this[r+o+1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,127,-128),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1},f.prototype.writeInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):z(this,t,r,!0),r+4},f.prototype.writeInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeFloatLE=function(t,r,e){return j(this,t,r,!0,e)},f.prototype.writeFloatBE=function(t,r,e){return j(this,t,r,!1,e)},f.prototype.writeDoubleLE=function(t,r,e){return q(this,t,r,!0,e)},f.prototype.writeDoubleBE=function(t,r,e){return q(this,t,r,!1,e)},f.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var i,o=n-e;if(this===t&&e<r&&r<n)for(i=o-1;i>=0;--i)t[i+r]=this[i+e];else if(o<1e3||!f.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+r]=this[i+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),r);return o},f.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;var o;if(r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(o=r;o<e;++o)this[o]=t;else{var u=f.isBuffer(t)?t:$(new f(t,n).toString()),s=u.length;for(o=0;o<e-r;++o)this[o+r]=u[o%s]}return this};var V=/[^+\/0-9A-Za-z-_]/g;function X(t){if((t=J(t).replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function J(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Z(t){return t<16?"0"+t.toString(16):t.toString(16)}function $(t,r){var e;r=r||1/0;for(var n=t.length,i=null,o=[],u=0;u<n;++u){if((e=t.charCodeAt(u))>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=65536+(i-55296<<10|e-56320)}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e)}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function G(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}function H(t,r){for(var e,n,i,o=[],u=0;u<t.length&&!((r-=2)<0);++u)n=(e=t.charCodeAt(u))>>8,i=e%256,o.push(i),o.push(n);return o}function K(t){return r.toByteArray(X(t))}function Q(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i}function W(t){return t!=t}
},{"base64-js":"FRly","ieee754":"Quj6","isarray":"aqZJ","buffer":"aMB2"}],"OqZT":[function(require,module,exports) {
var global = arguments[3];
var Buffer = require("buffer").Buffer;
var e=arguments[3],r=require("buffer").Buffer,t=exports;function n(e,r,t){for(var n=Object.keys(r),o=0;o<n.length;++o)void 0!==e[n[o]]&&t||(e[n[o]]=r[n[o]]);return e}function o(e){function r(e,t){if(!(this instanceof r))return new r(e,t);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,r):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),t&&n(this,t)}return(r.prototype=Object.create(Error.prototype)).constructor=r,Object.defineProperty(r.prototype,"name",{get:function(){return e}}),r.prototype.toString=function(){return this.name+": "+this.message},r}t.asPromise=require("@protobufjs/aspromise"),t.base64=require("@protobufjs/base64"),t.EventEmitter=require("@protobufjs/eventemitter"),t.float=require("@protobufjs/float"),t.inquire=require("@protobufjs/inquire"),t.utf8=require("@protobufjs/utf8"),t.pool=require("@protobufjs/pool"),t.LongBits=require("./longbits"),t.isNode=Boolean(void 0!==e&&e&&e.process&&e.process.versions&&e.process.versions.node),t.global=t.isNode&&e||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return e&&"object"==typeof e},t.isset=t.isSet=function(e,r){var t=e[r];return!(null==t||!e.hasOwnProperty(r))&&("object"!=typeof t||(Array.isArray(t)?t.length:Object.keys(t).length)>0)},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(r){return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t._Buffer_allocUnsafe(e):new t.Array(e):t.Buffer?t._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},t.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash},t.longFromHash=function(e,r){var n=t.LongBits.fromHash(e);return t.Long?t.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))},t.merge=n,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.newError=o,t.ProtocolError=o("ProtocolError"),t.oneOfGetter=function(e){for(var r={},t=0;t<e.length;++t)r[e[t]]=1;return function(){for(var e=Object.keys(this),t=e.length-1;t>-1;--t)if(1===r[e[t]]&&void 0!==this[e[t]]&&null!==this[e[t]])return e[t]}},t.oneOfSetter=function(e){return function(r){for(var t=0;t<e.length;++t)e[t]!==r&&delete this[e[t]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var e=t.Buffer;e?(t._Buffer_from=e.from!==Uint8Array.from&&e.from||function(r,t){return new e(r,t)},t._Buffer_allocUnsafe=e.allocUnsafe||function(r){return new e(r)}):t._Buffer_from=t._Buffer_allocUnsafe=null};
},{"@protobufjs/aspromise":"EzcF","@protobufjs/base64":"FsFQ","@protobufjs/eventemitter":"JI1S","@protobufjs/float":"M11I","@protobufjs/inquire":"MXG9","@protobufjs/utf8":"HIDA","@protobufjs/pool":"yqBl","./longbits":"mM8D","buffer":"aMB2"}],"uteQ":[function(require,module,exports) {
"use strict";module.exports=u;var t,i=require("./util/minimal"),n=i.LongBits,e=i.base64,o=i.utf8;function r(t,i,n){this.fn=t,this.len=i,this.next=void 0,this.val=n}function s(){}function h(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function u(){this.len=0,this.head=new r(s,0,0),this.tail=this.head,this.states=null}var l=function(){return i.Buffer?function(){return(u.create=function(){return new t})()}:function(){return new u}};function p(t,i,n){i[n]=255&t}function a(t,i,n){for(;t>127;)i[n++]=127&t|128,t>>>=7;i[n]=t}function f(t,i){this.len=t,this.next=void 0,this.val=i}function c(t,i,n){for(;t.hi;)i[n++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)i[n++]=127&t.lo|128,t.lo=t.lo>>>7;i[n++]=t.lo}function y(t,i,n){i[n]=255&t,i[n+1]=t>>>8&255,i[n+2]=t>>>16&255,i[n+3]=t>>>24}u.create=l(),u.alloc=function(t){return new i.Array(t)},i.Array!==Array&&(u.alloc=i.pool(u.alloc,i.Array.prototype.subarray)),u.prototype._push=function(t,i,n){return this.tail=this.tail.next=new r(t,i,n),this.len+=i,this},f.prototype=Object.create(r.prototype),f.prototype.fn=a,u.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new f((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},u.prototype.int32=function(t){return t<0?this._push(c,10,n.fromNumber(t)):this.uint32(t)},u.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},u.prototype.uint64=function(t){var i=n.from(t);return this._push(c,i.length(),i)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(t){var i=n.from(t).zzEncode();return this._push(c,i.length(),i)},u.prototype.bool=function(t){return this._push(p,1,t?1:0)},u.prototype.fixed32=function(t){return this._push(y,4,t>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(t){var i=n.from(t);return this._push(y,4,i.lo)._push(y,4,i.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(t){return this._push(i.float.writeFloatLE,4,t)},u.prototype.double=function(t){return this._push(i.float.writeDoubleLE,8,t)};var d=i.Array.prototype.set?function(t,i,n){i.set(t,n)}:function(t,i,n){for(var e=0;e<t.length;++e)i[n+e]=t[e]};u.prototype.bytes=function(t){var n=t.length>>>0;if(!n)return this._push(p,1,0);if(i.isString(t)){var o=u.alloc(n=e.length(t));e.decode(t,o,0),t=o}return this.uint32(n)._push(d,n,t)},u.prototype.string=function(t){var i=o.length(t);return i?this.uint32(i)._push(o.write,i,t):this._push(p,1,0)},u.prototype.fork=function(){return this.states=new h(this),this.head=this.tail=new r(s,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new r(s,0,0),this.len=0),this},u.prototype.ldelim=function(){var t=this.head,i=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=i,this.len+=n),this},u.prototype.finish=function(){for(var t=this.head.next,i=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,i,n),n+=t.len,t=t.next;return i},u._configure=function(i){t=i,u.create=l(),t._configure()};
},{"./util/minimal":"OqZT"}],"CkBE":[function(require,module,exports) {
"use strict";module.exports=r;var t=require("./writer");(r.prototype=Object.create(t.prototype)).constructor=r;var e=require("./util/minimal");function r(){t.call(this)}function i(t,r,i){t.length<40?e.utf8.write(t,r,i):r.utf8Write?r.utf8Write(t,i):r.write(t,i)}r._configure=function(){r.alloc=e._Buffer_allocUnsafe,r.writeBytesBuffer=e.Buffer&&e.Buffer.prototype instanceof Uint8Array&&"set"===e.Buffer.prototype.set.name?function(t,e,r){e.set(t,r)}:function(t,e,r){if(t.copy)t.copy(e,r,0,t.length);else for(var i=0;i<t.length;)e[r++]=t[i++]}},r.prototype.bytes=function(t){e.isString(t)&&(t=e._Buffer_from(t,"base64"));var i=t.length>>>0;return this.uint32(i),i&&this._push(r.writeBytesBuffer,i,t),this},r.prototype.string=function(t){var r=e.Buffer.byteLength(t);return this.uint32(r),r&&this._push(i,r,t),this},r._configure();
},{"./writer":"uteQ","./util/minimal":"OqZT"}],"nX4I":[function(require,module,exports) {
"use strict";module.exports=h;var t,i=require("./util/minimal"),s=i.LongBits,r=i.utf8;function o(t,i){return RangeError("index out of range: "+t.pos+" + "+(i||1)+" > "+t.len)}function h(t){this.buf=t,this.pos=0,this.len=t.length}var n="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new h(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new h(t);throw Error("illegal buffer")},e=function(){return i.Buffer?function(s){return(h.create=function(s){return i.Buffer.isBuffer(s)?new t(s):n(s)})(s)}:n};function u(){var t=new s(0,0),i=0;if(!(this.len-this.pos>4)){for(;i<3;++i){if(this.pos>=this.len)throw o(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*i)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*i)>>>0,t}for(;i<4;++i)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*i)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(i=0,this.len-this.pos>4){for(;i<5;++i)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*i+3)>>>0,this.buf[this.pos++]<128)return t}else for(;i<5;++i){if(this.pos>=this.len)throw o(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*i+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function f(t,i){return(t[i-4]|t[i-3]<<8|t[i-2]<<16|t[i-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw o(this,8);return new s(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}h.create=e(),h.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,h.prototype.uint32=function(){var t=4294967295;return function(){if(t=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return t;if((this.pos+=5)>this.len)throw this.pos=this.len,o(this,10);return t}}(),h.prototype.int32=function(){return 0|this.uint32()},h.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)|0},h.prototype.bool=function(){return 0!==this.uint32()},h.prototype.fixed32=function(){if(this.pos+4>this.len)throw o(this,4);return f(this.buf,this.pos+=4)},h.prototype.sfixed32=function(){if(this.pos+4>this.len)throw o(this,4);return 0|f(this.buf,this.pos+=4)},h.prototype.float=function(){if(this.pos+4>this.len)throw o(this,4);var t=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},h.prototype.double=function(){if(this.pos+8>this.len)throw o(this,4);var t=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},h.prototype.bytes=function(){var t=this.uint32(),i=this.pos,s=this.pos+t;if(s>this.len)throw o(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(i,s):i===s?new this.buf.constructor(0):this._slice.call(this.buf,i,s)},h.prototype.string=function(){var t=this.bytes();return r.read(t,0,t.length)},h.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw o(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw o(this)}while(128&this.buf[this.pos++]);return this},h.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},h._configure=function(s){t=s,h.create=e(),t._configure();var r=i.Long?"toLong":"toNumber";i.merge(h.prototype,{int64:function(){return u.call(this)[r](!1)},uint64:function(){return u.call(this)[r](!0)},sint64:function(){return u.call(this).zzDecode()[r](!1)},fixed64:function(){return p.call(this)[r](!0)},sfixed64:function(){return p.call(this)[r](!1)}})};
},{"./util/minimal":"OqZT"}],"pJQ5":[function(require,module,exports) {
"use strict";module.exports=e;var t=require("./reader");(e.prototype=Object.create(t.prototype)).constructor=e;var i=require("./util/minimal");function e(i){t.call(this,i)}e._configure=function(){i.Buffer&&(e.prototype._slice=i.Buffer.prototype.slice)},e.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))},e._configure();
},{"./reader":"nX4I","./util/minimal":"OqZT"}],"uviC":[function(require,module,exports) {
"use strict";module.exports=t;var e=require("../util/minimal");function t(t,r,i){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");e.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(r),this.responseDelimited=Boolean(i)}(t.prototype=Object.create(e.EventEmitter.prototype)).constructor=t,t.prototype.rpcCall=function t(r,i,n,o,l){if(!o)throw TypeError("request must be specified");var u=this;if(!l)return e.asPromise(t,u,r,i,n,o);if(u.rpcImpl)try{return u.rpcImpl(r,i[u.requestDelimited?"encodeDelimited":"encode"](o).finish(),function(e,t){if(e)return u.emit("error",e,r),l(e);if(null!==t){if(!(t instanceof n))try{t=n[u.responseDelimited?"decodeDelimited":"decode"](t)}catch(e){return u.emit("error",e,r),l(e)}return u.emit("data",t,r),l(null,t)}u.end(!0)})}catch(c){return u.emit("error",c,r),void setTimeout(function(){l(c)},0)}else setTimeout(function(){l(Error("already ended"))},0)},t.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};
},{"../util/minimal":"OqZT"}],"j3cJ":[function(require,module,exports) {
"use strict";var e=exports;e.Service=require("./rpc/service");
},{"./rpc/service":"uviC"}],"SPDi":[function(require,module,exports) {
"use strict";module.exports={};
},{}],"BiIR":[function(require,module,exports) {
"use strict";var r=exports;function e(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=require("./writer"),r.BufferWriter=require("./writer_buffer"),r.Reader=require("./reader"),r.BufferReader=require("./reader_buffer"),r.util=require("./util/minimal"),r.rpc=require("./rpc"),r.roots=require("./roots"),r.configure=e,e();
},{"./writer":"uteQ","./writer_buffer":"CkBE","./reader":"nX4I","./reader_buffer":"pJQ5","./util/minimal":"OqZT","./rpc":"j3cJ","./roots":"SPDi"}],"fCoP":[function(require,module,exports) {
"use strict";module.exports=require("./src/index-minimal");
},{"./src/index-minimal":"BiIR"}],"OxfL":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3],t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.UserPacket=exports.SpeakerInfo=exports.ActiveSpeakerUpdate=exports.DataPacket=exports.TrackInfo=exports.ParticipantInfo=exports.Codec=exports.Room=exports.dataPacket_KindToJSON=exports.dataPacket_KindFromJSON=exports.DataPacket_Kind=exports.participantInfo_StateToJSON=exports.participantInfo_StateFromJSON=exports.ParticipantInfo_State=exports.connectionQualityToJSON=exports.connectionQualityFromJSON=exports.ConnectionQuality=exports.trackSourceToJSON=exports.trackSourceFromJSON=exports.TrackSource=exports.trackTypeToJSON=exports.trackTypeFromJSON=exports.TrackType=exports.protobufPackage=void 0;const i=t(require("long")),a=t(require("protobufjs/minimal"));var n,r,s,o,d;function c(e){switch(e){case 0:case"AUDIO":return n.AUDIO;case 1:case"VIDEO":return n.VIDEO;case 2:case"DATA":return n.DATA;case-1:case"UNRECOGNIZED":default:return n.UNRECOGNIZED}}function u(e){switch(e){case n.AUDIO:return"AUDIO";case n.VIDEO:return"VIDEO";case n.DATA:return"DATA";default:return"UNKNOWN"}}function l(e){switch(e){case 0:case"UNKNOWN":return r.UNKNOWN;case 1:case"CAMERA":return r.CAMERA;case 2:case"MICROPHONE":return r.MICROPHONE;case 3:case"SCREEN_SHARE":return r.SCREEN_SHARE;case 4:case"SCREEN_SHARE_AUDIO":return r.SCREEN_SHARE_AUDIO;case-1:case"UNRECOGNIZED":default:return r.UNRECOGNIZED}}function p(e){switch(e){case r.UNKNOWN:return"UNKNOWN";case r.CAMERA:return"CAMERA";case r.MICROPHONE:return"MICROPHONE";case r.SCREEN_SHARE:return"SCREEN_SHARE";case r.SCREEN_SHARE_AUDIO:return"SCREEN_SHARE_AUDIO";default:return"UNKNOWN"}}function m(e){switch(e){case 0:case"POOR":return s.POOR;case 1:case"GOOD":return s.GOOD;case 2:case"EXCELLENT":return s.EXCELLENT;case-1:case"UNRECOGNIZED":default:return s.UNRECOGNIZED}}function f(e){switch(e){case s.POOR:return"POOR";case s.GOOD:return"GOOD";case s.EXCELLENT:return"EXCELLENT";default:return"UNKNOWN"}}function N(e){switch(e){case 0:case"JOINING":return o.JOINING;case 1:case"JOINED":return o.JOINED;case 2:case"ACTIVE":return o.ACTIVE;case 3:case"DISCONNECTED":return o.DISCONNECTED;case-1:case"UNRECOGNIZED":default:return o.UNRECOGNIZED}}function O(e){switch(e){case o.JOINING:return"JOINING";case o.JOINED:return"JOINED";case o.ACTIVE:return"ACTIVE";case o.DISCONNECTED:return"DISCONNECTED";default:return"UNKNOWN"}}function v(e){switch(e){case 0:case"RELIABLE":return d.RELIABLE;case 1:case"LOSSY":return d.LOSSY;case-1:case"UNRECOGNIZED":default:return d.UNRECOGNIZED}}function k(e){switch(e){case d.RELIABLE:return"RELIABLE";case d.LOSSY:return"LOSSY";default:return"UNKNOWN"}}exports.protobufPackage="livekit",function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO",e[e.DATA=2]="DATA",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(n=exports.TrackType||(exports.TrackType={})),exports.trackTypeFromJSON=c,exports.trackTypeToJSON=u,function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.CAMERA=1]="CAMERA",e[e.MICROPHONE=2]="MICROPHONE",e[e.SCREEN_SHARE=3]="SCREEN_SHARE",e[e.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(r=exports.TrackSource||(exports.TrackSource={})),exports.trackSourceFromJSON=l,exports.trackSourceToJSON=p,function(e){e[e.POOR=0]="POOR",e[e.GOOD=1]="GOOD",e[e.EXCELLENT=2]="EXCELLENT",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(s=exports.ConnectionQuality||(exports.ConnectionQuality={})),exports.connectionQualityFromJSON=m,exports.connectionQualityToJSON=f,function(e){e[e.JOINING=0]="JOINING",e[e.JOINED=1]="JOINED",e[e.ACTIVE=2]="ACTIVE",e[e.DISCONNECTED=3]="DISCONNECTED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(o=exports.ParticipantInfo_State||(exports.ParticipantInfo_State={})),exports.participantInfo_StateFromJSON=N,exports.participantInfo_StateToJSON=O,function(e){e[e.RELIABLE=0]="RELIABLE",e[e.LOSSY=1]="LOSSY",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(d=exports.DataPacket_Kind||(exports.DataPacket_Kind={})),exports.dataPacket_KindFromJSON=v,exports.dataPacket_KindToJSON=k;const S={sid:"",name:"",emptyTimeout:0,maxParticipants:0,creationTime:0,turnPassword:"",metadata:"",numParticipants:0};exports.Room={encode(e,t=a.default.Writer.create()){""!==e.sid&&t.uint32(10).string(e.sid),""!==e.name&&t.uint32(18).string(e.name),0!==e.emptyTimeout&&t.uint32(24).uint32(e.emptyTimeout),0!==e.maxParticipants&&t.uint32(32).uint32(e.maxParticipants),0!==e.creationTime&&t.uint32(40).int64(e.creationTime),""!==e.turnPassword&&t.uint32(50).string(e.turnPassword);for(const i of e.enabledCodecs)exports.Codec.encode(i,t.uint32(58).fork()).ldelim();return""!==e.metadata&&t.uint32(66).string(e.metadata),0!==e.numParticipants&&t.uint32(72).uint32(e.numParticipants),t},decode(e,t){const i=e instanceof a.default.Reader?e:new a.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},S);for(r.enabledCodecs=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.sid=i.string();break;case 2:r.name=i.string();break;case 3:r.emptyTimeout=i.uint32();break;case 4:r.maxParticipants=i.uint32();break;case 5:r.creationTime=R(i.int64());break;case 6:r.turnPassword=i.string();break;case 7:r.enabledCodecs.push(exports.Codec.decode(i,i.uint32()));break;case 8:r.metadata=i.string();break;case 9:r.numParticipants=i.uint32();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},S);if(t.enabledCodecs=[],void 0!==e.sid&&null!==e.sid?t.sid=String(e.sid):t.sid="",void 0!==e.name&&null!==e.name?t.name=String(e.name):t.name="",void 0!==e.emptyTimeout&&null!==e.emptyTimeout?t.emptyTimeout=Number(e.emptyTimeout):t.emptyTimeout=0,void 0!==e.maxParticipants&&null!==e.maxParticipants?t.maxParticipants=Number(e.maxParticipants):t.maxParticipants=0,void 0!==e.creationTime&&null!==e.creationTime?t.creationTime=Number(e.creationTime):t.creationTime=0,void 0!==e.turnPassword&&null!==e.turnPassword?t.turnPassword=String(e.turnPassword):t.turnPassword="",void 0!==e.enabledCodecs&&null!==e.enabledCodecs)for(const i of e.enabledCodecs)t.enabledCodecs.push(exports.Codec.fromJSON(i));return void 0!==e.metadata&&null!==e.metadata?t.metadata=String(e.metadata):t.metadata="",void 0!==e.numParticipants&&null!==e.numParticipants?t.numParticipants=Number(e.numParticipants):t.numParticipants=0,t},toJSON(e){const t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.name&&(t.name=e.name),void 0!==e.emptyTimeout&&(t.emptyTimeout=e.emptyTimeout),void 0!==e.maxParticipants&&(t.maxParticipants=e.maxParticipants),void 0!==e.creationTime&&(t.creationTime=e.creationTime),void 0!==e.turnPassword&&(t.turnPassword=e.turnPassword),e.enabledCodecs?t.enabledCodecs=e.enabledCodecs.map(e=>e?exports.Codec.toJSON(e):void 0):t.enabledCodecs=[],void 0!==e.metadata&&(t.metadata=e.metadata),void 0!==e.numParticipants&&(t.numParticipants=e.numParticipants),t},fromPartial(e){var t,i,a,n,r,s,o,d;const c=Object.assign({},S);if(c.sid=null!==(t=e.sid)&&void 0!==t?t:"",c.name=null!==(i=e.name)&&void 0!==i?i:"",c.emptyTimeout=null!==(a=e.emptyTimeout)&&void 0!==a?a:0,c.maxParticipants=null!==(n=e.maxParticipants)&&void 0!==n?n:0,c.creationTime=null!==(r=e.creationTime)&&void 0!==r?r:0,c.turnPassword=null!==(s=e.turnPassword)&&void 0!==s?s:"",c.enabledCodecs=[],void 0!==e.enabledCodecs&&null!==e.enabledCodecs)for(const u of e.enabledCodecs)c.enabledCodecs.push(exports.Codec.fromPartial(u));return c.metadata=null!==(o=e.metadata)&&void 0!==o?o:"",c.numParticipants=null!==(d=e.numParticipants)&&void 0!==d?d:0,c}};const E={mime:"",fmtpLine:""};exports.Codec={encode:(e,t=a.default.Writer.create())=>(""!==e.mime&&t.uint32(10).string(e.mime),""!==e.fmtpLine&&t.uint32(18).string(e.fmtpLine),t),decode(e,t){const i=e instanceof a.default.Reader?e:new a.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},E);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.mime=i.string();break;case 2:r.fmtpLine=i.string();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},E);return void 0!==e.mime&&null!==e.mime?t.mime=String(e.mime):t.mime="",void 0!==e.fmtpLine&&null!==e.fmtpLine?t.fmtpLine=String(e.fmtpLine):t.fmtpLine="",t},toJSON(e){const t={};return void 0!==e.mime&&(t.mime=e.mime),void 0!==e.fmtpLine&&(t.fmtpLine=e.fmtpLine),t},fromPartial(e){var t,i;const a=Object.assign({},E);return a.mime=null!==(t=e.mime)&&void 0!==t?t:"",a.fmtpLine=null!==(i=e.fmtpLine)&&void 0!==i?i:"",a}};const b={sid:"",identity:"",state:0,metadata:"",joinedAt:0,hidden:!1};exports.ParticipantInfo={encode(e,t=a.default.Writer.create()){""!==e.sid&&t.uint32(10).string(e.sid),""!==e.identity&&t.uint32(18).string(e.identity),0!==e.state&&t.uint32(24).int32(e.state);for(const i of e.tracks)exports.TrackInfo.encode(i,t.uint32(34).fork()).ldelim();return""!==e.metadata&&t.uint32(42).string(e.metadata),0!==e.joinedAt&&t.uint32(48).int64(e.joinedAt),!0===e.hidden&&t.uint32(56).bool(e.hidden),t},decode(e,t){const i=e instanceof a.default.Reader?e:new a.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},b);for(r.tracks=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.sid=i.string();break;case 2:r.identity=i.string();break;case 3:r.state=i.int32();break;case 4:r.tracks.push(exports.TrackInfo.decode(i,i.uint32()));break;case 5:r.metadata=i.string();break;case 6:r.joinedAt=R(i.int64());break;case 7:r.hidden=i.bool();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},b);if(t.tracks=[],void 0!==e.sid&&null!==e.sid?t.sid=String(e.sid):t.sid="",void 0!==e.identity&&null!==e.identity?t.identity=String(e.identity):t.identity="",void 0!==e.state&&null!==e.state?t.state=N(e.state):t.state=0,void 0!==e.tracks&&null!==e.tracks)for(const i of e.tracks)t.tracks.push(exports.TrackInfo.fromJSON(i));return void 0!==e.metadata&&null!==e.metadata?t.metadata=String(e.metadata):t.metadata="",void 0!==e.joinedAt&&null!==e.joinedAt?t.joinedAt=Number(e.joinedAt):t.joinedAt=0,void 0!==e.hidden&&null!==e.hidden?t.hidden=Boolean(e.hidden):t.hidden=!1,t},toJSON(e){const t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.identity&&(t.identity=e.identity),void 0!==e.state&&(t.state=O(e.state)),e.tracks?t.tracks=e.tracks.map(e=>e?exports.TrackInfo.toJSON(e):void 0):t.tracks=[],void 0!==e.metadata&&(t.metadata=e.metadata),void 0!==e.joinedAt&&(t.joinedAt=e.joinedAt),void 0!==e.hidden&&(t.hidden=e.hidden),t},fromPartial(e){var t,i,a,n,r,s;const o=Object.assign({},b);if(o.sid=null!==(t=e.sid)&&void 0!==t?t:"",o.identity=null!==(i=e.identity)&&void 0!==i?i:"",o.state=null!==(a=e.state)&&void 0!==a?a:0,o.tracks=[],void 0!==e.tracks&&null!==e.tracks)for(const d of e.tracks)o.tracks.push(exports.TrackInfo.fromPartial(d));return o.metadata=null!==(n=e.metadata)&&void 0!==n?n:"",o.joinedAt=null!==(r=e.joinedAt)&&void 0!==r?r:0,o.hidden=null!==(s=e.hidden)&&void 0!==s&&s,o}};const x={sid:"",type:0,name:"",muted:!1,width:0,height:0,simulcast:!1,disableDtx:!1,source:0};exports.TrackInfo={encode:(e,t=a.default.Writer.create())=>(""!==e.sid&&t.uint32(10).string(e.sid),0!==e.type&&t.uint32(16).int32(e.type),""!==e.name&&t.uint32(26).string(e.name),!0===e.muted&&t.uint32(32).bool(e.muted),0!==e.width&&t.uint32(40).uint32(e.width),0!==e.height&&t.uint32(48).uint32(e.height),!0===e.simulcast&&t.uint32(56).bool(e.simulcast),!0===e.disableDtx&&t.uint32(64).bool(e.disableDtx),0!==e.source&&t.uint32(72).int32(e.source),t),decode(e,t){const i=e instanceof a.default.Reader?e:new a.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},x);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.sid=i.string();break;case 2:r.type=i.int32();break;case 3:r.name=i.string();break;case 4:r.muted=i.bool();break;case 5:r.width=i.uint32();break;case 6:r.height=i.uint32();break;case 7:r.simulcast=i.bool();break;case 8:r.disableDtx=i.bool();break;case 9:r.source=i.int32();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},x);return void 0!==e.sid&&null!==e.sid?t.sid=String(e.sid):t.sid="",void 0!==e.type&&null!==e.type?t.type=c(e.type):t.type=0,void 0!==e.name&&null!==e.name?t.name=String(e.name):t.name="",void 0!==e.muted&&null!==e.muted?t.muted=Boolean(e.muted):t.muted=!1,void 0!==e.width&&null!==e.width?t.width=Number(e.width):t.width=0,void 0!==e.height&&null!==e.height?t.height=Number(e.height):t.height=0,void 0!==e.simulcast&&null!==e.simulcast?t.simulcast=Boolean(e.simulcast):t.simulcast=!1,void 0!==e.disableDtx&&null!==e.disableDtx?t.disableDtx=Boolean(e.disableDtx):t.disableDtx=!1,void 0!==e.source&&null!==e.source?t.source=l(e.source):t.source=0,t},toJSON(e){const t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.type&&(t.type=u(e.type)),void 0!==e.name&&(t.name=e.name),void 0!==e.muted&&(t.muted=e.muted),void 0!==e.width&&(t.width=e.width),void 0!==e.height&&(t.height=e.height),void 0!==e.simulcast&&(t.simulcast=e.simulcast),void 0!==e.disableDtx&&(t.disableDtx=e.disableDtx),void 0!==e.source&&(t.source=p(e.source)),t},fromPartial(e){var t,i,a,n,r,s,o,d,c;const u=Object.assign({},x);return u.sid=null!==(t=e.sid)&&void 0!==t?t:"",u.type=null!==(i=e.type)&&void 0!==i?i:0,u.name=null!==(a=e.name)&&void 0!==a?a:"",u.muted=null!==(n=e.muted)&&void 0!==n&&n,u.width=null!==(r=e.width)&&void 0!==r?r:0,u.height=null!==(s=e.height)&&void 0!==s?s:0,u.simulcast=null!==(o=e.simulcast)&&void 0!==o&&o,u.disableDtx=null!==(d=e.disableDtx)&&void 0!==d&&d,u.source=null!==(c=e.source)&&void 0!==c?c:0,u}};const I={kind:0};exports.DataPacket={encode:(e,t=a.default.Writer.create())=>(0!==e.kind&&t.uint32(8).int32(e.kind),void 0!==e.user&&exports.UserPacket.encode(e.user,t.uint32(18).fork()).ldelim(),void 0!==e.speaker&&exports.ActiveSpeakerUpdate.encode(e.speaker,t.uint32(26).fork()).ldelim(),t),decode(e,t){const i=e instanceof a.default.Reader?e:new a.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},I);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.kind=i.int32();break;case 2:r.user=exports.UserPacket.decode(i,i.uint32());break;case 3:r.speaker=exports.ActiveSpeakerUpdate.decode(i,i.uint32());break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},I);return void 0!==e.kind&&null!==e.kind?t.kind=v(e.kind):t.kind=0,void 0!==e.user&&null!==e.user?t.user=exports.UserPacket.fromJSON(e.user):t.user=void 0,void 0!==e.speaker&&null!==e.speaker?t.speaker=exports.ActiveSpeakerUpdate.fromJSON(e.speaker):t.speaker=void 0,t},toJSON(e){const t={};return void 0!==e.kind&&(t.kind=k(e.kind)),void 0!==e.user&&(t.user=e.user?exports.UserPacket.toJSON(e.user):void 0),void 0!==e.speaker&&(t.speaker=e.speaker?exports.ActiveSpeakerUpdate.toJSON(e.speaker):void 0),t},fromPartial(e){var t;const i=Object.assign({},I);return i.kind=null!==(t=e.kind)&&void 0!==t?t:0,void 0!==e.user&&null!==e.user?i.user=exports.UserPacket.fromPartial(e.user):i.user=void 0,void 0!==e.speaker&&null!==e.speaker?i.speaker=exports.ActiveSpeakerUpdate.fromPartial(e.speaker):i.speaker=void 0,i}};const C={};exports.ActiveSpeakerUpdate={encode(e,t=a.default.Writer.create()){for(const i of e.speakers)exports.SpeakerInfo.encode(i,t.uint32(10).fork()).ldelim();return t},decode(e,t){const i=e instanceof a.default.Reader?e:new a.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},C);for(r.speakers=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.speakers.push(exports.SpeakerInfo.decode(i,i.uint32()));break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},C);if(t.speakers=[],void 0!==e.speakers&&null!==e.speakers)for(const i of e.speakers)t.speakers.push(exports.SpeakerInfo.fromJSON(i));return t},toJSON(e){const t={};return e.speakers?t.speakers=e.speakers.map(e=>e?exports.SpeakerInfo.toJSON(e):void 0):t.speakers=[],t},fromPartial(e){const t=Object.assign({},C);if(t.speakers=[],void 0!==e.speakers&&null!==e.speakers)for(const i of e.speakers)t.speakers.push(exports.SpeakerInfo.fromPartial(i));return t}};const h={sid:"",level:0,active:!1};exports.SpeakerInfo={encode:(e,t=a.default.Writer.create())=>(""!==e.sid&&t.uint32(10).string(e.sid),0!==e.level&&t.uint32(21).float(e.level),!0===e.active&&t.uint32(24).bool(e.active),t),decode(e,t){const i=e instanceof a.default.Reader?e:new a.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},h);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.sid=i.string();break;case 2:r.level=i.float();break;case 3:r.active=i.bool();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},h);return void 0!==e.sid&&null!==e.sid?t.sid=String(e.sid):t.sid="",void 0!==e.level&&null!==e.level?t.level=Number(e.level):t.level=0,void 0!==e.active&&null!==e.active?t.active=Boolean(e.active):t.active=!1,t},toJSON(e){const t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.level&&(t.level=e.level),void 0!==e.active&&(t.active=e.active),t},fromPartial(e){var t,i,a;const n=Object.assign({},h);return n.sid=null!==(t=e.sid)&&void 0!==t?t:"",n.level=null!==(i=e.level)&&void 0!==i?i:0,n.active=null!==(a=e.active)&&void 0!==a&&a,n}};const g={participantSid:"",destinationSids:""};exports.UserPacket={encode(e,t=a.default.Writer.create()){""!==e.participantSid&&t.uint32(10).string(e.participantSid),0!==e.payload.length&&t.uint32(18).bytes(e.payload);for(const i of e.destinationSids)t.uint32(26).string(i);return t},decode(e,t){const i=e instanceof a.default.Reader?e:new a.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},g);for(r.destinationSids=[],r.payload=new Uint8Array;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.participantSid=i.string();break;case 2:r.payload=i.bytes();break;case 3:r.destinationSids.push(i.string());break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},g);if(t.destinationSids=[],t.payload=new Uint8Array,void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.payload&&null!==e.payload&&(t.payload=A(e.payload)),void 0!==e.destinationSids&&null!==e.destinationSids)for(const i of e.destinationSids)t.destinationSids.push(String(i));return t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.payload&&(t.payload=D(void 0!==e.payload?e.payload:new Uint8Array)),e.destinationSids?t.destinationSids=e.destinationSids.map(e=>e):t.destinationSids=[],t},fromPartial(e){var t,i;const a=Object.assign({},g);if(a.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",a.payload=null!==(i=e.payload)&&void 0!==i?i:new Uint8Array,a.destinationSids=[],void 0!==e.destinationSids&&null!==e.destinationSids)for(const n of e.destinationSids)a.destinationSids.push(n);return a}};var T=(()=>{if(void 0!==T)return T;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw"Unable to locate global object"})();const y=T.atob||(e=>T.Buffer.from(e,"base64").toString("binary"));function A(e){const t=y(e),i=new Uint8Array(t.length);for(let a=0;a<t.length;++a)i[a]=t.charCodeAt(a);return i}const P=T.btoa||(e=>T.Buffer.from(e,"binary").toString("base64"));function D(e){const t=[];for(const i of e)t.push(String.fromCharCode(i));return P(t.join(""))}function R(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new T.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}a.default.util.Long!==i.default&&(a.default.util.Long=i.default,a.default.configure());
},{"long":"YA3p","protobufjs/minimal":"fCoP"}],"Jka9":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConnectionQualityUpdate=exports.ConnectionQualityInfo=exports.RoomUpdate=exports.SpeakersChanged=exports.ICEServer=exports.LeaveRequest=exports.UpdateTrackSettings=exports.UpdateSubscription=exports.ParticipantUpdate=exports.SessionDescription=exports.TrackPublishedResponse=exports.JoinResponse=exports.MuteTrackRequest=exports.TrickleRequest=exports.AddTrackRequest=exports.SignalResponse=exports.SignalRequest=exports.videoQualityToJSON=exports.videoQualityFromJSON=exports.VideoQuality=exports.signalTargetToJSON=exports.signalTargetFromJSON=exports.SignalTarget=exports.protobufPackage=void 0;const t=e(require("long")),r=e(require("protobufjs/minimal")),i=require("./livekit_models");var o,a;function n(e){switch(e){case 0:case"PUBLISHER":return o.PUBLISHER;case 1:case"SUBSCRIBER":return o.SUBSCRIBER;case-1:case"UNRECOGNIZED":default:return o.UNRECOGNIZED}}function s(e){switch(e){case o.PUBLISHER:return"PUBLISHER";case o.SUBSCRIBER:return"SUBSCRIBER";default:return"UNKNOWN"}}function d(e){switch(e){case 0:case"LOW":return a.LOW;case 1:case"MEDIUM":return a.MEDIUM;case 2:case"HIGH":return a.HIGH;case-1:case"UNRECOGNIZED":default:return a.UNRECOGNIZED}}function c(e){switch(e){case a.LOW:return"LOW";case a.MEDIUM:return"MEDIUM";case a.HIGH:return"HIGH";default:return"UNKNOWN"}}exports.protobufPackage="livekit",function(e){e[e.PUBLISHER=0]="PUBLISHER",e[e.SUBSCRIBER=1]="SUBSCRIBER",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(o=exports.SignalTarget||(exports.SignalTarget={})),exports.signalTargetFromJSON=n,exports.signalTargetToJSON=s,function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(a=exports.VideoQuality||(exports.VideoQuality={})),exports.videoQualityFromJSON=d,exports.videoQualityToJSON=c;const u={};exports.SignalRequest={encode:(e,t=r.default.Writer.create())=>(void 0!==e.offer&&exports.SessionDescription.encode(e.offer,t.uint32(10).fork()).ldelim(),void 0!==e.answer&&exports.SessionDescription.encode(e.answer,t.uint32(18).fork()).ldelim(),void 0!==e.trickle&&exports.TrickleRequest.encode(e.trickle,t.uint32(26).fork()).ldelim(),void 0!==e.addTrack&&exports.AddTrackRequest.encode(e.addTrack,t.uint32(34).fork()).ldelim(),void 0!==e.mute&&exports.MuteTrackRequest.encode(e.mute,t.uint32(42).fork()).ldelim(),void 0!==e.subscription&&exports.UpdateSubscription.encode(e.subscription,t.uint32(50).fork()).ldelim(),void 0!==e.trackSetting&&exports.UpdateTrackSettings.encode(e.trackSetting,t.uint32(58).fork()).ldelim(),void 0!==e.leave&&exports.LeaveRequest.encode(e.leave,t.uint32(66).fork()).ldelim(),t),decode(e,t){const i=e instanceof r.default.Reader?e:new r.default.Reader(e);let o=void 0===t?i.len:i.pos+t;const a=Object.assign({},u);for(;i.pos<o;){const e=i.uint32();switch(e>>>3){case 1:a.offer=exports.SessionDescription.decode(i,i.uint32());break;case 2:a.answer=exports.SessionDescription.decode(i,i.uint32());break;case 3:a.trickle=exports.TrickleRequest.decode(i,i.uint32());break;case 4:a.addTrack=exports.AddTrackRequest.decode(i,i.uint32());break;case 5:a.mute=exports.MuteTrackRequest.decode(i,i.uint32());break;case 6:a.subscription=exports.UpdateSubscription.decode(i,i.uint32());break;case 7:a.trackSetting=exports.UpdateTrackSettings.decode(i,i.uint32());break;case 8:a.leave=exports.LeaveRequest.decode(i,i.uint32());break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},u);return void 0!==e.offer&&null!==e.offer?t.offer=exports.SessionDescription.fromJSON(e.offer):t.offer=void 0,void 0!==e.answer&&null!==e.answer?t.answer=exports.SessionDescription.fromJSON(e.answer):t.answer=void 0,void 0!==e.trickle&&null!==e.trickle?t.trickle=exports.TrickleRequest.fromJSON(e.trickle):t.trickle=void 0,void 0!==e.addTrack&&null!==e.addTrack?t.addTrack=exports.AddTrackRequest.fromJSON(e.addTrack):t.addTrack=void 0,void 0!==e.mute&&null!==e.mute?t.mute=exports.MuteTrackRequest.fromJSON(e.mute):t.mute=void 0,void 0!==e.subscription&&null!==e.subscription?t.subscription=exports.UpdateSubscription.fromJSON(e.subscription):t.subscription=void 0,void 0!==e.trackSetting&&null!==e.trackSetting?t.trackSetting=exports.UpdateTrackSettings.fromJSON(e.trackSetting):t.trackSetting=void 0,void 0!==e.leave&&null!==e.leave?t.leave=exports.LeaveRequest.fromJSON(e.leave):t.leave=void 0,t},toJSON(e){const t={};return void 0!==e.offer&&(t.offer=e.offer?exports.SessionDescription.toJSON(e.offer):void 0),void 0!==e.answer&&(t.answer=e.answer?exports.SessionDescription.toJSON(e.answer):void 0),void 0!==e.trickle&&(t.trickle=e.trickle?exports.TrickleRequest.toJSON(e.trickle):void 0),void 0!==e.addTrack&&(t.addTrack=e.addTrack?exports.AddTrackRequest.toJSON(e.addTrack):void 0),void 0!==e.mute&&(t.mute=e.mute?exports.MuteTrackRequest.toJSON(e.mute):void 0),void 0!==e.subscription&&(t.subscription=e.subscription?exports.UpdateSubscription.toJSON(e.subscription):void 0),void 0!==e.trackSetting&&(t.trackSetting=e.trackSetting?exports.UpdateTrackSettings.toJSON(e.trackSetting):void 0),void 0!==e.leave&&(t.leave=e.leave?exports.LeaveRequest.toJSON(e.leave):void 0),t},fromPartial(e){const t=Object.assign({},u);return void 0!==e.offer&&null!==e.offer?t.offer=exports.SessionDescription.fromPartial(e.offer):t.offer=void 0,void 0!==e.answer&&null!==e.answer?t.answer=exports.SessionDescription.fromPartial(e.answer):t.answer=void 0,void 0!==e.trickle&&null!==e.trickle?t.trickle=exports.TrickleRequest.fromPartial(e.trickle):t.trickle=void 0,void 0!==e.addTrack&&null!==e.addTrack?t.addTrack=exports.AddTrackRequest.fromPartial(e.addTrack):t.addTrack=void 0,void 0!==e.mute&&null!==e.mute?t.mute=exports.MuteTrackRequest.fromPartial(e.mute):t.mute=void 0,void 0!==e.subscription&&null!==e.subscription?t.subscription=exports.UpdateSubscription.fromPartial(e.subscription):t.subscription=void 0,void 0!==e.trackSetting&&null!==e.trackSetting?t.trackSetting=exports.UpdateTrackSettings.fromPartial(e.trackSetting):t.trackSetting=void 0,void 0!==e.leave&&null!==e.leave?t.leave=exports.LeaveRequest.fromPartial(e.leave):t.leave=void 0,t}};const l={};exports.SignalResponse={encode:(e,t=r.default.Writer.create())=>(void 0!==e.join&&exports.JoinResponse.encode(e.join,t.uint32(10).fork()).ldelim(),void 0!==e.answer&&exports.SessionDescription.encode(e.answer,t.uint32(18).fork()).ldelim(),void 0!==e.offer&&exports.SessionDescription.encode(e.offer,t.uint32(26).fork()).ldelim(),void 0!==e.trickle&&exports.TrickleRequest.encode(e.trickle,t.uint32(34).fork()).ldelim(),void 0!==e.update&&exports.ParticipantUpdate.encode(e.update,t.uint32(42).fork()).ldelim(),void 0!==e.trackPublished&&exports.TrackPublishedResponse.encode(e.trackPublished,t.uint32(50).fork()).ldelim(),void 0!==e.leave&&exports.LeaveRequest.encode(e.leave,t.uint32(66).fork()).ldelim(),void 0!==e.mute&&exports.MuteTrackRequest.encode(e.mute,t.uint32(74).fork()).ldelim(),void 0!==e.speakersChanged&&exports.SpeakersChanged.encode(e.speakersChanged,t.uint32(82).fork()).ldelim(),void 0!==e.roomUpdate&&exports.RoomUpdate.encode(e.roomUpdate,t.uint32(90).fork()).ldelim(),void 0!==e.connectionQuality&&exports.ConnectionQualityUpdate.encode(e.connectionQuality,t.uint32(98).fork()).ldelim(),t),decode(e,t){const i=e instanceof r.default.Reader?e:new r.default.Reader(e);let o=void 0===t?i.len:i.pos+t;const a=Object.assign({},l);for(;i.pos<o;){const e=i.uint32();switch(e>>>3){case 1:a.join=exports.JoinResponse.decode(i,i.uint32());break;case 2:a.answer=exports.SessionDescription.decode(i,i.uint32());break;case 3:a.offer=exports.SessionDescription.decode(i,i.uint32());break;case 4:a.trickle=exports.TrickleRequest.decode(i,i.uint32());break;case 5:a.update=exports.ParticipantUpdate.decode(i,i.uint32());break;case 6:a.trackPublished=exports.TrackPublishedResponse.decode(i,i.uint32());break;case 8:a.leave=exports.LeaveRequest.decode(i,i.uint32());break;case 9:a.mute=exports.MuteTrackRequest.decode(i,i.uint32());break;case 10:a.speakersChanged=exports.SpeakersChanged.decode(i,i.uint32());break;case 11:a.roomUpdate=exports.RoomUpdate.decode(i,i.uint32());break;case 12:a.connectionQuality=exports.ConnectionQualityUpdate.decode(i,i.uint32());break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},l);return void 0!==e.join&&null!==e.join?t.join=exports.JoinResponse.fromJSON(e.join):t.join=void 0,void 0!==e.answer&&null!==e.answer?t.answer=exports.SessionDescription.fromJSON(e.answer):t.answer=void 0,void 0!==e.offer&&null!==e.offer?t.offer=exports.SessionDescription.fromJSON(e.offer):t.offer=void 0,void 0!==e.trickle&&null!==e.trickle?t.trickle=exports.TrickleRequest.fromJSON(e.trickle):t.trickle=void 0,void 0!==e.update&&null!==e.update?t.update=exports.ParticipantUpdate.fromJSON(e.update):t.update=void 0,void 0!==e.trackPublished&&null!==e.trackPublished?t.trackPublished=exports.TrackPublishedResponse.fromJSON(e.trackPublished):t.trackPublished=void 0,void 0!==e.leave&&null!==e.leave?t.leave=exports.LeaveRequest.fromJSON(e.leave):t.leave=void 0,void 0!==e.mute&&null!==e.mute?t.mute=exports.MuteTrackRequest.fromJSON(e.mute):t.mute=void 0,void 0!==e.speakersChanged&&null!==e.speakersChanged?t.speakersChanged=exports.SpeakersChanged.fromJSON(e.speakersChanged):t.speakersChanged=void 0,void 0!==e.roomUpdate&&null!==e.roomUpdate?t.roomUpdate=exports.RoomUpdate.fromJSON(e.roomUpdate):t.roomUpdate=void 0,void 0!==e.connectionQuality&&null!==e.connectionQuality?t.connectionQuality=exports.ConnectionQualityUpdate.fromJSON(e.connectionQuality):t.connectionQuality=void 0,t},toJSON(e){const t={};return void 0!==e.join&&(t.join=e.join?exports.JoinResponse.toJSON(e.join):void 0),void 0!==e.answer&&(t.answer=e.answer?exports.SessionDescription.toJSON(e.answer):void 0),void 0!==e.offer&&(t.offer=e.offer?exports.SessionDescription.toJSON(e.offer):void 0),void 0!==e.trickle&&(t.trickle=e.trickle?exports.TrickleRequest.toJSON(e.trickle):void 0),void 0!==e.update&&(t.update=e.update?exports.ParticipantUpdate.toJSON(e.update):void 0),void 0!==e.trackPublished&&(t.trackPublished=e.trackPublished?exports.TrackPublishedResponse.toJSON(e.trackPublished):void 0),void 0!==e.leave&&(t.leave=e.leave?exports.LeaveRequest.toJSON(e.leave):void 0),void 0!==e.mute&&(t.mute=e.mute?exports.MuteTrackRequest.toJSON(e.mute):void 0),void 0!==e.speakersChanged&&(t.speakersChanged=e.speakersChanged?exports.SpeakersChanged.toJSON(e.speakersChanged):void 0),void 0!==e.roomUpdate&&(t.roomUpdate=e.roomUpdate?exports.RoomUpdate.toJSON(e.roomUpdate):void 0),void 0!==e.connectionQuality&&(t.connectionQuality=e.connectionQuality?exports.ConnectionQualityUpdate.toJSON(e.connectionQuality):void 0),t},fromPartial(e){const t=Object.assign({},l);return void 0!==e.join&&null!==e.join?t.join=exports.JoinResponse.fromPartial(e.join):t.join=void 0,void 0!==e.answer&&null!==e.answer?t.answer=exports.SessionDescription.fromPartial(e.answer):t.answer=void 0,void 0!==e.offer&&null!==e.offer?t.offer=exports.SessionDescription.fromPartial(e.offer):t.offer=void 0,void 0!==e.trickle&&null!==e.trickle?t.trickle=exports.TrickleRequest.fromPartial(e.trickle):t.trickle=void 0,void 0!==e.update&&null!==e.update?t.update=exports.ParticipantUpdate.fromPartial(e.update):t.update=void 0,void 0!==e.trackPublished&&null!==e.trackPublished?t.trackPublished=exports.TrackPublishedResponse.fromPartial(e.trackPublished):t.trackPublished=void 0,void 0!==e.leave&&null!==e.leave?t.leave=exports.LeaveRequest.fromPartial(e.leave):t.leave=void 0,void 0!==e.mute&&null!==e.mute?t.mute=exports.MuteTrackRequest.fromPartial(e.mute):t.mute=void 0,void 0!==e.speakersChanged&&null!==e.speakersChanged?t.speakersChanged=exports.SpeakersChanged.fromPartial(e.speakersChanged):t.speakersChanged=void 0,void 0!==e.roomUpdate&&null!==e.roomUpdate?t.roomUpdate=exports.RoomUpdate.fromPartial(e.roomUpdate):t.roomUpdate=void 0,void 0!==e.connectionQuality&&null!==e.connectionQuality?t.connectionQuality=exports.ConnectionQualityUpdate.fromPartial(e.connectionQuality):t.connectionQuality=void 0,t}};const p={cid:"",name:"",type:0,width:0,height:0,muted:!1,disableDtx:!1,source:0};exports.AddTrackRequest={encode:(e,t=r.default.Writer.create())=>(""!==e.cid&&t.uint32(10).string(e.cid),""!==e.name&&t.uint32(18).string(e.name),0!==e.type&&t.uint32(24).int32(e.type),0!==e.width&&t.uint32(32).uint32(e.width),0!==e.height&&t.uint32(40).uint32(e.height),!0===e.muted&&t.uint32(48).bool(e.muted),!0===e.disableDtx&&t.uint32(56).bool(e.disableDtx),0!==e.source&&t.uint32(64).int32(e.source),t),decode(e,t){const i=e instanceof r.default.Reader?e:new r.default.Reader(e);let o=void 0===t?i.len:i.pos+t;const a=Object.assign({},p);for(;i.pos<o;){const e=i.uint32();switch(e>>>3){case 1:a.cid=i.string();break;case 2:a.name=i.string();break;case 3:a.type=i.int32();break;case 4:a.width=i.uint32();break;case 5:a.height=i.uint32();break;case 6:a.muted=i.bool();break;case 7:a.disableDtx=i.bool();break;case 8:a.source=i.int32();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},p);return void 0!==e.cid&&null!==e.cid?t.cid=String(e.cid):t.cid="",void 0!==e.name&&null!==e.name?t.name=String(e.name):t.name="",void 0!==e.type&&null!==e.type?t.type=i.trackTypeFromJSON(e.type):t.type=0,void 0!==e.width&&null!==e.width?t.width=Number(e.width):t.width=0,void 0!==e.height&&null!==e.height?t.height=Number(e.height):t.height=0,void 0!==e.muted&&null!==e.muted?t.muted=Boolean(e.muted):t.muted=!1,void 0!==e.disableDtx&&null!==e.disableDtx?t.disableDtx=Boolean(e.disableDtx):t.disableDtx=!1,void 0!==e.source&&null!==e.source?t.source=i.trackSourceFromJSON(e.source):t.source=0,t},toJSON(e){const t={};return void 0!==e.cid&&(t.cid=e.cid),void 0!==e.name&&(t.name=e.name),void 0!==e.type&&(t.type=i.trackTypeToJSON(e.type)),void 0!==e.width&&(t.width=e.width),void 0!==e.height&&(t.height=e.height),void 0!==e.muted&&(t.muted=e.muted),void 0!==e.disableDtx&&(t.disableDtx=e.disableDtx),void 0!==e.source&&(t.source=i.trackSourceToJSON(e.source)),t},fromPartial(e){var t,r,i,o,a,n,s,d;const c=Object.assign({},p);return c.cid=null!==(t=e.cid)&&void 0!==t?t:"",c.name=null!==(r=e.name)&&void 0!==r?r:"",c.type=null!==(i=e.type)&&void 0!==i?i:0,c.width=null!==(o=e.width)&&void 0!==o?o:0,c.height=null!==(a=e.height)&&void 0!==a?a:0,c.muted=null!==(n=e.muted)&&void 0!==n&&n,c.disableDtx=null!==(s=e.disableDtx)&&void 0!==s&&s,c.source=null!==(d=e.source)&&void 0!==d?d:0,c}};const f={candidateInit:"",target:0};exports.TrickleRequest={encode:(e,t=r.default.Writer.create())=>(""!==e.candidateInit&&t.uint32(10).string(e.candidateInit),0!==e.target&&t.uint32(16).int32(e.target),t),decode(e,t){const i=e instanceof r.default.Reader?e:new r.default.Reader(e);let o=void 0===t?i.len:i.pos+t;const a=Object.assign({},f);for(;i.pos<o;){const e=i.uint32();switch(e>>>3){case 1:a.candidateInit=i.string();break;case 2:a.target=i.int32();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},f);return void 0!==e.candidateInit&&null!==e.candidateInit?t.candidateInit=String(e.candidateInit):t.candidateInit="",void 0!==e.target&&null!==e.target?t.target=n(e.target):t.target=0,t},toJSON(e){const t={};return void 0!==e.candidateInit&&(t.candidateInit=e.candidateInit),void 0!==e.target&&(t.target=s(e.target)),t},fromPartial(e){var t,r;const i=Object.assign({},f);return i.candidateInit=null!==(t=e.candidateInit)&&void 0!==t?t:"",i.target=null!==(r=e.target)&&void 0!==r?r:0,i}};const v={sid:"",muted:!1};exports.MuteTrackRequest={encode:(e,t=r.default.Writer.create())=>(""!==e.sid&&t.uint32(10).string(e.sid),!0===e.muted&&t.uint32(16).bool(e.muted),t),decode(e,t){const i=e instanceof r.default.Reader?e:new r.default.Reader(e);let o=void 0===t?i.len:i.pos+t;const a=Object.assign({},v);for(;i.pos<o;){const e=i.uint32();switch(e>>>3){case 1:a.sid=i.string();break;case 2:a.muted=i.bool();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},v);return void 0!==e.sid&&null!==e.sid?t.sid=String(e.sid):t.sid="",void 0!==e.muted&&null!==e.muted?t.muted=Boolean(e.muted):t.muted=!1,t},toJSON(e){const t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.muted&&(t.muted=e.muted),t},fromPartial(e){var t,r;const i=Object.assign({},v);return i.sid=null!==(t=e.sid)&&void 0!==t?t:"",i.muted=null!==(r=e.muted)&&void 0!==r&&r,i}};const k={serverVersion:"",subscriberPrimary:!1,alternativeUrl:""};exports.JoinResponse={encode(e,t=r.default.Writer.create()){void 0!==e.room&&i.Room.encode(e.room,t.uint32(10).fork()).ldelim(),void 0!==e.participant&&i.ParticipantInfo.encode(e.participant,t.uint32(18).fork()).ldelim();for(const r of e.otherParticipants)i.ParticipantInfo.encode(r,t.uint32(26).fork()).ldelim();""!==e.serverVersion&&t.uint32(34).string(e.serverVersion);for(const r of e.iceServers)exports.ICEServer.encode(r,t.uint32(42).fork()).ldelim();return!0===e.subscriberPrimary&&t.uint32(48).bool(e.subscriberPrimary),""!==e.alternativeUrl&&t.uint32(58).string(e.alternativeUrl),t},decode(e,t){const o=e instanceof r.default.Reader?e:new r.default.Reader(e);let a=void 0===t?o.len:o.pos+t;const n=Object.assign({},k);for(n.otherParticipants=[],n.iceServers=[];o.pos<a;){const e=o.uint32();switch(e>>>3){case 1:n.room=i.Room.decode(o,o.uint32());break;case 2:n.participant=i.ParticipantInfo.decode(o,o.uint32());break;case 3:n.otherParticipants.push(i.ParticipantInfo.decode(o,o.uint32()));break;case 4:n.serverVersion=o.string();break;case 5:n.iceServers.push(exports.ICEServer.decode(o,o.uint32()));break;case 6:n.subscriberPrimary=o.bool();break;case 7:n.alternativeUrl=o.string();break;default:o.skipType(7&e)}}return n},fromJSON(e){const t=Object.assign({},k);if(t.otherParticipants=[],t.iceServers=[],void 0!==e.room&&null!==e.room?t.room=i.Room.fromJSON(e.room):t.room=void 0,void 0!==e.participant&&null!==e.participant?t.participant=i.ParticipantInfo.fromJSON(e.participant):t.participant=void 0,void 0!==e.otherParticipants&&null!==e.otherParticipants)for(const r of e.otherParticipants)t.otherParticipants.push(i.ParticipantInfo.fromJSON(r));if(void 0!==e.serverVersion&&null!==e.serverVersion?t.serverVersion=String(e.serverVersion):t.serverVersion="",void 0!==e.iceServers&&null!==e.iceServers)for(const r of e.iceServers)t.iceServers.push(exports.ICEServer.fromJSON(r));return void 0!==e.subscriberPrimary&&null!==e.subscriberPrimary?t.subscriberPrimary=Boolean(e.subscriberPrimary):t.subscriberPrimary=!1,void 0!==e.alternativeUrl&&null!==e.alternativeUrl?t.alternativeUrl=String(e.alternativeUrl):t.alternativeUrl="",t},toJSON(e){const t={};return void 0!==e.room&&(t.room=e.room?i.Room.toJSON(e.room):void 0),void 0!==e.participant&&(t.participant=e.participant?i.ParticipantInfo.toJSON(e.participant):void 0),e.otherParticipants?t.otherParticipants=e.otherParticipants.map(e=>e?i.ParticipantInfo.toJSON(e):void 0):t.otherParticipants=[],void 0!==e.serverVersion&&(t.serverVersion=e.serverVersion),e.iceServers?t.iceServers=e.iceServers.map(e=>e?exports.ICEServer.toJSON(e):void 0):t.iceServers=[],void 0!==e.subscriberPrimary&&(t.subscriberPrimary=e.subscriberPrimary),void 0!==e.alternativeUrl&&(t.alternativeUrl=e.alternativeUrl),t},fromPartial(e){var t,r,o;const a=Object.assign({},k);if(void 0!==e.room&&null!==e.room?a.room=i.Room.fromPartial(e.room):a.room=void 0,void 0!==e.participant&&null!==e.participant?a.participant=i.ParticipantInfo.fromPartial(e.participant):a.participant=void 0,a.otherParticipants=[],void 0!==e.otherParticipants&&null!==e.otherParticipants)for(const n of e.otherParticipants)a.otherParticipants.push(i.ParticipantInfo.fromPartial(n));if(a.serverVersion=null!==(t=e.serverVersion)&&void 0!==t?t:"",a.iceServers=[],void 0!==e.iceServers&&null!==e.iceServers)for(const i of e.iceServers)a.iceServers.push(exports.ICEServer.fromPartial(i));return a.subscriberPrimary=null!==(r=e.subscriberPrimary)&&void 0!==r&&r,a.alternativeUrl=null!==(o=e.alternativeUrl)&&void 0!==o?o:"",a}};const m={cid:""};exports.TrackPublishedResponse={encode:(e,t=r.default.Writer.create())=>(""!==e.cid&&t.uint32(10).string(e.cid),void 0!==e.track&&i.TrackInfo.encode(e.track,t.uint32(18).fork()).ldelim(),t),decode(e,t){const o=e instanceof r.default.Reader?e:new r.default.Reader(e);let a=void 0===t?o.len:o.pos+t;const n=Object.assign({},m);for(;o.pos<a;){const e=o.uint32();switch(e>>>3){case 1:n.cid=o.string();break;case 2:n.track=i.TrackInfo.decode(o,o.uint32());break;default:o.skipType(7&e)}}return n},fromJSON(e){const t=Object.assign({},m);return void 0!==e.cid&&null!==e.cid?t.cid=String(e.cid):t.cid="",void 0!==e.track&&null!==e.track?t.track=i.TrackInfo.fromJSON(e.track):t.track=void 0,t},toJSON(e){const t={};return void 0!==e.cid&&(t.cid=e.cid),void 0!==e.track&&(t.track=e.track?i.TrackInfo.toJSON(e.track):void 0),t},fromPartial(e){var t;const r=Object.assign({},m);return r.cid=null!==(t=e.cid)&&void 0!==t?t:"",void 0!==e.track&&null!==e.track?r.track=i.TrackInfo.fromPartial(e.track):r.track=void 0,r}};const S={type:"",sdp:""};exports.SessionDescription={encode:(e,t=r.default.Writer.create())=>(""!==e.type&&t.uint32(10).string(e.type),""!==e.sdp&&t.uint32(18).string(e.sdp),t),decode(e,t){const i=e instanceof r.default.Reader?e:new r.default.Reader(e);let o=void 0===t?i.len:i.pos+t;const a=Object.assign({},S);for(;i.pos<o;){const e=i.uint32();switch(e>>>3){case 1:a.type=i.string();break;case 2:a.sdp=i.string();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},S);return void 0!==e.type&&null!==e.type?t.type=String(e.type):t.type="",void 0!==e.sdp&&null!==e.sdp?t.sdp=String(e.sdp):t.sdp="",t},toJSON(e){const t={};return void 0!==e.type&&(t.type=e.type),void 0!==e.sdp&&(t.sdp=e.sdp),t},fromPartial(e){var t,r;const i=Object.assign({},S);return i.type=null!==(t=e.type)&&void 0!==t?t:"",i.sdp=null!==(r=e.sdp)&&void 0!==r?r:"",i}};const b={};exports.ParticipantUpdate={encode(e,t=r.default.Writer.create()){for(const r of e.participants)i.ParticipantInfo.encode(r,t.uint32(10).fork()).ldelim();return t},decode(e,t){const o=e instanceof r.default.Reader?e:new r.default.Reader(e);let a=void 0===t?o.len:o.pos+t;const n=Object.assign({},b);for(n.participants=[];o.pos<a;){const e=o.uint32();switch(e>>>3){case 1:n.participants.push(i.ParticipantInfo.decode(o,o.uint32()));break;default:o.skipType(7&e)}}return n},fromJSON(e){const t=Object.assign({},b);if(t.participants=[],void 0!==e.participants&&null!==e.participants)for(const r of e.participants)t.participants.push(i.ParticipantInfo.fromJSON(r));return t},toJSON(e){const t={};return e.participants?t.participants=e.participants.map(e=>e?i.ParticipantInfo.toJSON(e):void 0):t.participants=[],t},fromPartial(e){const t=Object.assign({},b);if(t.participants=[],void 0!==e.participants&&null!==e.participants)for(const r of e.participants)t.participants.push(i.ParticipantInfo.fromPartial(r));return t}};const g={trackSids:"",subscribe:!1};exports.UpdateSubscription={encode(e,t=r.default.Writer.create()){for(const r of e.trackSids)t.uint32(10).string(r);return!0===e.subscribe&&t.uint32(16).bool(e.subscribe),t},decode(e,t){const i=e instanceof r.default.Reader?e:new r.default.Reader(e);let o=void 0===t?i.len:i.pos+t;const a=Object.assign({},g);for(a.trackSids=[];i.pos<o;){const e=i.uint32();switch(e>>>3){case 1:a.trackSids.push(i.string());break;case 2:a.subscribe=i.bool();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},g);if(t.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const r of e.trackSids)t.trackSids.push(String(r));return void 0!==e.subscribe&&null!==e.subscribe?t.subscribe=Boolean(e.subscribe):t.subscribe=!1,t},toJSON(e){const t={};return e.trackSids?t.trackSids=e.trackSids.map(e=>e):t.trackSids=[],void 0!==e.subscribe&&(t.subscribe=e.subscribe),t},fromPartial(e){var t;const r=Object.assign({},g);if(r.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const i of e.trackSids)r.trackSids.push(i);return r.subscribe=null!==(t=e.subscribe)&&void 0!==t&&t,r}};const h={trackSids:"",disabled:!1,quality:0,width:0,height:0};exports.UpdateTrackSettings={encode(e,t=r.default.Writer.create()){for(const r of e.trackSids)t.uint32(10).string(r);return!0===e.disabled&&t.uint32(24).bool(e.disabled),0!==e.quality&&t.uint32(32).int32(e.quality),0!==e.width&&t.uint32(40).uint32(e.width),0!==e.height&&t.uint32(48).uint32(e.height),t},decode(e,t){const i=e instanceof r.default.Reader?e:new r.default.Reader(e);let o=void 0===t?i.len:i.pos+t;const a=Object.assign({},h);for(a.trackSids=[];i.pos<o;){const e=i.uint32();switch(e>>>3){case 1:a.trackSids.push(i.string());break;case 3:a.disabled=i.bool();break;case 4:a.quality=i.int32();break;case 5:a.width=i.uint32();break;case 6:a.height=i.uint32();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},h);if(t.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const r of e.trackSids)t.trackSids.push(String(r));return void 0!==e.disabled&&null!==e.disabled?t.disabled=Boolean(e.disabled):t.disabled=!1,void 0!==e.quality&&null!==e.quality?t.quality=d(e.quality):t.quality=0,void 0!==e.width&&null!==e.width?t.width=Number(e.width):t.width=0,void 0!==e.height&&null!==e.height?t.height=Number(e.height):t.height=0,t},toJSON(e){const t={};return e.trackSids?t.trackSids=e.trackSids.map(e=>e):t.trackSids=[],void 0!==e.disabled&&(t.disabled=e.disabled),void 0!==e.quality&&(t.quality=c(e.quality)),void 0!==e.width&&(t.width=e.width),void 0!==e.height&&(t.height=e.height),t},fromPartial(e){var t,r,i,o;const a=Object.assign({},h);if(a.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const n of e.trackSids)a.trackSids.push(n);return a.disabled=null!==(t=e.disabled)&&void 0!==t&&t,a.quality=null!==(r=e.quality)&&void 0!==r?r:0,a.width=null!==(i=e.width)&&void 0!==i?i:0,a.height=null!==(o=e.height)&&void 0!==o?o:0,a}};const O={canReconnect:!1};exports.LeaveRequest={encode:(e,t=r.default.Writer.create())=>(!0===e.canReconnect&&t.uint32(8).bool(e.canReconnect),t),decode(e,t){const i=e instanceof r.default.Reader?e:new r.default.Reader(e);let o=void 0===t?i.len:i.pos+t;const a=Object.assign({},O);for(;i.pos<o;){const e=i.uint32();switch(e>>>3){case 1:a.canReconnect=i.bool();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},O);return void 0!==e.canReconnect&&null!==e.canReconnect?t.canReconnect=Boolean(e.canReconnect):t.canReconnect=!1,t},toJSON(e){const t={};return void 0!==e.canReconnect&&(t.canReconnect=e.canReconnect),t},fromPartial(e){var t;const r=Object.assign({},O);return r.canReconnect=null!==(t=e.canReconnect)&&void 0!==t&&t,r}};const x={urls:"",username:"",credential:""};exports.ICEServer={encode(e,t=r.default.Writer.create()){for(const r of e.urls)t.uint32(10).string(r);return""!==e.username&&t.uint32(18).string(e.username),""!==e.credential&&t.uint32(26).string(e.credential),t},decode(e,t){const i=e instanceof r.default.Reader?e:new r.default.Reader(e);let o=void 0===t?i.len:i.pos+t;const a=Object.assign({},x);for(a.urls=[];i.pos<o;){const e=i.uint32();switch(e>>>3){case 1:a.urls.push(i.string());break;case 2:a.username=i.string();break;case 3:a.credential=i.string();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},x);if(t.urls=[],void 0!==e.urls&&null!==e.urls)for(const r of e.urls)t.urls.push(String(r));return void 0!==e.username&&null!==e.username?t.username=String(e.username):t.username="",void 0!==e.credential&&null!==e.credential?t.credential=String(e.credential):t.credential="",t},toJSON(e){const t={};return e.urls?t.urls=e.urls.map(e=>e):t.urls=[],void 0!==e.username&&(t.username=e.username),void 0!==e.credential&&(t.credential=e.credential),t},fromPartial(e){var t,r;const i=Object.assign({},x);if(i.urls=[],void 0!==e.urls&&null!==e.urls)for(const o of e.urls)i.urls.push(o);return i.username=null!==(t=e.username)&&void 0!==t?t:"",i.credential=null!==(r=e.credential)&&void 0!==r?r:"",i}};const R={};exports.SpeakersChanged={encode(e,t=r.default.Writer.create()){for(const r of e.speakers)i.SpeakerInfo.encode(r,t.uint32(10).fork()).ldelim();return t},decode(e,t){const o=e instanceof r.default.Reader?e:new r.default.Reader(e);let a=void 0===t?o.len:o.pos+t;const n=Object.assign({},R);for(n.speakers=[];o.pos<a;){const e=o.uint32();switch(e>>>3){case 1:n.speakers.push(i.SpeakerInfo.decode(o,o.uint32()));break;default:o.skipType(7&e)}}return n},fromJSON(e){const t=Object.assign({},R);if(t.speakers=[],void 0!==e.speakers&&null!==e.speakers)for(const r of e.speakers)t.speakers.push(i.SpeakerInfo.fromJSON(r));return t},toJSON(e){const t={};return e.speakers?t.speakers=e.speakers.map(e=>e?i.SpeakerInfo.toJSON(e):void 0):t.speakers=[],t},fromPartial(e){const t=Object.assign({},R);if(t.speakers=[],void 0!==e.speakers&&null!==e.speakers)for(const r of e.speakers)t.speakers.push(i.SpeakerInfo.fromPartial(r));return t}};const P={};exports.RoomUpdate={encode:(e,t=r.default.Writer.create())=>(void 0!==e.room&&i.Room.encode(e.room,t.uint32(10).fork()).ldelim(),t),decode(e,t){const o=e instanceof r.default.Reader?e:new r.default.Reader(e);let a=void 0===t?o.len:o.pos+t;const n=Object.assign({},P);for(;o.pos<a;){const e=o.uint32();switch(e>>>3){case 1:n.room=i.Room.decode(o,o.uint32());break;default:o.skipType(7&e)}}return n},fromJSON(e){const t=Object.assign({},P);return void 0!==e.room&&null!==e.room?t.room=i.Room.fromJSON(e.room):t.room=void 0,t},toJSON(e){const t={};return void 0!==e.room&&(t.room=e.room?i.Room.toJSON(e.room):void 0),t},fromPartial(e){const t=Object.assign({},P);return void 0!==e.room&&null!==e.room?t.room=i.Room.fromPartial(e.room):t.room=void 0,t}};const y={participantSid:"",quality:0};exports.ConnectionQualityInfo={encode:(e,t=r.default.Writer.create())=>(""!==e.participantSid&&t.uint32(10).string(e.participantSid),0!==e.quality&&t.uint32(16).int32(e.quality),t),decode(e,t){const i=e instanceof r.default.Reader?e:new r.default.Reader(e);let o=void 0===t?i.len:i.pos+t;const a=Object.assign({},y);for(;i.pos<o;){const e=i.uint32();switch(e>>>3){case 1:a.participantSid=i.string();break;case 2:a.quality=i.int32();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},y);return void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.quality&&null!==e.quality?t.quality=i.connectionQualityFromJSON(e.quality):t.quality=0,t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.quality&&(t.quality=i.connectionQualityToJSON(e.quality)),t},fromPartial(e){var t,r;const i=Object.assign({},y);return i.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",i.quality=null!==(r=e.quality)&&void 0!==r?r:0,i}};const N={};exports.ConnectionQualityUpdate={encode(e,t=r.default.Writer.create()){for(const r of e.updates)exports.ConnectionQualityInfo.encode(r,t.uint32(10).fork()).ldelim();return t},decode(e,t){const i=e instanceof r.default.Reader?e:new r.default.Reader(e);let o=void 0===t?i.len:i.pos+t;const a=Object.assign({},N);for(a.updates=[];i.pos<o;){const e=i.uint32();switch(e>>>3){case 1:a.updates.push(exports.ConnectionQualityInfo.decode(i,i.uint32()));break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},N);if(t.updates=[],void 0!==e.updates&&null!==e.updates)for(const r of e.updates)t.updates.push(exports.ConnectionQualityInfo.fromJSON(r));return t},toJSON(e){const t={};return e.updates?t.updates=e.updates.map(e=>e?exports.ConnectionQualityInfo.toJSON(e):void 0):t.updates=[],t},fromPartial(e){const t=Object.assign({},N);if(t.updates=[],void 0!==e.updates&&null!==e.updates)for(const r of e.updates)t.updates.push(exports.ConnectionQualityInfo.fromPartial(r));return t}},r.default.util.Long!==t.default&&(r.default.util.Long=t.default,r.default.configure());
},{"long":"YA3p","protobufjs/minimal":"fCoP","./livekit_models":"OxfL"}],"ohSP":[function(require,module,exports) {
var define;
var e;!function(o,t){"use strict";"function"==typeof e&&e.amd?e(t):"object"==typeof module&&module.exports?module.exports=t():o.log=t()}(this,function(){"use strict";var e=function(){},o="undefined",t=typeof window!==o&&typeof window.navigator!==o&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function l(e,o){var t=e[o];if("function"==typeof t.bind)return t.bind(e);try{return Function.prototype.bind.call(t,e)}catch(n){return function(){return Function.prototype.apply.apply(t,[e,arguments])}}}function i(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function r(o,t){for(var l=0;l<n.length;l++){var i=n[l];this[i]=l<o?e:this.methodFactory(i,o,t)}this.log=this.debug}function c(n,c,a){return function(n){return"debug"===n&&(n="log"),typeof console!==o&&("trace"===n&&t?i:void 0!==console[n]?l(console,n):void 0!==console.log?l(console,"log"):e)}(n)||function(e,t,n){return function(){typeof console!==o&&(r.call(this,t,n),this[e].apply(this,arguments))}}.apply(this,arguments)}function a(e,t,l){var i,a=this;t=null==t?"WARN":t;var u="loglevel";function s(){var e;if(typeof window!==o&&u){try{e=window.localStorage[u]}catch(l){}if(typeof e===o)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(u)+"=");-1!==n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(l){}return void 0===a.levels[e]&&(e=void 0),e}}"string"==typeof e?u+=":"+e:"symbol"==typeof e&&(u=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=l||c,a.getLevel=function(){return i},a.setLevel=function(t,l){if("string"==typeof t&&void 0!==a.levels[t.toUpperCase()]&&(t=a.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(i=t,!1!==l&&function(e){var t=(n[e]||"silent").toUpperCase();if(typeof window!==o&&u){try{return void(window.localStorage[u]=t)}catch(l){}try{window.document.cookie=encodeURIComponent(u)+"="+t+";"}catch(l){}}}(t),r.call(a,t,e),typeof console===o&&t<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){t=e,s()||a.setLevel(e,!1)},a.resetLevel=function(){a.setLevel(t,!1),function(){if(typeof window!==o&&u){try{return void window.localStorage.removeItem(u)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var f=s();null==f&&(f=t),a.setLevel(f,!1)}var u=new a,s={};u.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var o=s[e];return o||(o=s[e]=new a(e,u.getLevel(),u.methodFactory)),o};var f=typeof window!==o?window.log:void 0;return u.noConflict=function(){return typeof window!==o&&window.log===u&&(window.log=f),u},u.getLoggers=function(){return s},u.default=u,u});
},{}],"mQuM":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const t=e(require("loglevel")),r=t.default.getLogger("livekit");exports.default=r;
},{"loglevel":"ohSP"}],"ZNBW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ScreenSharePresets=exports.VideoPresets43=exports.VideoPresets=exports.AudioPresets=exports.VideoPreset=void 0;class e{constructor(e,t,s,r){this.width=e,this.height=t,this.encoding={maxBitrate:s,maxFramerate:r}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate}}}var t;exports.VideoPreset=e,function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:2e4},e.music={maxBitrate:32e3}}(t=exports.AudioPresets||(exports.AudioPresets={})),exports.VideoPresets={qvga:new e(320,180,125e3,15),vga:new e(640,360,4e5,30),qhd:new e(960,540,8e5,30),hd:new e(1280,720,25e5,30),fhd:new e(1920,1080,4e6,30)},exports.VideoPresets43={qvga:new e(240,180,1e5,15),vga:new e(480,360,32e4,30),qhd:new e(720,540,64e4,30),hd:new e(960,720,2e6,30),fhd:new e(1440,1080,32e5,30)},exports.ScreenSharePresets={vga:new e(640,360,2e5,3),hd_8:new e(1280,720,4e5,5),hd_15:new e(1280,720,125e4,15),fhd_15:new e(1920,1080,2e6,15),fhd_30:new e(1920,1080,4e6,30)};
},{}],"drFi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setTrackCaptureDefaults=exports.getTrackCaptureDefaults=exports.setTrackPublishDefaults=exports.getTrackPublishDefaults=void 0;const e=require("./track/options");let t={audioBitrate:e.AudioPresets.speech.maxBitrate,stopMicTrackOnMute:!1},s={autoGainControl:!0,channelCount:1,echoCancellation:!0,noiseSuppression:!0,videoResolution:e.VideoPresets.qhd.resolution};function r(){return t}function o(e){t=e}function u(){return s}function a(e){s=e}exports.getTrackPublishDefaults=r,exports.setTrackPublishDefaults=o,exports.getTrackCaptureDefaults=u,exports.setTrackCaptureDefaults=a;
},{"./track/options":"ZNBW"}],"k3b3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MediaDeviceFailure=exports.PublishDataError=exports.UnexpectedConnectionState=exports.UnsupportedServer=exports.TrackInvalidError=exports.ConnectionError=exports.LivekitError=void 0;class e extends Error{constructor(e,r){super(r||"an error has occured"),this.code=e}}exports.LivekitError=e;class r extends e{constructor(e){super(1,e)}}exports.ConnectionError=r;class o extends e{constructor(e){super(20,e||"Track is invalid")}}exports.TrackInvalidError=o;class t extends e{constructor(e){super(10,e||"Unsupported server")}}exports.UnsupportedServer=t;class s extends e{constructor(e){super(12,e||"Unexpected connection state")}}exports.UnexpectedConnectionState=s;class n extends e{constructor(e){super(13,e||"Unable to publish data")}}var i;exports.PublishDataError=n,function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"}(i=exports.MediaDeviceFailure||(exports.MediaDeviceFailure={})),function(e){e.getFailure=function(r){if(r&&"name"in r)return"NotFoundError"===r.name||"DevicesNotFoundError"===r.name?e.NotFound:"NotAllowedError"===r.name||"PermissionDeniedError"===r.name?e.PermissionDenied:"NotReadableError"===r.name||"TrackStartError"===r.name?e.DeviceInUse:e.Other}}(i=exports.MediaDeviceFailure||(exports.MediaDeviceFailure={}));
},{}],"q9Tz":[function(require,module,exports) {
"use strict";var e,a,t,n;Object.defineProperty(exports,"__esModule",{value:!0}),exports.TrackEvent=exports.EngineEvent=exports.ParticipantEvent=exports.RoomEvent=void 0,function(e){e.Reconnecting="reconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.ActiveSpeakersChanged="activeSpeakersChanged",e.MetadataChanged="metadataChanged",e.ParticipantMetadataChanged="participantMetaDataChanged",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.MediaDevicesError="mediaDevicesError",e.ConnectionQualityChanged="connectionQualityChanged"}(e=exports.RoomEvent||(exports.RoomEvent={})),function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.MetadataChanged="metadataChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.DataReceived="dataReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.MediaDevicesError="mediaDevicesError"}(a=exports.ParticipantEvent||(exports.ParticipantEvent={})),function(e){e.Connected="connected",e.Disconnected="disconnected",e.Reconnecting="reconnecting",e.Reconnected="reconnected",e.ParticipantUpdate="participantUpdate",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.SpeakersChanged="speakersChanged",e.DataPacketReceived="dataPacketReceived",e.RemoteMuteChanged="remoteMuteChanged",e.RoomUpdate="roomUpdate",e.ConnectionQualityUpdate="connectionQualityUpdate"}(t=exports.EngineEvent||(exports.EngineEvent={})),function(e){e.Message="message",e.Muted="muted",e.Unmuted="unmuted",e.Ended="ended",e.UpdateSettings="updateSettings",e.UpdateSubscription="updateSubscription",e.AudioPlaybackStarted="audioPlaybackStarted",e.AudioPlaybackFailed="audioPlaybackFailed",e.VisibilityChanged="visibilityChanged",e.VideoDimensionsChanged="videoDimensionsChanged"}(n=exports.TrackEvent||(exports.TrackEvent={}));
},{}],"FLCb":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function c(e){try{d(n.next(e))}catch(t){o(t)}}function u(e){try{d(n.throw(e))}catch(t){o(t)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(c,u)}d((n=n.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const t="default";class i{static getInstance(){return void 0===this.instance&&(this.instance=new i),this.instance}getDevices(i){return e(this,void 0,void 0,function*(){let e=yield navigator.mediaDevices.enumerateDevices();if((e=e.filter(e=>e.kind===i)).length>1&&e[0].deviceId===t){const t=e[0];for(let i=1;i<e.length;i+=1)if(e[i].groupId===t.groupId){const t=e[0];e[0]=e[i],e[i]=t;break}return e.filter(e=>e!==t)}return e})}normalizeDeviceId(i,n,r){return e(this,void 0,void 0,function*(){if(n!==t)return n;const e=(yield this.getDevices(i)).find(e=>e.groupId===r&&e.deviceId!==t);return null==e?void 0:e.deviceId})}}exports.default=i,i.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];
},{}],"wIHY":[function(require,module,exports) {
"use strict";var e,t="object"==typeof Reflect?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function r(e){console&&console.warn&&console.warn(e)}e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}module.exports=o,module.exports.once=m,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function f(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,n,i){var o,s,c;if(u(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),c=s[t]),void 0===c)c=s[t]=n,++e._eventsCount;else if("function"==typeof c?c=s[t]=i?[n,c]:[c,n]:i?c.unshift(n):c.push(n),(o=f(e))>0&&c.length>o&&!c.warned){c.warned=!0;var v=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");v.name="MaxListenersExceededWarning",v.emitter=e,v.type=t,v.count=c.length,r(v)}return e}function v(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=v.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?d(i):h(i,i.length)}function a(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function h(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function d(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function m(e,t){return new Promise(function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&L(e,i,{once:!0})})}function L(e,t,n){"function"==typeof e.on&&g(e,"error",t,n)}function g(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(o){r.once&&e.removeEventListener(t,i),n(o)})}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return f(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var u=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw u.context=s,u}var f=o[e];if(void 0===f)return!1;if("function"==typeof f)n(f,this,t);else{var c=f.length,v=h(f,c);for(r=0;r<c;++r)n(v[r],this,t)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){return u(t),this.on(e,l(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,l(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,s;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():y(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return p(this,e,!0)},o.prototype.rawListeners=function(e){return p(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):a.call(e,t)},o.prototype.listenerCount=a,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]};
},{}],"UBMR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.detachTrack=exports.attachToElement=exports.Track=void 0;const e=require("events"),t=require("../../proto/livekit_models"),r=require("../events"),a=[];class c extends e.EventEmitter{constructor(e,t,r){super(),this.attachedElements=[],this.isMuted=!1,this.kind=t,this.mediaStreamTrack=e,this.name=r||"",this.source=c.Source.Unknown}attach(e){let t="audio";return this.kind===c.Kind.Video&&(t="video"),e||("audio"===t&&(a.forEach(t=>{null!==t.parentElement||e||(e=t)}),e&&a.splice(a.indexOf(e),1)),e||(e=document.createElement(t))),e instanceof HTMLVideoElement&&(e.playsInline=!0,e.autoplay=!0),this.attachedElements.includes(e)?e:(n(this.mediaStreamTrack,e),this.attachedElements.push(e),e instanceof HTMLAudioElement&&e.play().then(()=>{this.emit(r.TrackEvent.AudioPlaybackStarted)}).catch(e=>{this.emit(r.TrackEvent.AudioPlaybackFailed,e)}),e)}detach(e){if(e){o(this.mediaStreamTrack,e);const t=this.attachedElements.indexOf(e);return t>=0&&(this.attachedElements.splice(t,1),this.recycleElement(e)),e}const t=[];return this.attachedElements.forEach(e=>{o(this.mediaStreamTrack,e),t.push(e),this.recycleElement(e)}),this.attachedElements=[],t}stop(){this.mediaStreamTrack.stop()}enable(){this.mediaStreamTrack.enabled=!0}disable(){this.mediaStreamTrack.enabled=!1}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),a.forEach(e=>{e.parentElement||(t=!1)}),t&&a.push(e)}}}function n(e,t){let r,a;t.srcObject instanceof MediaStream?r=t.srcObject:(r=new MediaStream,t.srcObject=r),(a="audio"===e.kind?r.getAudioTracks():r.getVideoTracks()).forEach(e=>{r.removeTrack(e)}),r.addTrack(e)}function o(e,t){if(t.srcObject instanceof MediaStream){t.srcObject.removeTrack(e),t.srcObject=null}}exports.Track=c,exports.attachToElement=n,exports.detachTrack=o,function(e){let r,a;!function(e){e.Audio="audio",e.Video="video",e.Unknown="unknown"}(r=e.Kind||(e.Kind={})),function(e){e.Camera="camera",e.Microphone="microphone",e.ScreenShare="screen_share",e.ScreenShareAudio="screen_share_audio",e.Unknown="unknown"}(a=e.Source||(e.Source={})),e.kindToProto=function(e){switch(e){case r.Audio:return t.TrackType.AUDIO;case r.Video:return t.TrackType.VIDEO;default:return t.TrackType.UNRECOGNIZED}},e.kindFromProto=function(e){switch(e){case t.TrackType.AUDIO:return r.Audio;case t.TrackType.VIDEO:return r.Video;default:return r.Unknown}},e.sourceToProto=function(e){switch(e){case a.Camera:return t.TrackSource.CAMERA;case a.Microphone:return t.TrackSource.MICROPHONE;case a.ScreenShare:return t.TrackSource.SCREEN_SHARE;case a.ScreenShareAudio:return t.TrackSource.SCREEN_SHARE_AUDIO;default:return t.TrackSource.UNRECOGNIZED}},e.sourceFromProto=function(e){switch(e){case t.TrackSource.CAMERA:return a.Camera;case t.TrackSource.MICROPHONE:return a.Microphone;case t.TrackSource.SCREEN_SHARE:return a.ScreenShare;case t.TrackSource.SCREEN_SHARE_AUDIO:return a.ScreenShareAudio;default:return a.Unknown}}}(c=exports.Track||(exports.Track={}));
},{"events":"wIHY","../../proto/livekit_models":"OxfL","../events":"q9Tz"}],"Tqjs":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,a){function d(e){try{s(n.next(e))}catch(t){a(t)}}function o(e){try{s(n.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(d,o)}s((n=n.apply(e,t||[])).next())})},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const i=t(require("../../logger")),n=require("../defaults"),r=t(require("../DeviceManager")),a=require("../errors"),d=require("../events"),o=require("./Track");class s extends o.Track{constructor(e,t,i,n){super(e,t,i),this.handleEnded=(()=>{this.emit(d.TrackEvent.Ended)}),this.mediaStreamTrack.addEventListener("ended",this.handleEnded),this.constraints=null!=n?n:e.getConstraints()}get id(){return this.mediaStreamTrack.id}get dimensions(){if(this.kind!==o.Track.Kind.Video)return;const{width:e,height:t}=this.mediaStreamTrack.getSettings();return e&&t?{width:e,height:t}:void 0}static constraintsForOptions(e){const t={},i=n.getTrackCaptureDefaults(),r={deviceId:i.videoDeviceId};i.videoResolution&&(r.width=i.videoResolution.width,r.height=i.videoResolution.height,r.frameRate=i.videoResolution.frameRate),"object"==typeof e.video&&e.video&&(Object.assign(r,e.video),e.video.resolution&&Object.assign(r,e.video.resolution)),!1===e.video?t.video=!1:t.video=r;const a={deviceId:i.audioDeviceId,echoCancellation:i.echoCancellation,autoGainControl:i.autoGainControl,noiseSuppression:i.noiseSuppression,channelCount:i.channelCount};return"object"==typeof e.audio&&e.audio&&Object.assign(a,e.audio),!1===e.audio?t.audio=!1:t.audio=a,t}getDeviceId(){return e(this,void 0,void 0,function*(){if(this.source===o.Track.Source.ScreenShare)return;const{deviceId:e,groupId:t}=this.mediaStreamTrack.getSettings(),i=this.kind===o.Track.Kind.Audio?"audioinput":"videoinput";return r.default.getInstance().normalizeDeviceId(i,e,t)})}mute(){return e(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return e(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}restart(t){return e(this,void 0,void 0,function*(){if(!this.sender)throw new a.TrackInvalidError("unable to restart an unpublished track");t||(t=this.constraints),i.default.debug("restarting track with constraints",t);const e={audio:!1,video:!1};this.kind===o.Track.Kind.Video?e.video=t:e.audio=t,this.attachedElements.forEach(e=>{o.detachTrack(this.mediaStreamTrack,e)}),this.mediaStreamTrack.removeEventListener("ended",this.handleEnded),this.mediaStreamTrack.stop();const n=(yield navigator.mediaDevices.getUserMedia(e)).getTracks()[0];return n.addEventListener("ended",this.handleEnded),i.default.debug("re-acquired MediaStreamTrack"),yield this.sender.replaceTrack(n),this.mediaStreamTrack=n,this.attachedElements.forEach(e=>{o.attachToElement(n,e)}),this.constraints=t,this})}setTrackMuted(e){this.isMuted!==e&&(this.isMuted=e,this.mediaStreamTrack.enabled=!e,this.emit(e?d.TrackEvent.Muted:d.TrackEvent.Unmuted,this))}}exports.default=s;
},{"../../logger":"mQuM","../defaults":"drFi","../DeviceManager":"FLCb","../errors":"k3b3","../events":"q9Tz","./Track":"UBMR"}],"fkZQ":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))(function(u,n){function s(t){try{c(r.next(t))}catch(e){n(e)}}function o(t){try{c(r.throw(t))}catch(e){n(e)}}function c(t){var e;t.done?u(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(s,o)}c((r=r.apply(t,e||[])).next())})},e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const i=e(require("../../logger")),r=e(require("./LocalTrack")),u=require("./Track");class n extends r.default{constructor(t,e,i){super(t,u.Track.Kind.Audio,e,i),this.stopOnMute=!1}setDeviceId(e){return t(this,void 0,void 0,function*(){this.constraints.deviceId!==e&&(this.constraints.deviceId=e,this.isMuted||(yield this.restartTrack()))})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return t(this,void 0,void 0,function*(){return this.source===u.Track.Source.Microphone&&this.stopOnMute&&(i.default.debug("stopping mic track"),this.mediaStreamTrack.stop()),yield e.mute.call(this),this})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return t(this,void 0,void 0,function*(){return this.source===u.Track.Source.Microphone&&this.stopOnMute&&(i.default.debug("reacquiring mic track"),yield this.restartTrack()),yield e.unmute.call(this),this})}restartTrack(e){return t(this,void 0,void 0,function*(){let t;if(e){const i=r.default.constraintsForOptions({audio:e});"boolean"!=typeof i.audio&&(t=i.audio)}yield this.restart(t)})}}exports.default=n;
},{"../../logger":"mQuM","./LocalTrack":"Tqjs","./Track":"UBMR"}],"PhSm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.monitorFrequency=void 0,exports.monitorFrequency=2e3;
},{}],"KIm9":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(r,n){function a(t){try{u(s.next(t))}catch(e){n(e)}}function o(t){try{u(s.throw(t))}catch(e){n(e)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,o)}u((s=s.apply(t,e||[])).next())})},e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const i=e(require("../../logger")),s=require("../../proto/livekit_rtc"),r=require("../stats"),n=e(require("./LocalTrack")),a=require("./Track"),o=6e4,u=5e3,d=["q","h","f"];class c extends n.default{constructor(e,i,s){super(e,a.Track.Kind.Video,i,s),this.monitorSender=(()=>t(this,void 0,void 0,function*(){if(!this.sender)return;const t=yield this.getSenderStats(),e=new Map(t.map(t=>[t.rid,t]));this.prevStats&&this.isSimulcast&&this.checkAndUpdateSimulcast(e),this.prevStats=e,setTimeout(()=>{this.monitorSender()},r.monitorFrequency)}))}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(t){this.isSimulcast&&(this.signalClient=t,setTimeout(()=>{this.monitorSender()},r.monitorFrequency))}stop(){this.sender=void 0,this.mediaStreamTrack.getConstraints(),super.stop()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return t(this,void 0,void 0,function*(){return this.source===a.Track.Source.Camera&&(i.default.debug("stopping camera track"),this.mediaStreamTrack.stop()),yield e.mute.call(this),this})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return t(this,void 0,void 0,function*(){return this.source===a.Track.Source.Camera&&(i.default.debug("reacquiring camera track"),yield this.restartTrack()),yield e.unmute.call(this),this})}getSenderStats(){return t(this,void 0,void 0,function*(){if(!this.sender)return[];const t=[],e=yield this.sender.getStats();let i;return e.forEach(t=>{"track"===t.type&&t.trackIdentifier===this.mediaStreamTrack.id&&(i=t)}),i?(e.forEach(s=>{if("outbound-rtp"===s.type&&s.trackId===i.id){const i={type:"video",streamId:s.id,frameHeight:s.frameHeight,frameWidth:s.frameWidth,firCount:s.firCount,pliCount:s.pliCount,nackCount:s.nackCount,packetsSent:s.packetsSent,framesSent:s.framesSent,timestamp:s.timestamp,rid:s.rid,retransmittedPacketsSent:s.retransmittedPacketsSent,qualityLimitationReason:s.qualityLimitationReason,qualityLimitationResolutionChanges:s.qualityLimitationResolutionChanges},r=e.get(s.remoteId);r&&(i.jitter=r.jitter,i.packetsLost=r.packetsLost,i.roundTripTime=r.roundTripTime),t.push(i)}}),t):t})}setPublishingQuality(t){if(!this.isSimulcast||!this.encodings)return;let e=!1;const s=[];if(this.encodings.forEach(i=>{var r;const n=l(null!==(r=i.rid)&&void 0!==r?r:""),a=n<=t;a!==i.active&&(e=!0,i.active=a),a&&s.push(n)}),!e||!this.sender||!this.sid)return;this.lastQualityChange=(new Date).getTime(),this.lastExplicitQualityChange=(new Date).getTime();const r=this.sender.getParameters();r.encodings=this.encodings,i.default.debug("setting publishing quality. max quality",t),this.sender.setParameters(r)}setDeviceId(e){return t(this,void 0,void 0,function*(){this.constraints.deviceId!==e&&(this.constraints.deviceId=e,this.isMuted||(yield this.restartTrack()))})}restartTrack(e){return t(this,void 0,void 0,function*(){let t;if(e){const i=n.default.constraintsForOptions({video:e});"boolean"!=typeof i.video&&(t=i.video)}yield this.restart(t)})}checkAndUpdateSimulcast(t){var e,r;if(!this.sender||this.isMuted)return;const n=this.sender.getParameters();let a;if(this.encodings=n.encodings,this.encodings.forEach(t=>{t.active&&(void 0===a?a=t:a.rid&&t.rid&&d.indexOf(a.rid)<d.indexOf(t.rid)?a=t:void 0!==a.maxBitrate&&void 0!==t.maxBitrate&&a.maxBitrate<t.maxBitrate&&(a=t))}),!a)return;const c=null!==(e=a.rid)&&void 0!==e?e:"",h=t.get(c),m=null===(r=this.prevStats)||void 0===r?void 0:r.get(c);if(!h||!m)return;const f=l(c);if(h.qualityLimitationResolutionChanges-m.qualityLimitationResolutionChanges>0&&(this.lastQualityChange=(new Date).getTime()),h.framesSent-m.framesSent>0){if(f===s.VideoQuality.HIGH||!this.lastQualityChange)return;const t=f+1;if((new Date).getTime()-this.lastQualityChange<o)return;return i.default.debug("upgrading video quality to",t),void this.setPublishingQuality(t)}0!==h.framesSent&&(this.lastExplicitQualityChange&&(new Date).getTime()-this.lastExplicitQualityChange<u||f!==s.VideoQuality.UNRECOGNIZED&&f!==s.VideoQuality.LOW&&(i.default.debug("downgrading video quality to",f-1),this.setPublishingQuality(f-1)))}}function l(t){switch(t){case"f":return s.VideoQuality.HIGH;case"h":return s.VideoQuality.MEDIUM;case"q":return s.VideoQuality.LOW;default:return s.VideoQuality.UNRECOGNIZED}}exports.default=c;
},{"../../logger":"mQuM","../../proto/livekit_rtc":"Jka9","../stats":"PhSm","./LocalTrack":"Tqjs","./Track":"UBMR"}],"JpFY":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,o,r,t){return new(r||(r=Promise))(function(i,n){function a(e){try{u(t.next(e))}catch(o){n(o)}}function c(e){try{u(t.throw(e))}catch(o){n(o)}}function u(e){var o;e.done?i(e.value):(o=e.value,o instanceof r?o:new r(function(e){e(o)})).then(a,c)}u((t=t.apply(e,o||[])).next())})},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createLocalScreenTracks=exports.createLocalAudioTrack=exports.createLocalVideoTrack=exports.createLocalTracks=exports.getLastVideoCreateError=exports.getLastAudioCreateError=void 0;const r=require("../errors"),t=o(require("./LocalAudioTrack")),i=o(require("./LocalTrack")),n=o(require("./LocalVideoTrack")),a=require("./options"),c=require("./Track");let u,d;function s(){return u}function l(){return d}function v(o){return e(this,void 0,void 0,function*(){o||(o={}),!0===o.audio&&(o.audio={}),!0===o.video&&(o.video={});const e=i.default.constraintsForOptions(o);let r;try{r=yield navigator.mediaDevices.getUserMedia(e)}catch(t){throw t instanceof Error&&(e.audio&&(u=t),e.video&&(d=t)),t}return e.audio&&(u=void 0),e.video&&(d=void 0),r.getTracks().map(r=>{const t="audio"===r.kind;let i,n=t?o.audio:o.video;"boolean"!=typeof n&&n||(n={});const a=t?e.audio:e.video;"boolean"!=typeof a&&(i=a);const u=p(r,null==n?void 0:n.name,i);return u.kind===c.Track.Kind.Video?u.source=c.Track.Source.Camera:u.kind===c.Track.Kind.Audio&&(u.source=c.Track.Source.Microphone),u})})}function f(o){return e(this,void 0,void 0,function*(){return(yield v({audio:!1,video:o}))[0]})}function k(o){return e(this,void 0,void 0,function*(){return(yield v({audio:o,video:!1}))[0]})}function h(o){var i;return e(this,void 0,void 0,function*(){void 0===o&&(o={}),void 0===o.name&&(o.name="screen"),void 0===o.resolution&&(o.resolution=a.VideoPresets.fhd.resolution);let e=!0;o.resolution&&(e={width:o.resolution.width,height:o.resolution.height});const u=yield navigator.mediaDevices.getDisplayMedia({audio:null!==(i=o.audio)&&void 0!==i&&i,video:e}),d=u.getVideoTracks();if(0===d.length)throw new r.TrackInvalidError("no video track found");const s=new n.default(d[0],o.name);s.source=c.Track.Source.ScreenShare;const l=[s];if(u.getAudioTracks().length>0){const e=new t.default(u.getAudioTracks()[0],o.name);e.source=c.Track.Source.ScreenShareAudio,l.push(e)}return l})}function p(e,o,i){switch(e.kind){case"audio":return new t.default(e,o,i);case"video":return new n.default(e,o,i);default:throw new r.TrackInvalidError(`unsupported track type: ${e.kind}`)}}exports.getLastAudioCreateError=s,exports.getLastVideoCreateError=l,exports.createLocalTracks=v,exports.createLocalVideoTrack=f,exports.createLocalAudioTrack=k,exports.createLocalScreenTracks=h;
},{"../errors":"k3b3","./LocalAudioTrack":"fkZQ","./LocalTrack":"Tqjs","./LocalVideoTrack":"KIm9","./options":"ZNBW","./Track":"UBMR"}],"GW7Y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../events"),t=require("./Track");class s extends t.Track{constructor(e,s,r){super(e,t.Track.Kind.Audio),this.sid=s,this.receiver=r}setMuted(t){this.isMuted!==t&&(this.isMuted=t,this.emit(t?e.TrackEvent.Muted:e.TrackEvent.Unmuted,this))}start(){super.enable()}stop(){super.disable()}}exports.default=s;
},{"../events":"q9Tz","./Track":"UBMR"}],"leOd":[function(require,module,exports) {
"use strict";function e(e,r,t){var n,o,i;void 0===r&&(r=50),void 0===t&&(t={});var a=null!=(n=t.isImmediate)&&n,u=null!=(o=t.callback)&&o,c=t.maxWait,l=Date.now(),v=[];function f(){if(void 0!==c){var e=Date.now()-l;if(e+r>=c)return c-e}return r}var s=function(){var r=[].slice.call(arguments),t=this;return new Promise(function(n,o){var c=a&&void 0===i;if(void 0!==i&&clearTimeout(i),i=setTimeout(function(){if(i=void 0,l=Date.now(),!a){var n=e.apply(t,r);u&&u(n),v.forEach(function(e){return(0,e.resolve)(n)}),v=[]}},f()),c){var s=e.apply(t,r);return u&&u(s),n(s)}v.push({resolve:n,reject:o})})};return s.cancel=function(e){void 0!==i&&clearTimeout(i),v.forEach(function(r){return(0,r.reject)(e)}),v=[]},s}Object.defineProperty(exports,"__esModule",{value:!0}),exports.debounce=e;
},{}],"gnWX":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function i(e){try{u(r.next(e))}catch(t){s(t)}}function c(e){try{u(r.throw(e))}catch(t){s(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getIntersectionObserver=exports.getResizeObserver=exports.sleep=exports.useLegacyAPI=exports.unpackStreamId=void 0;const t="|";function n(e){const n=e.split(t);return n.length>1?[n[0],e.substr(n[0].length+1)]:[e,""]}function r(){return"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function o(t){return e(this,void 0,void 0,function*(){return new Promise(e=>setTimeout(e,t))})}function s(e){for(const t of e)t.target.handleResize(t)}function i(e){for(const t of e)t.target.handleVisibilityChanged(t)}exports.unpackStreamId=n,exports.useLegacyAPI=r,exports.sleep=o;let c=null;const u=()=>(c||(c=new ResizeObserver(s)),c);exports.getResizeObserver=u;let a=null;const p=()=>(a||(a=new IntersectionObserver(i)),a);exports.getIntersectionObserver=p;
},{}],"q4mV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("ts-debounce"),t=require("../events"),i=require("../utils"),s=require("./Track"),n=1e3;class h extends s.Track{constructor(t,i,h,a){super(t,s.Track.Kind.Video),this.elementInfos=[],this.handleVisibilityChanged=(e=>{const{target:t,isIntersecting:i}=e,s=this.elementInfos.find(e=>e.element===t);s&&(s.visible=i,s.visibilityChangedAt=Date.now()),this.updateVisibility()}),this.debouncedHandleVisibilityChanged=e.debounce(this.handleVisibilityChanged,n),this.handleResize=(e=>{const{target:t,contentRect:i}=e,s=this.elementInfos.find(e=>e.element===t);s&&(s.width=i.width,s.height=i.height),this.updateDimensions()}),this.debouncedHandleResize=e.debounce(this.handleResize,n),this.sid=i,this.receiver=h,this.autoManaged=a}get isAutoManaged(){var e;return null!==(e=this.autoManaged)&&void 0!==e&&e}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this.emit(e?t.TrackEvent.Muted:t.TrackEvent.Unmuted,this)),this.attachedElements.forEach(t=>{e?s.detachTrack(this.mediaStreamTrack,t):s.attachToElement(this.mediaStreamTrack,t)})}attach(e){return e||(e=super.attach()),super.attach(e),this.autoManaged&&(this.elementInfos.push({element:e,visible:!0,width:e.clientWidth,height:e.clientHeight}),e.handleResize=this.debouncedHandleResize,e.handleVisibilityChanged=this.debouncedHandleVisibilityChanged,i.getIntersectionObserver().observe(e),i.getResizeObserver().observe(e)),e}detach(e){let t=[];if(e)return t.push(e),super.detach(e);t=super.detach();for(const i of t)this.stopObservingElement(i);return t}start(){super.enable()}stop(){super.disable()}stopObservingElement(e){var t,s;null===(t=i.getIntersectionObserver())||void 0===t||t.unobserve(e),null===(s=i.getResizeObserver())||void 0===s||s.unobserve(e),this.elementInfos=this.elementInfos.filter(t=>t.element!==e)}updateVisibility(){const e=this.elementInfos.reduce((e,t)=>Math.max(e,t.visibilityChangedAt||0),0),i=this.elementInfos.some(e=>e.visible);this.lastVisible!==i&&(!i&&Date.now()-e<n?setTimeout(()=>{this.updateVisibility()},Date.now()-e):(this.lastVisible=i,this.emit(t.TrackEvent.VisibilityChanged,i,this)))}updateDimensions(){var e,i;let s=0,n=0;for(const t of this.elementInfos)t.visible&&t.width+t.height>s+n&&(s=t.width,n=t.height);(null===(e=this.lastDimensions)||void 0===e?void 0:e.width)===s&&(null===(i=this.lastDimensions)||void 0===i?void 0:i.height)===n||(this.lastDimensions={width:s,height:n},this.emit(t.TrackEvent.VideoDimensionsChanged,this.lastDimensions,this))}}exports.default=h;
},{"ts-debounce":"leOd","../events":"q9Tz","../utils":"gnWX","./Track":"UBMR"}],"vflL":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("events"),r=require("../events"),i=t(require("./LocalAudioTrack")),s=t(require("./LocalVideoTrack")),a=t(require("./RemoteAudioTrack")),c=t(require("./RemoteVideoTrack")),u=require("./Track");class n extends e.EventEmitter{constructor(t,e,r){super(),this.metadataMuted=!1,this.kind=t,this.trackSid=e,this.trackName=r,this.source=u.Track.Source.Unknown}setTrack(t){this.track=t,t&&(t.on(r.TrackEvent.Muted,()=>{this.emit(r.TrackEvent.Muted)}),t.on(r.TrackEvent.Unmuted,()=>{this.emit(r.TrackEvent.Unmuted)}))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return void 0!==this.track}get audioTrack(){if(this.track instanceof i.default||this.track instanceof a.default)return this.track}get videoTrack(){if(this.track instanceof s.default||this.track instanceof c.default)return this.track}updateInfo(t){this.trackSid=t.sid,this.trackName=t.name,this.source=u.Track.sourceFromProto(t.source),this.kind===u.Track.Kind.Video&&t.width>0&&(this.dimensions={width:t.width,height:t.height},this.simulcasted=t.simulcast)}}exports.default=n;
},{"events":"wIHY","../events":"q9Tz","./LocalAudioTrack":"fkZQ","./LocalVideoTrack":"KIm9","./RemoteAudioTrack":"GW7Y","./RemoteVideoTrack":"q4mV","./Track":"UBMR"}],"iXhr":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,r,u){return new(r||(r=Promise))(function(i,n){function o(t){try{a(u.next(t))}catch(e){n(e)}}function s(t){try{a(u.throw(t))}catch(e){n(e)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(o,s)}a((u=u.apply(t,e||[])).next())})},e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const r=e(require("./TrackPublication"));class u extends r.default{constructor(t,e,r){super(t,e.sid,e.name),this.updateInfo(e),this.setTrack(r)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return t(this,void 0,void 0,function*(){return null===(e=this.track)||void 0===e?void 0:e.mute()})}unmute(){var e;return t(this,void 0,void 0,function*(){return null===(e=this.track)||void 0===e?void 0:e.unmute()})}}exports.default=u;
},{"./TrackPublication":"vflL"}],"qfmo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConnectionQuality=void 0;const t=require("events"),e=require("../../proto/livekit_models"),i=require("../events"),n=require("../track/Track");var a;function r(t){switch(t){case e.ConnectionQuality.EXCELLENT:return a.Excellent;case e.ConnectionQuality.GOOD:return a.Good;case e.ConnectionQuality.POOR:return a.Poor;default:return a.Unknown}}!function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Unknown="unknown"}(a=exports.ConnectionQuality||(exports.ConnectionQuality={}));class c extends t.EventEmitter{constructor(t,e){super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=a.Unknown,this.sid=t,this.identity=e,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(t){if(t!==n.Track.Source.Unknown)for(const[,e]of this.tracks){if(e.source===t)return e;if(e.source===n.Track.Source.Unknown){if(t===n.Track.Source.Microphone&&e.kind===n.Track.Kind.Audio&&"screen"!==e.trackName)return e;if(t===n.Track.Source.Camera&&e.kind===n.Track.Kind.Video&&"screen"!==e.trackName)return e;if(t===n.Track.Source.ScreenShare&&e.kind===n.Track.Kind.Video&&"screen"===e.trackName)return e;if(t===n.Track.Source.ScreenShareAudio&&e.kind===n.Track.Kind.Audio&&"screen"===e.trackName)return e}}}getTrackByName(t){for(const[,e]of this.tracks)if(e.trackName===t)return e}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var t;const e=this.getTrack(n.Track.Source.Camera);return!(null===(t=null==e?void 0:e.isMuted)||void 0===t||t)}get isMicrophoneEnabled(){var t;const e=this.getTrack(n.Track.Source.Microphone);return!(null===(t=null==e?void 0:e.isMuted)||void 0===t||t)}get isScreenShareEnabled(){return!!this.getTrack(n.Track.Source.ScreenShare)}get joinedAt(){return this.participantInfo?new Date(1e3*this.participantInfo.joinedAt):new Date}updateInfo(t){this.identity=t.identity,this.sid=t.sid,this.setMetadata(t.metadata),this.participantInfo=t}setMetadata(t){const e=!this.participantInfo||this.participantInfo.metadata!==t,n=this.metadata;this.metadata=t,e&&this.emit(i.ParticipantEvent.MetadataChanged,n)}setIsSpeaking(t){t!==this.isSpeaking&&(this.isSpeaking=t,t&&(this.lastSpokeAt=new Date),this.emit(i.ParticipantEvent.IsSpeakingChanged,t))}setConnectionQuality(t){const e=this._connectionQuality;this._connectionQuality=r(t),e!==this._connectionQuality&&this.emit(i.ParticipantEvent.ConnectionQualityChanged,this._connectionQuality)}addTrackPublication(t){t.on(i.TrackEvent.Muted,()=>{this.emit(i.ParticipantEvent.TrackMuted,t)}),t.on(i.TrackEvent.Unmuted,()=>{this.emit(i.ParticipantEvent.TrackUnmuted,t)});const e=t;switch(e.track&&(e.track.sid=t.trackSid),this.tracks.set(t.trackSid,t),t.kind){case n.Track.Kind.Audio:this.audioTracks.set(t.trackSid,t);break;case n.Track.Kind.Video:this.videoTracks.set(t.trackSid,t)}}}exports.default=c;
},{"events":"wIHY","../../proto/livekit_models":"OxfL","../events":"q9Tz","../track/Track":"UBMR"}],"aNnA":[function(require,module,exports) {
"use strict";var i=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(exports,"__esModule",{value:!0});const t=i(require("../../logger")),e=require("../../proto/livekit_rtc"),s=require("../events"),a=i(require("./RemoteVideoTrack")),d=i(require("./TrackPublication"));class n extends d.default{constructor(){super(...arguments),this.disabled=!1,this.currentVideoQuality=e.VideoQuality.HIGH,this.handleVisibilityChange=(i=>{t.default.debug(`automanage video visibility, visible=${i}`),this.disabled=!i,this.emitTrackUpdate()}),this.handleVideoDimensionsChange=(i=>{t.default.debug(`automanage video dimensions, ${i.width}x${i.height}`),this.videoDimensions=i,this.emitTrackUpdate()})}setSubscribed(i){this.subscribed=i;const t={trackSids:[this.trackSid],subscribe:this.subscribed};this.emit(s.TrackEvent.UpdateSubscription,t)}get isSubscribed(){return!1!==this.subscribed&&super.isSubscribed}get isEnabled(){return!this.disabled}setEnabled(i){!this.isAutoManageVideo&&this.isSubscribed&&this.disabled!==!i&&(this.track instanceof a.default&&this.track.isAutoManaged||(this.disabled=!i,this.emitTrackUpdate()))}setVideoQuality(i){!this.isAutoManageVideo&&this.isSubscribed&&this.currentVideoQuality!==i&&(this.currentVideoQuality=i,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(i){var t,e;this.isSubscribed&&!this.isAutoManageVideo&&((null===(t=this.videoDimensions)||void 0===t?void 0:t.width)===i.width&&(null===(e=this.videoDimensions)||void 0===e?void 0:e.height)===i.height||(this.track instanceof a.default&&(this.videoDimensions=i),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}get videoQuality(){return this.currentVideoQuality}setTrack(i){var t,e;this.track&&(this.track.off(s.TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),this.track.off(s.TrackEvent.VisibilityChanged,this.handleVisibilityChange)),super.setTrack(i),null===(t=this.track)||void 0===t||t.on(s.TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),null===(e=this.track)||void 0===e||e.on(s.TrackEvent.VisibilityChanged,this.handleVisibilityChange)}updateInfo(i){var t;super.updateInfo(i),this.metadataMuted=i.muted,null===(t=this.track)||void 0===t||t.setMuted(i.muted)}get isAutoManageVideo(){return this.track instanceof a.default&&this.track.isAutoManaged}emitTrackUpdate(){const i=e.UpdateTrackSettings.fromPartial({trackSids:[this.trackSid],disabled:this.disabled});this.videoDimensions?(i.width=this.videoDimensions.width,i.height=this.videoDimensions.height):this.currentVideoQuality?i.quality=this.currentVideoQuality:i.quality=e.VideoQuality.HIGH,this.emit(s.TrackEvent.UpdateSettings,i)}}exports.default=n;
},{"../../logger":"mQuM","../../proto/livekit_rtc":"Jka9","../events":"q9Tz","./RemoteVideoTrack":"q4mV","./TrackPublication":"vflL"}],"gZZ1":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const e=t(require("../../logger")),i=require("../events"),a=t(require("../track/RemoteAudioTrack")),r=t(require("../track/RemoteTrackPublication")),s=t(require("../track/RemoteVideoTrack")),c=require("../track/Track"),n=t(require("./Participant"));class d extends n.default{constructor(t,e,i){super(e,i||""),this.signalClient=t,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map}static fromParticipantInfo(t,e){const i=new d(t,e.sid,e.identity);return i.updateInfo(e),i}addTrackPublication(t){super.addTrackPublication(t),t.on(i.TrackEvent.UpdateSettings,t=>{this.signalClient.sendUpdateTrackSettings(t)}),t.on(i.TrackEvent.UpdateSubscription,t=>{this.signalClient.sendUpdateSubscription(t)})}getTrack(t){const e=super.getTrack(t);if(e)return e}getTrackByName(t){const e=super.getTrackByName(t);if(e)return e}addSubscribedMediaTrack(t,r,c,n,d){let u=this.getTrackPublication(r);if(u||r.startsWith("TR")||this.tracks.forEach(e=>{u||t.kind!==e.kind.toString()||(u=e)}),!u)return 0===d?(e.default.error("could not find published track",this.sid,r),void this.emit(i.ParticipantEvent.TrackSubscriptionFailed,r)):(void 0===d&&(d=20),void setTimeout(()=>{this.addSubscribedMediaTrack(t,r,c,n,d-1)},150));const o="video"===t.kind;let k;return(k=o?new s.default(t,r,c,n):new a.default(t,r,c)).start(),u.setTrack(k),k.name=u.trackName,k.sid=u.trackSid,k.source=u.source,k.isMuted=u.isMuted,t.onended=(()=>{u&&(u.track=void 0),this.emit(i.ParticipantEvent.TrackUnsubscribed,k,u)}),this.emit(i.ParticipantEvent.TrackSubscribed,k,u),u}get hasMetadata(){return!!this.participantInfo}getTrackPublication(t){return this.tracks.get(t)}updateInfo(t){const e=this.hasMetadata;super.updateInfo(t);const a=new Map,s=new Map;t.tracks.forEach(t=>{let e=this.getTrackPublication(t.sid);if(e)e.updateInfo(t);else{const i=c.Track.kindFromProto(t.type);if(!i)return;(e=new r.default(i,t.sid,t.name)).updateInfo(t),s.set(t.sid,e),this.addTrackPublication(e)}a.set(t.sid,e)}),e&&s.forEach(t=>{this.emit(i.ParticipantEvent.TrackPublished,t)}),this.tracks.forEach(t=>{a.has(t.trackSid)||this.unpublishTrack(t.trackSid,!0)})}unpublishTrack(t,e){const a=this.tracks.get(t);if(!a)return;switch(this.tracks.delete(t),a.kind){case c.Track.Kind.Audio:this.audioTracks.delete(t);break;case c.Track.Kind.Video:this.videoTracks.delete(t)}const{track:r}=a;if(r){const{isSubscribed:t}=a;r.stop(),a.setTrack(void 0),t&&this.emit(i.ParticipantEvent.TrackUnsubscribed,r,a)}e&&this.emit(i.ParticipantEvent.TrackUnpublished,a)}emit(t,...i){return e.default.trace("participant event",this.sid,t,...i),super.emit(t,...i)}}exports.default=d;
},{"../../logger":"mQuM","../events":"q9Tz","../track/RemoteAudioTrack":"GW7Y","../track/RemoteTrackPublication":"aNnA","../track/RemoteVideoTrack":"q4mV","../track/Track":"UBMR","./Participant":"qfmo"}],"n9xZ":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))(function(a,n){function s(e){try{o(i.next(e))}catch(t){n(t)}}function c(e){try{o(i.throw(e))}catch(t){n(t)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,c)}o((i=i.apply(e,t||[])).next())})},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const r=t(require("../../logger")),i=require("../../proto/livekit_rtc"),a=require("../defaults"),n=require("../errors"),s=require("../events"),c=require("../track/create"),o=t(require("../track/LocalAudioTrack")),d=t(require("../track/LocalTrackPublication")),u=t(require("../track/LocalVideoTrack")),h=require("../track/options"),l=require("../track/Track"),k=t(require("./Participant")),p=t(require("./RemoteParticipant"));class m extends k.default{constructor(e,t,i){super(e,t),this.pendingPublishing=new Set,this.onTrackUnmuted=(e=>{this.onTrackMuted(e,!1)}),this.onTrackMuted=((e,t)=>{void 0===t&&(t=!0),e.sid?this.engine.updateMuteStatus(e.sid,t):r.default.error("could not update mute status for unpublished track",e)}),this.presets169=[h.VideoPresets.qvga,h.VideoPresets.vga,h.VideoPresets.qhd,h.VideoPresets.hd,h.VideoPresets.fhd],this.presets43=[h.VideoPresets43.qvga,h.VideoPresets43.vga,h.VideoPresets43.qhd,h.VideoPresets43.hd,h.VideoPresets43.fhd],this.presetsScreenShare=[h.ScreenSharePresets.vga,h.ScreenSharePresets.hd_8,h.ScreenSharePresets.hd_15,h.ScreenSharePresets.fhd_15,h.ScreenSharePresets.fhd_30],this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=i,this.engine.on(s.EngineEvent.RemoteMuteChanged,(e,t)=>{const r=this.tracks.get(e);r&&r.track&&(t?r.mute():r.unmute())})}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setCameraEnabled(e){return this.setTrackEnabled(l.Track.Source.Camera,e)}setMicrophoneEnabled(e){return this.setTrackEnabled(l.Track.Source.Microphone,e)}setScreenShareEnabled(e){return this.setTrackEnabled(l.Track.Source.ScreenShare,e)}setTrackEnabled(t,i){return e(this,void 0,void 0,function*(){r.default.debug("setTrackEnabled",t,i);const e=this.getTrack(t);if(i)if(e)yield e.unmute();else{let e;if(this.pendingPublishing.has(t))return;this.pendingPublishing.add(t);try{switch(t){case l.Track.Source.Camera:e=yield c.createLocalVideoTrack();break;case l.Track.Source.Microphone:e=yield c.createLocalAudioTrack();break;case l.Track.Source.ScreenShare:[e]=yield c.createLocalScreenTracks({audio:!1});break;default:throw new n.TrackInvalidError(t)}yield this.publishTrack(e)}catch(a){throw a instanceof Error&&!(a instanceof n.TrackInvalidError)&&this.emit(s.ParticipantEvent.MediaDevicesError,a),a}finally{this.pendingPublishing.delete(t)}}else e&&e.track&&(t===l.Track.Source.ScreenShare?this.unpublishTrack(e.track):yield e.mute())})}publishTrack(t,c){var h,k,p,m,f;return e(this,void 0,void 0,function*(){const e={};if(Object.assign(e,a.getTrackPublishDefaults(),c),t instanceof MediaStreamTrack)switch(t.kind){case"audio":t=new o.default(t,null==c?void 0:c.name);break;case"video":t=new u.default(t,null==c?void 0:c.name);break;default:throw new n.TrackInvalidError(`unsupported MediaStreamTrack kind ${t.kind}`)}let T;if(this.tracks.forEach(e=>{e.track&&e.track===t&&(T=e)}),T)return T;e.source&&(t.source=e.source),e.name&&(t.name=e.name),e.stopMicTrackOnMute&&t instanceof o.default&&(t.stopOnMute=!0),t.on(s.TrackEvent.Muted,this.onTrackMuted),t.on(s.TrackEvent.Unmuted,this.onTrackUnmuted),t.on(s.TrackEvent.Ended,()=>{this.unpublishTrack(t)});const g=t.mediaStreamTrack.id,v=i.AddTrackRequest.fromPartial({cid:g,name:t.name,type:l.Track.kindToProto(t.kind),muted:t.isMuted,source:l.Track.sourceToProto(t.source),disableDtx:!(null===(h=null==e?void 0:e.dtx)||void 0===h||h)});t.dimensions&&(v.width=t.dimensions.width,v.height=t.dimensions.height);const b=yield this.engine.addTrack(v),S=new d.default(t.kind,b,t);let P;if(t.sid=b.sid,t.kind===l.Track.Kind.Video){const r=t.mediaStreamTrack.getSettings(),i=null!==(k=r.width)&&void 0!==k?k:null===(p=t.dimensions)||void 0===p?void 0:p.width,a=null!==(m=r.height)&&void 0!==m?m:null===(f=t.dimensions)||void 0===f?void 0:f.height;P=this.computeVideoEncodings(t.source===l.Track.Source.ScreenShare,i,a,e)}else t.kind===l.Track.Kind.Audio&&e.audioBitrate&&(P=[{maxBitrate:e.audioBitrate}]);if(!this.engine.publisher)throw new n.UnexpectedConnectionState("publisher is closed");r.default.debug("publishing with encodings",P);const E={direction:"sendonly"};P&&(E.sendEncodings=P);const w=this.engine.publisher.pc.addTransceiver(t.mediaStreamTrack,E);return this.engine.negotiate(),t.sender=w.sender,t instanceof u.default&&t.startMonitor(this.engine.client),e.videoCodec&&this.setPreferredCodec(w,t.kind,e.videoCodec),this.addTrackPublication(S),this.emit(s.ParticipantEvent.LocalTrackPublished,S),S})}unpublishTrack(e){const t=this.getPublicationForTrack(e);if(r.default.debug("unpublishTrack","unpublishing track",e),!t)return r.default.warn("unpublishTrack","track was not unpublished because no publication was found",e),null;let i;if((e instanceof o.default||e instanceof u.default)&&(e.removeListener(s.TrackEvent.Muted,this.onTrackMuted),e.removeListener(s.TrackEvent.Unmuted,this.onTrackUnmuted)),e.stop(),i=e instanceof MediaStreamTrack?e:e.mediaStreamTrack,this.engine.publisher){this.engine.publisher.pc.getSenders().forEach(e=>{var t;if(e.track===i)try{null===(t=this.engine.publisher)||void 0===t||t.pc.removeTrack(e),this.engine.negotiate()}catch(a){r.default.warn("unpublishTrack","failed to remove track",a)}})}switch(this.tracks.delete(t.trackSid),t.kind){case l.Track.Kind.Audio:this.audioTracks.delete(t.trackSid);break;case l.Track.Kind.Video:this.videoTracks.delete(t.trackSid)}return this.emit(s.ParticipantEvent.LocalTrackUnpublished,t),t}unpublishTracks(e){const t=[];return e.forEach(e=>{const r=this.unpublishTrack(e);r&&t.push(r)}),t}get publisherMetrics(){return null}publishData(t,r,i){return e(this,void 0,void 0,function*(){const e=[];void 0!==i&&i.forEach(t=>{t instanceof p.default?e.push(t.sid):e.push(t)});const a={kind:r,user:{participantSid:this.sid,payload:t,destinationSids:e}};yield this.engine.sendDataPacket(a,r)})}getPublicationForTrack(e){let t;return this.tracks.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(i instanceof o.default||i instanceof u.default)&&i.mediaStreamTrack===e&&(t=r):e===i&&(t=r))}),t}setPreferredCodec(e,t,r){if(!("getCapabilities"in RTCRtpSender))return;const i=RTCRtpSender.getCapabilities(t);if(!i)return;const a=i.codecs.find(e=>{const t=e.mimeType.toLowerCase(),i=t===`video/${r}`;return"h264"===r&&e.sdpFmtpLine?i&&e.sdpFmtpLine.includes("profile-level-id=42e01f"):i||"audio/opus"===t});a&&"setCodecPreferences"in e&&e.setCodecPreferences([a])}computeVideoEncodings(e,t,i,a){let n,s=null==a?void 0:a.videoEncoding;e&&(s=null==a?void 0:a.screenShareEncoding);const c=!e&&(null==a?void 0:a.simulcast);if((s||c)&&t&&i){if(s||(s=this.determineAppropriateEncoding(e,t,i),r.default.debug("using video encoding",s)),c){const r=this.presetsForResolution(e,t,i),a=r[1],c=r[0];n=t>=960?[{rid:"q",scaleResolutionDownBy:i/c.height,maxBitrate:c.encoding.maxBitrate,maxFramerate:c.encoding.maxFramerate},{rid:"h",scaleResolutionDownBy:i/a.height,maxBitrate:a.encoding.maxBitrate,maxFramerate:a.encoding.maxFramerate},{rid:"f",maxBitrate:s.maxBitrate,maxFramerate:s.maxFramerate}]:[{rid:"q",scaleResolutionDownBy:i/c.height,maxBitrate:c.encoding.maxBitrate,maxFramerate:c.encoding.maxFramerate},{rid:"h",maxBitrate:s.maxBitrate,maxFramerate:s.maxFramerate}]}else n=[s];return n}}determineAppropriateEncoding(e,t,r){const i=this.presetsForResolution(e,t,r);let{encoding:a}=i[0];for(let n=0;n<i.length;n+=1){const e=i[n];t>=e.width&&r>=e.height&&(a=e.encoding)}return a}presetsForResolution(e,t,r){if(e)return this.presetsScreenShare;const i=t/r;return Math.abs(i-16/9)<Math.abs(i-4/3)?this.presets169:this.presets43}}exports.default=m;
},{"../../logger":"mQuM","../../proto/livekit_rtc":"Jka9","../defaults":"drFi","../errors":"k3b3","../events":"q9Tz","../track/create":"JpFY","../track/LocalAudioTrack":"fkZQ","../track/LocalTrackPublication":"iXhr","../track/LocalVideoTrack":"KIm9","../track/options":"ZNBW","../track/Track":"UBMR","./Participant":"qfmo","./RemoteParticipant":"gZZ1"}],"lo3x":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{a(n.next(e))}catch(t){r(t)}}function c(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,c)}a((n=n.apply(e,t||[])).next())})},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const i=require("ts-debounce"),n=t(require("../logger"));class s{constructor(e){this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.negotiate=i.debounce(()=>{this.createAndSendOffer()},100),this.pc=new RTCPeerConnection(e)}get isICEConnected(){return"connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState}addIceCandidate(t){return e(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(t);this.pendingCandidates.push(t)})}setRemoteDescription(t){return e(this,void 0,void 0,function*(){yield this.pc.setRemoteDescription(t),this.pendingCandidates.forEach(e=>{this.pc.addIceCandidate(e)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate&&(this.renegotiate=!1,this.createAndSendOffer())})}createAndSendOffer(t){return e(this,void 0,void 0,function*(){if(void 0===this.onOffer)return;if((null==t?void 0:t.iceRestart)&&(n.default.debug("restarting ICE"),this.restartingIce=!0),"have-local-offer"===this.pc.signalingState){const e=this.pc.remoteDescription;if(!((null==t?void 0:t.iceRestart)&&e))return void(this.renegotiate=!0);yield this.pc.setRemoteDescription(e)}n.default.debug("starting to negotiate");const e=yield this.pc.createOffer(t);yield this.pc.setLocalDescription(e),this.onOffer(e)})}close(){this.pc.close()}}exports.default=s;
},{"ts-debounce":"leOd","../logger":"mQuM"}],"eBAz":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function c(e){try{o(n.next(e))}catch(t){r(t)}}function a(e){try{o(n.throw(e))}catch(t){r(t)}}function o(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(c,a)}o((n=n.apply(e,t||[])).next())})},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.maxICEConnectTimeout=void 0;const i=require("events"),n=t(require("../logger")),s=require("../proto/livekit_models"),r=require("../proto/livekit_rtc"),c=require("./errors"),a=require("./events"),o=t(require("./PCTransport")),h=require("./utils"),d="_lossy",l="_reliable",u=5;exports.maxICEConnectTimeout=5e3;class b extends i.EventEmitter{constructor(t,i){super(),this.subscriberPrimary=!1,this.iceConnected=!1,this.isClosed=!0,this.pendingTrackResolvers={},this.hasPublished=!1,this.reconnectAttempts=0,this.handleDataChannel=(({channel:t})=>e(this,void 0,void 0,function*(){if(t){if(t.label===l)this.reliableDCSub=t;else{if(t.label!==d)return;this.lossyDCSub=t}t.onmessage=this.handleDataMessage}})),this.handleDataMessage=(t=>e(this,void 0,void 0,function*(){let e;if(t.data instanceof ArrayBuffer)e=t.data;else{if(!(t.data instanceof Blob))return void n.default.error("unsupported data type",t.data);e=yield t.data.arrayBuffer()}const i=s.DataPacket.decode(new Uint8Array(e));i.speaker?this.emit(a.EngineEvent.ActiveSpeakersUpdate,i.speaker.speakers):i.user&&this.emit(a.EngineEvent.DataPacketReceived,i.user,i.kind)})),this.handleDisconnect=(e=>{if(this.isClosed)return;if(n.default.debug(`${e} disconnected`),this.reconnectAttempts>=u)return n.default.info("could not connect to signal after",u,"attempts. giving up"),this.close(),void this.emit(a.EngineEvent.Disconnected);const t=this.reconnectAttempts*this.reconnectAttempts*300;setTimeout(()=>{this.reconnect().then(()=>{this.reconnectAttempts=0}).catch(this.handleDisconnect)},t)}),this.client=t,this.rtcConfig=i||{}}join(t,i,n){return e(this,void 0,void 0,function*(){this.url=t,this.token=i;const e=yield this.client.join(t,i,n);return this.isClosed=!1,this.subscriberPrimary=e.subscriberPrimary,this.publisher||this.configure(e),this.subscriberPrimary||(yield this.negotiate()),e})}close(){this.isClosed=!0,this.publisher&&(this.publisher.pc.getSenders().forEach(e=>{var t;try{null===(t=this.publisher)||void 0===t||t.pc.removeTrack(e)}catch(i){n.default.warn("could not removeTrack",i)}}),this.publisher.close(),this.publisher=void 0),this.subscriber&&(this.subscriber.close(),this.subscriber=void 0),this.client.close()}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new c.TrackInvalidError("a track with the same ID has already been published");return new Promise(t=>{this.pendingTrackResolvers[e.cid]=t,this.client.sendAddTrack(e)})}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}configure(t){if(this.publisher||this.subscriber)return;if(t.iceServers&&!this.rtcConfig.iceServers){const e=[];t.iceServers.forEach(t=>{const i={urls:t.urls};t.username&&(i.username=t.username),t.credential&&(i.credential=t.credential),e.push(i)}),this.rtcConfig.iceServers=e}this.publisher=new o.default(this.rtcConfig),this.subscriber=new o.default(this.rtcConfig),this.publisher.pc.onicecandidate=(e=>{e.candidate&&(n.default.trace("adding ICE candidate for peer",e.candidate),this.client.sendIceCandidate(e.candidate,r.SignalTarget.PUBLISHER))}),this.subscriber.pc.onicecandidate=(e=>{e.candidate&&this.client.sendIceCandidate(e.candidate,r.SignalTarget.SUBSCRIBER)}),this.publisher.onOffer=(e=>{this.client.sendOffer(e)});let i=this.publisher.pc;t.subscriberPrimary&&(i=this.subscriber.pc,this.subscriber.pc.ondatachannel=this.handleDataChannel),i.oniceconnectionstatechange=(()=>{"connected"===i.iceConnectionState?(n.default.trace("ICE connected"),this.iceConnected||(this.iceConnected=!0,this.emit(a.EngineEvent.Connected))):"failed"===i.iceConnectionState&&(n.default.trace("ICE disconnected"),this.iceConnected&&(this.iceConnected=!1,this.handleDisconnect("peerconnection")))}),this.subscriber.pc.ontrack=(e=>{this.emit(a.EngineEvent.MediaTrackAdded,e.track,e.streams[0],e.receiver)}),this.lossyDC=this.publisher.pc.createDataChannel(d,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.publisher.pc.createDataChannel(l,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.client.onAnswer=(t=>e(this,void 0,void 0,function*(){this.publisher&&(n.default.debug("received server answer",t.type,this.publisher.pc.signalingState),yield this.publisher.setRemoteDescription(t))})),this.client.onTrickle=((e,t)=>{this.publisher&&this.subscriber&&(n.default.trace("got ICE candidate from peer",e,t),t===r.SignalTarget.PUBLISHER?this.publisher.addIceCandidate(e):this.subscriber.addIceCandidate(e))}),this.client.onOffer=(t=>e(this,void 0,void 0,function*(){if(!this.subscriber)return;n.default.debug("received server offer",t.type,this.subscriber.pc.signalingState),yield this.subscriber.setRemoteDescription(t);const e=yield this.subscriber.pc.createAnswer();yield this.subscriber.pc.setLocalDescription(e),this.client.sendAnswer(e)})),this.client.onParticipantUpdate=(e=>{this.emit(a.EngineEvent.ParticipantUpdate,e)}),this.client.onLocalTrackPublished=(e=>{const t=this.pendingTrackResolvers[e.cid];t?(delete this.pendingTrackResolvers[e.cid],t(e.track)):n.default.error("missing track resolver for ",e.cid)}),this.client.onSpeakersChanged=(e=>{this.emit(a.EngineEvent.SpeakersChanged,e)}),this.client.onClose=(()=>{this.handleDisconnect("signal")}),this.client.onLeave=(()=>{this.close(),this.emit(a.EngineEvent.Disconnected)}),this.client.onRemoteMuteChanged=((e,t)=>{this.emit(a.EngineEvent.RemoteMuteChanged,e,t)}),this.client.onRoomUpdate=(e=>{this.emit(a.EngineEvent.RoomUpdate,e)}),this.client.onConnectionQuality=(e=>{this.emit(a.EngineEvent.ConnectionQualityUpdate,e)})}reconnect(){return e(this,void 0,void 0,function*(){if(this.isClosed)return;if(!this.url||!this.token)throw new c.ConnectionError("could not reconnect, url or token not saved");if(n.default.info("reconnecting to signal connection, attempt",this.reconnectAttempts),0===this.reconnectAttempts&&this.emit(a.EngineEvent.Reconnecting),this.reconnectAttempts+=1,yield this.client.reconnect(this.url,this.token),!this.publisher||!this.subscriber)throw new c.UnexpectedConnectionState("publisher and subscriber connections unset");this.subscriber.restartingIce=!0,this.hasPublished&&(yield this.publisher.createAndSendOffer({iceRestart:!0}));const e=(new Date).getTime();for(;(new Date).getTime()-e<2*exports.maxICEConnectTimeout;){if(this.iceConnected)return void this.emit(a.EngineEvent.Reconnected);yield h.sleep(100)}throw new c.ConnectionError("could not establish ICE connection")})}sendDataPacket(t,i){return e(this,void 0,void 0,function*(){const e=s.DataPacket.encode(t).finish();yield this.ensurePublisherConnected(i),i===s.DataPacket_Kind.LOSSY&&this.lossyDC?this.lossyDC.send(e):i===s.DataPacket_Kind.RELIABLE&&this.reliableDC&&this.reliableDC.send(e)})}ensurePublisherConnected(t){var i;return e(this,void 0,void 0,function*(){if(!this.subscriberPrimary)return;if(this.publisher&&this.publisher.isICEConnected)return;this.negotiate();const e=(new Date).getTime()+exports.maxICEConnectTimeout;for(;(new Date).getTime()<e;){if(this.publisher&&this.publisher.isICEConnected){let e="connecting";if(t===s.DataPacket_Kind.LOSSY&&this.lossyDC?e=this.lossyDC.readyState:t===s.DataPacket_Kind.RELIABLE&&this.reliableDC&&(e=this.reliableDC.readyState),"open"===e)return}yield h.sleep(50)}throw new c.ConnectionError(`could not establish publisher connection, state ${null===(i=this.publisher)||void 0===i?void 0:i.pc.iceConnectionState}`)})}negotiate(){this.publisher&&(this.hasPublished=!0,this.publisher.negotiate())}}exports.default=b;
},{"events":"wIHY","../logger":"mQuM","../proto/livekit_models":"OxfL","../proto/livekit_rtc":"Jka9","./errors":"k3b3","./events":"q9Tz","./PCTransport":"lo3x","./utils":"gnWX"}],"WwD1":[function(require,module,exports) {
"use strict";var t=this&&this.__createBinding||(Object.create?function(t,e,i,a){void 0===a&&(a=i),Object.defineProperty(t,a,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,a){void 0===a&&(a=i),t[a]=e[i]}),e=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(i){if(i&&i.__esModule)return i;var a={};if(null!=i)for(var n in i)"default"!==n&&Object.prototype.hasOwnProperty.call(i,n)&&t(a,i,n);return e(a,i),a},a=this&&this.__awaiter||function(t,e,i,a){return new(i||(i=Promise))(function(n,o){function s(t){try{r(a.next(t))}catch(e){o(e)}}function c(t){try{r(a.throw(t))}catch(e){o(e)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(s,c)}r((a=a.apply(t,e||[])).next())})},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.RoomState=void 0;const o=require("events"),s=n(require("../logger")),c=require("../proto/livekit_models"),r=require("./defaults"),d=n(require("./DeviceManager")),h=require("./errors"),l=require("./events"),u=n(require("./participant/LocalParticipant")),p=n(require("./participant/RemoteParticipant")),v=i(require("./RTCEngine")),m=require("./track/Track"),E=require("./utils");var k;!function(t){t.Disconnected="disconnected",t.Connected="connected",t.Reconnecting="reconnecting"}(k=exports.RoomState||(exports.RoomState={}));class f extends o.EventEmitter{constructor(t,e){super(),this.state=k.Disconnected,this.activeSpeakers=[],this.metadata=void 0,this.options={},this.audioEnabled=!0,this.connect=((t,e,i)=>a(this,void 0,void 0,function*(){if(this.localParticipant)return s.default.warn("already connected to room",this.name),this;try{const n=yield this.engine.join(t,e,i);if(s.default.debug("connected to Livekit Server",n.serverVersion),!n.serverVersion)throw new h.UnsupportedServer("unknown server version");this.state=k.Connected;const o=n.participant;this.localParticipant=new u.default(o.sid,o.identity,this.engine),this.localParticipant.updateInfo(o),this.localParticipant.on(l.ParticipantEvent.MetadataChanged,(t,e)=>{this.emit(l.RoomEvent.MetadataChanged,t,e)}).on(l.ParticipantEvent.ParticipantMetadataChanged,(t,e)=>{this.emit(l.RoomEvent.ParticipantMetadataChanged,t,e)}).on(l.ParticipantEvent.TrackMuted,t=>{this.emit(l.RoomEvent.TrackMuted,t,this.localParticipant)}).on(l.ParticipantEvent.TrackUnmuted,t=>{this.emit(l.RoomEvent.TrackUnmuted,t,this.localParticipant)}).on(l.ParticipantEvent.LocalTrackPublished,t=>{this.emit(l.RoomEvent.LocalTrackPublished,t,this.localParticipant)}).on(l.ParticipantEvent.LocalTrackUnpublished,t=>{this.emit(l.RoomEvent.LocalTrackUnpublished,t,this.localParticipant)}).on(l.ParticipantEvent.ConnectionQualityChanged,t=>{this.emit(l.RoomEvent.ConnectionQualityChanged,t,this.localParticipant)}).on(l.ParticipantEvent.MediaDevicesError,t=>{this.emit(l.RoomEvent.MediaDevicesError,t)}),n.otherParticipants.forEach(t=>{this.getOrCreateParticipant(t.sid,t)}),this.name=n.room.name,this.sid=n.room.sid}catch(a){throw this.engine.close(),a}return new Promise((t,e)=>{const i=setTimeout(()=>{this.engine.close(),e(new h.ConnectionError("could not connect after timeout"))},v.maxICEConnectTimeout);this.engine.once(l.EngineEvent.Connected,()=>{clearTimeout(i),window.addEventListener("beforeunload",this.onBeforeUnload),navigator.mediaDevices.addEventListener("devicechange",this.handleDeviceChange),t(this)})})})),this.disconnect=((t=!0)=>{this.engine.client.sendLeave(),this.engine.close(),this.handleDisconnect(t)}),this.onBeforeUnload=(()=>{this.disconnect()}),this.handleActiveSpeakersUpdate=(t=>{const e=[],i={};t.forEach(t=>{if(i[t.sid]=!0,t.sid===this.localParticipant.sid)this.localParticipant.audioLevel=t.level,this.localParticipant.setIsSpeaking(!0),e.push(this.localParticipant);else{const i=this.participants.get(t.sid);i&&(i.audioLevel=t.level,i.setIsSpeaking(!0),e.push(i))}}),i[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(t=>{i[t.sid]||(t.audioLevel=0,t.setIsSpeaking(!1))}),this.activeSpeakers=e,this.emit(l.RoomEvent.ActiveSpeakersChanged,e)}),this.handleSpeakersChanged=(t=>{const e=new Map;this.activeSpeakers.forEach(t=>{e.set(t.sid,t)}),t.forEach(t=>{let i=this.participants.get(t.sid);t.sid===this.localParticipant.sid&&(i=this.localParticipant),i&&(i.audioLevel=t.level,i.setIsSpeaking(t.active),t.active?e.set(t.sid,i):e.delete(t.sid))});const i=Array.from(e.values());i.sort((t,e)=>e.audioLevel-t.audioLevel),this.activeSpeakers=i,this.emit(l.RoomEvent.ActiveSpeakersChanged,i)}),this.handleDataPacket=((t,e)=>{const i=this.participants.get(t.participantSid);this.emit(l.RoomEvent.DataReceived,t.payload,i,e),null==i||i.emit(l.ParticipantEvent.DataReceived,t.payload,e)}),this.handleAudioPlaybackStarted=(()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(l.RoomEvent.AudioPlaybackStatusChanged,!0))}),this.handleAudioPlaybackFailed=(t=>{s.default.warn("could not playback audio",t),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(l.RoomEvent.AudioPlaybackStatusChanged,!1))}),this.handleDeviceChange=(()=>a(this,void 0,void 0,function*(){this.emit(l.RoomEvent.MediaDevicesChanged)})),this.handleRoomUpdate=(t=>{this.metadata=t.metadata,this.emit(l.RoomEvent.RoomMetadataChanged,t.metadata)}),this.handleConnectionQualityUpdate=(t=>{t.updates.forEach(t=>{if(t.participantSid===this.localParticipant.sid)return void this.localParticipant.setConnectionQuality(t.quality);const e=this.participants.get(t.participantSid);e&&e.setConnectionQuality(t.quality)})}),this.participants=new Map,this.options=e||{},this.engine=new v.default(t,this.options.rtcConfig),this.acquireAudioContext(),this.engine.on(l.EngineEvent.MediaTrackAdded,(t,e,i)=>{this.onTrackAdded(t,e,i)}),this.engine.on(l.EngineEvent.Disconnected,()=>{this.handleDisconnect()}),this.engine.on(l.EngineEvent.ParticipantUpdate,t=>{this.handleParticipantUpdates(t)}),this.engine.on(l.EngineEvent.RoomUpdate,this.handleRoomUpdate),this.engine.on(l.EngineEvent.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate),this.engine.on(l.EngineEvent.SpeakersChanged,this.handleSpeakersChanged),this.engine.on(l.EngineEvent.DataPacketReceived,this.handleDataPacket),this.engine.on(l.EngineEvent.Reconnecting,()=>{this.state=k.Reconnecting,this.emit(l.RoomEvent.Reconnecting)}),this.engine.on(l.EngineEvent.Reconnected,()=>{this.state=k.Connected,this.emit(l.RoomEvent.Reconnected)}),this.engine.on(l.EngineEvent.ConnectionQualityUpdate,this.handleConnectionQualityUpdate)}static getLocalDevices(t){return d.default.getInstance().getDevices(t)}set defaultPublishOptions(t){r.setTrackPublishDefaults(t)}get defaultPublishOptions(){return r.getTrackPublishDefaults()}set defaultCaptureOptions(t){r.setTrackCaptureDefaults(t)}get defaultCaptureOptions(){return r.getTrackCaptureDefaults()}startAudio(){return a(this,void 0,void 0,function*(){this.acquireAudioContext();const t=[];this.participants.forEach(e=>{e.audioTracks.forEach(e=>{e.track&&e.track.attachedElements.forEach(e=>{t.push(e)})})});try{yield Promise.all(t.map(t=>t.play())),this.handleAudioPlaybackStarted()}catch(e){throw this.handleAudioPlaybackFailed(e),e}})}get canPlaybackAudio(){return this.audioEnabled}switchActiveDevice(t,e){return a(this,void 0,void 0,function*(){if("audioinput"===t){const t=Array.from(this.localParticipant.audioTracks.values()).filter(t=>t.source===m.Track.Source.Microphone);yield Promise.all(t.map(t=>{var i;return null===(i=t.audioTrack)||void 0===i?void 0:i.setDeviceId(e)})),this.defaultCaptureOptions.audioDeviceId=e}else if("videoinput"===t){const t=Array.from(this.localParticipant.videoTracks.values()).filter(t=>t.source===m.Track.Source.Camera);yield Promise.all(t.map(t=>{var i;return null===(i=t.videoTrack)||void 0===i?void 0:i.setDeviceId(e)})),this.defaultCaptureOptions.videoDeviceId=e}else if("audiooutput"===t){const t=[];this.participants.forEach(e=>{e.audioTracks.forEach(e=>{e.isSubscribed&&e.track&&e.track.attachedElements.forEach(e=>{t.push(e)})})}),yield Promise.all(t.map(t=>a(this,void 0,void 0,function*(){"setSinkId"in t&&(yield t.setSinkId(e))})))}})}onTrackAdded(t,e,i){const a=E.unpackStreamId(e.id),n=a[0];let o=a[1];o&&""!==o||(o=t.id),this.getOrCreateParticipant(n).addSubscribedMediaTrack(t,o,i,this.options.autoManageVideo)}handleDisconnect(t=!0){this.state!==k.Disconnected&&(this.participants.forEach(t=>{t.tracks.forEach(e=>{t.unpublishTrack(e.trackSid)})}),t&&this.localParticipant.tracks.forEach(t=>{var e,i;null===(e=t.track)||void 0===e||e.detach(),null===(i=t.track)||void 0===i||i.stop()}),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&(this.audioContext.close(),this.audioContext=void 0),window.removeEventListener("beforeunload",this.onBeforeUnload),navigator.mediaDevices.removeEventListener("devicechange",this.handleDeviceChange),this.emit(l.RoomEvent.Disconnected),this.state=k.Disconnected)}handleParticipantUpdates(t){t.forEach(t=>{if(t.sid===this.localParticipant.sid)return void this.localParticipant.updateInfo(t);let e=this.participants.get(t.sid);const i=!e;e=this.getOrCreateParticipant(t.sid,t),t.state===c.ParticipantInfo_State.DISCONNECTED?this.handleParticipantDisconnected(t.sid,e):i?this.emit(l.RoomEvent.ParticipantConnected,e):e.updateInfo(t)})}handleParticipantDisconnected(t,e){this.participants.delete(t),e&&(e.tracks.forEach(t=>{e.unpublishTrack(t.trackSid)}),this.emit(l.RoomEvent.ParticipantDisconnected,e))}acquireAudioContext(){this.audioContext&&this.audioContext.close();const t=window.AudioContext||window.webkitAudioContext;t&&(this.audioContext=new t)}getOrCreateParticipant(t,e){let i=this.participants.get(t);return i||(i=e?p.default.fromParticipantInfo(this.engine.client,e):new p.default(this.engine.client,t,""),this.participants.set(t,i),i.on(l.ParticipantEvent.TrackPublished,t=>{this.emit(l.RoomEvent.TrackPublished,t,i)}).on(l.ParticipantEvent.TrackSubscribed,(t,e)=>{t.kind===m.Track.Kind.Audio&&(t.on(l.TrackEvent.AudioPlaybackStarted,this.handleAudioPlaybackStarted),t.on(l.TrackEvent.AudioPlaybackFailed,this.handleAudioPlaybackFailed)),this.emit(l.RoomEvent.TrackSubscribed,t,e,i)}).on(l.ParticipantEvent.TrackUnpublished,t=>{this.emit(l.RoomEvent.TrackUnpublished,t,i)}).on(l.ParticipantEvent.TrackUnsubscribed,(t,e)=>{this.emit(l.RoomEvent.TrackUnsubscribed,t,e,i)}).on(l.ParticipantEvent.TrackSubscriptionFailed,t=>{this.emit(l.RoomEvent.TrackSubscriptionFailed,t,i)}).on(l.ParticipantEvent.TrackMuted,t=>{this.emit(l.RoomEvent.TrackMuted,t,i)}).on(l.ParticipantEvent.TrackUnmuted,t=>{this.emit(l.RoomEvent.TrackUnmuted,t,i)}).on(l.ParticipantEvent.MetadataChanged,(t,e)=>{this.emit(l.RoomEvent.ParticipantMetadataChanged,t,e),this.emit(l.RoomEvent.MetadataChanged,t,e)}).on(l.ParticipantEvent.ConnectionQualityChanged,t=>{this.emit(l.RoomEvent.ConnectionQualityChanged,t,i)})),i}emit(t,...e){return s.default.debug("room event",t,...e),super.emit(t,...e)}}exports.default=f;
},{"events":"wIHY","../logger":"mQuM","../proto/livekit_models":"OxfL","./defaults":"drFi","./DeviceManager":"FLCb","./errors":"k3b3","./events":"q9Tz","./participant/LocalParticipant":"n9xZ","./participant/RemoteParticipant":"gZZ1","./RTCEngine":"eBAz","./track/Track":"UBMR","./utils":"gnWX"}],"RsyN":[function(require,module,exports) {
"use strict";function e(e,n,r){return(n=t(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function t(e){var t=n(e,"string");return"symbol"===r(t)?t:String(t)}function n(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.compactObject=v,exports.deprecated=f,exports.detectBrowser=l,exports.disableLog=u,exports.disableWarnings=c,exports.extractVersion=s,exports.filterStats=h,exports.log=p,exports.walkStats=b,exports.wrapPeerConnectionEvent=a;var o=!0,i=!0;function s(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function a(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,o=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return o.apply(this,arguments);var i=function(e){var t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,i),o.apply(this,[e,i])};var i=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return i.apply(this,arguments);if(!this._eventMap[t].has(n))return i.apply(this,arguments);var r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,i.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function u(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(o=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function c(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function p(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(o)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function f(e,t){i&&console.warn(e+" is deprecated, please use "+t+" instead.")}function l(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=s(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=s(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=s(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=s(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}function d(e){return"[object Object]"===Object.prototype.toString.call(e)}function v(t){return d(t)?Object.keys(t).reduce(function(n,r){var o=d(t[r]),i=o?v(t[r]):t[r],s=o&&!Object.keys(i).length;return void 0===i||s?n:Object.assign(n,e({},r,i))},{}):t}function b(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(function(r){r.endsWith("Id")?b(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach(function(t){b(e,e.get(t),n)})}))}function h(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;var i=[];return e.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&i.push(e)}),i.forEach(function(t){e.forEach(function(n){n.type===r&&n.trackId===t.id&&b(e,n,o)})}),o}
},{}],"RmTL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimGetUserMedia=i;var e=t(require("../utils.js"));function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,o=new WeakMap;return(r=function(e){return e?o:t})(e)}function t(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var o=r(t);if(o&&o.has(e))return o.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=i?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(n,a,c):n[a]=e[a]}return n.default=e,o&&o.set(e,n),n}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=e.log;function i(e,r){var t=e&&e.navigator;if(t.mediaDevices){var i=function(e){if("object"!==o(e)||e.mandatory||e.optional)return e;var r={};return Object.keys(e).forEach(function(t){if("require"!==t&&"advanced"!==t&&"mediaSource"!==t){var n="object"===o(e[t])?e[t]:{ideal:e[t]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var i=function(e,r){return e?e+r.charAt(0).toUpperCase()+r.slice(1):"deviceId"===r?"sourceId":r};if(void 0!==n.ideal){r.optional=r.optional||[];var a={};"number"==typeof n.ideal?(a[i("min",t)]=n.ideal,r.optional.push(a),(a={})[i("max",t)]=n.ideal,r.optional.push(a)):(a[i("",t)]=n.ideal,r.optional.push(a))}void 0!==n.exact&&"number"!=typeof n.exact?(r.mandatory=r.mandatory||{},r.mandatory[i("",t)]=n.exact):["min","max"].forEach(function(e){void 0!==n[e]&&(r.mandatory=r.mandatory||{},r.mandatory[i(e,t)]=n[e])})}}),e.advanced&&(r.optional=(r.optional||[]).concat(e.advanced)),r},a=function(e,a){if(r.version>=61)return a(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===o(e.audio)){var c=function(e,r,t){r in e&&!(t in e)&&(e[t]=e[r],delete e[r])};c((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),c(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"===o(e.video)){var d=e.video.facingMode;d=d&&("object"===o(d)?d:{ideal:d});var u,s=r.version<66;if(d&&("user"===d.exact||"environment"===d.exact||"user"===d.ideal||"environment"===d.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||s))if(delete e.video.facingMode,"environment"===d.exact||"environment"===d.ideal?u=["back","rear"]:"user"!==d.exact&&"user"!==d.ideal||(u=["front"]),u)return t.mediaDevices.enumerateDevices().then(function(r){var t=(r=r.filter(function(e){return"videoinput"===e.kind})).find(function(e){return u.some(function(r){return e.label.toLowerCase().includes(r)})});return!t&&r.length&&u.includes("back")&&(t=r[r.length-1]),t&&(e.video.deviceId=d.exact?{exact:t.deviceId}:{ideal:t.deviceId}),e.video=i(e.video),n("chrome: "+JSON.stringify(e)),a(e)});e.video=i(e.video)}return n("chrome: "+JSON.stringify(e)),a(e)},c=function(e){return r.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,r,o){a(e,function(e){t.webkitGetUserMedia(e,r,function(e){o&&o(c(e))})})}.bind(t),t.mediaDevices.getUserMedia){var d=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return a(e,function(e){return d(e).then(function(r){if(e.audio&&!r.getAudioTracks().length||e.video&&!r.getVideoTracks().length)throw r.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return r},function(e){return Promise.reject(c(e))})})}}}}
},{"../utils.js":"RsyN"}],"yjjI":[function(require,module,exports) {
"use strict";function e(e,i){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof i?e.navigator.mediaDevices.getDisplayMedia=function(a){return i(a).then(function(i){var t=a.video&&a.video.width,o=a.video&&a.video.height,d=a.video&&a.video.frameRate;return a.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:d||3}},t&&(a.video.mandatory.maxWidth=t),o&&(a.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(a)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimGetDisplayMedia=e;
},{}],"RNlo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fixNegotiationNeeded=C,exports.shimAddTrackRemoveTrack=l,exports.shimAddTrackRemoveTrackWithNative=m,Object.defineProperty(exports,"shimGetDisplayMedia",{enumerable:!0,get:function(){return r.shimGetDisplayMedia}}),exports.shimGetSendersWithDtmf=h,exports.shimGetStats=f,Object.defineProperty(exports,"shimGetUserMedia",{enumerable:!0,get:function(){return t.shimGetUserMedia}}),exports.shimMediaStream=p,exports.shimOnTrack=d,exports.shimPeerConnection=v,exports.shimSenderReceiverGetStats=u;var e=i(require("../utils.js")),t=require("./getusermedia"),r=require("./getdisplaymedia");function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function i(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=e[s]}return i.default=e,r&&r.set(e,i),i}function o(e,t,r){return(t=s(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){var t=a(e,"string");return"symbol"===c(t)?t:String(t)}function a(e,t){if("object"!==c(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function d(t){if("object"!==c(t)||!t.RTCPeerConnection||"ontrack"in t.RTCPeerConnection.prototype)e.wrapPeerConnectionEvent(t,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e});else{Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._ontrackpoly||(this._ontrackpoly=function(r){r.stream.addEventListener("addtrack",function(n){var i;i=t.RTCPeerConnection.prototype.getReceivers?e.getReceivers().find(function(e){return e.track&&e.track.id===n.track.id}):{track:n.track};var o=new Event("track");o.track=n.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[r.stream],e.dispatchEvent(o)}),r.stream.getTracks().forEach(function(n){var i;i=t.RTCPeerConnection.prototype.getReceivers?e.getReceivers().find(function(e){return e.track&&e.track.id===n.id}):{track:n};var o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=[r.stream],e.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}}function h(e){if("object"===c(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach(function(e){r._senders.push(t(r,e))})};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach(function(e){var r=t._senders.find(function(t){return t.track===e});r&&t._senders.splice(t._senders.indexOf(r),1)})}}else if("object"===c(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function f(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,[r,n,i]=arguments;if(arguments.length>0&&"function"==typeof r)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof r))return t.apply(this,[]);var o=function(e){var t={};return e.result().forEach(function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){r[t]=e.stat(t)}),t[r.id]=r}),t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(arguments.length>=2){return t.apply(this,[function(e){n(s(o(e)))},r])}return new Promise(function(r,n){t.apply(e,[function(e){r(s(o(e)))},n])}).then(n,i)}}}function u(t){if("object"===c(t)&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver){if(!("getStats"in t.RTCRtpSender.prototype)){var r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=r.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t});var n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),t.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(r){return e.filterStats(r,t.track,!0)})}}if(!("getStats"in t.RTCRtpReceiver.prototype)){var i=t.RTCPeerConnection.prototype.getReceivers;i&&(t.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t}),e.wrapPeerConnectionEvent(t,"track",function(e){return e.receiver._pc=e.srcElement,e}),t.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(r){return e.filterStats(r,t.track,!1)})}}if("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype){var o=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){var e,r,n,i=arguments[0];return this.getSenders().forEach(function(t){t.track===i&&(e?n=!0:e=t)}),this.getReceivers().forEach(function(e){return e.track===i&&(r?n=!0:r=e),e.track===i}),n||e&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):e?e.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}}function m(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(e){if(t.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")});var n=this.getSenders();r.apply(this,arguments);var i=this.getSenders().filter(function(e){return-1===n.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(i)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]}),i.apply(this,arguments)}}function l(e,t){if(e.RTCPeerConnection){if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return m(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map(function(t){return e._reverseStreams[t.id]})};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(function(e){if(r.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}n.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[r.id];if(o)o.addTrack(t),Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))});else{var s=new e.MediaStream([t]);this._streams[r.id]=s,this._reverseStreams[s.id]=r,this.addStream(s)}return this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t],n=o({},t,function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[function(r){var n=c(e,r);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then(function(t){return c(e,t)})});e.RTCPeerConnection.prototype[t]=n[t]});var s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,t=arguments[0],r=t.sdp,Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:r})),s.apply(this,arguments)):s.apply(this,arguments);var e,t,r};var a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=a.get.apply(this);return""===e.type?e:c(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach(function(n){r._streams[n].getTracks().find(function(t){return e.track===t})&&(t=r._streams[n])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function c(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(i.id,"g"),n.id)}),new RTCSessionDescription({type:t.type,sdp:r})}}function v(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t],n=o({},t,function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=n[t]})}function C(t,r){e.wrapPeerConnectionEvent(t,"negotiationneeded",function(e){var t=e.target;if(!(r.version<72||t.getConfiguration&&"plan-b"===t.getConfiguration().sdpSemantics)||"stable"===t.signalingState)return e})}
},{"../utils.js":"RsyN","./getusermedia":"RmTL","./getdisplaymedia":"yjjI"}],"uuCd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.filterIceServers=n;var r=t(require("../utils"));function e(r){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(e=function(r){return r?n:t})(r)}function t(r,t){if(!t&&r&&r.__esModule)return r;if(null===r||"object"!=typeof r&&"function"!=typeof r)return{default:r};var n=e(t);if(n&&n.has(r))return n.get(r);var u={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in r)if("default"!==f&&Object.prototype.hasOwnProperty.call(r,f)){var l=i?Object.getOwnPropertyDescriptor(r,f):null;l&&(l.get||l.set)?Object.defineProperty(u,f,l):u[f]=r[f]}return u.default=r,n&&n.set(r,u),u}function n(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var u="string"==typeof t;return u&&(t=[t]),t=t.filter(function(r){if(0===r.indexOf("stun:"))return!1;var e=r.startsWith("turn")&&!r.startsWith("turn:[")&&r.includes("transport=udp");return e&&!n?(n=!0,!0):e&&!n}),delete e.url,e.urls=u?t[0]:t,!!t.length}})}
},{"../utils":"RsyN"}],"jIWI":[function(require,module,exports) {
"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(r){return r.trim().split("\n").map(function(r){return r.trim()})},r.splitSections=function(r){return r.split("\nm=").map(function(r,e){return(e>0?"m="+r:r).trim()+"\r\n"})},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(r){return 0===r.indexOf(t)})},r.parseCandidate=function(r){for(var e,t={foundation:(e=0===r.indexOf("a=candidate:")?r.substring(12).split(" "):r.substring(10).split(" "))[0],component:parseInt(e[1],10),protocol:e[2].toLowerCase(),priority:parseInt(e[3],10),ip:e[4],address:e[4],port:parseInt(e[5],10),type:e[7]},a=8;a<e.length;a+=2)switch(e[a]){case"raddr":t.relatedAddress=e[a+1];break;case"rport":t.relatedPort=parseInt(e[a+1],10);break;case"tcptype":t.tcpType=e[a+1];break;case"ufrag":t.ufrag=e[a+1],t.usernameFragment=e[a+1];break;default:t[e[a]]=e[a+1]}return t},r.writeCandidate=function(r){var e=[];e.push(r.foundation),e.push(r.component),e.push(r.protocol.toUpperCase()),e.push(r.priority),e.push(r.address||r.ip),e.push(r.port);var t=r.type;return e.push("typ"),e.push(t),"host"!==t&&r.relatedAddress&&r.relatedPort&&(e.push("raddr"),e.push(r.relatedAddress),e.push("rport"),e.push(r.relatedPort)),r.tcpType&&"tcp"===r.protocol.toLowerCase()&&(e.push("tcptype"),e.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(e.push("ufrag"),e.push(r.usernameFragment||r.ufrag)),"candidate:"+e.join(" ")},r.parseIceOptions=function(r){return r.substr(14).split(" ")},r.parseRtpMap=function(r){var e=r.substr(9).split(" "),t={payloadType:parseInt(e.shift(),10)};return e=e[0].split("/"),t.name=e[0],t.clockRate=parseInt(e[1],10),t.channels=3===e.length?parseInt(e[2],10):1,t.numChannels=t.channels,t},r.writeRtpMap=function(r){var e=r.payloadType;void 0!==r.preferredPayloadType&&(e=r.preferredPayloadType);var t=r.channels||r.numChannels||1;return"a=rtpmap:"+e+" "+r.name+"/"+r.clockRate+(1!==t?"/"+t:"")+"\r\n"},r.parseExtmap=function(r){var e=r.substr(9).split(" ");return{id:parseInt(e[0],10),direction:e[0].indexOf("/")>0?e[0].split("/")[1]:"sendrecv",uri:e[1]}},r.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&"sendrecv"!==r.direction?"/"+r.direction:"")+" "+r.uri+"\r\n"},r.parseFmtp=function(r){for(var e,t={},a=r.substr(r.indexOf(" ")+1).split(";"),n=0;n<a.length;n++)t[(e=a[n].trim().split("="))[0].trim()]=e[1];return t},r.writeFmtp=function(r){var e="",t=r.payloadType;if(void 0!==r.preferredPayloadType&&(t=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){var a=[];Object.keys(r.parameters).forEach(function(e){r.parameters[e]?a.push(e+"="+r.parameters[e]):a.push(e)}),e+="a=fmtp:"+t+" "+a.join(";")+"\r\n"}return e},r.parseRtcpFb=function(r){var e=r.substr(r.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}},r.writeRtcpFb=function(r){var e="",t=r.payloadType;return void 0!==r.preferredPayloadType&&(t=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(function(r){e+="a=rtcp-fb:"+t+" "+r.type+(r.parameter&&r.parameter.length?" "+r.parameter:"")+"\r\n"}),e},r.parseSsrcMedia=function(r){var e=r.indexOf(" "),t={ssrc:parseInt(r.substr(7,e-7),10)},a=r.indexOf(":",e);return a>-1?(t.attribute=r.substr(e+1,a-e-1),t.value=r.substr(a+1)):t.attribute=r.substr(e+1),t},r.parseSsrcGroup=function(r){var e=r.substr(13).split(" ");return{semantics:e.shift(),ssrcs:e.map(function(r){return parseInt(r,10)})}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(r){var e=r.substr(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(r,e){var t="a=setup:"+e+"\r\n";return r.fingerprints.forEach(function(r){t+="a=fingerprint:"+r.algorithm+" "+r.value+"\r\n"}),t},r.parseCryptoLine=function(r){var e=r.substr(9).split(" ");return{tag:parseInt(e[0],10),cryptoSuite:e[1],keyParams:e[2],sessionParams:e.slice(3)}},r.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?r.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},r.parseCryptoKeyParams=function(r){if(0!==r.indexOf("inline:"))return null;var e=r.substr(7).split("|");return{keyMethod:"inline",keySalt:e[0],lifeTime:e[1],mkiValue:e[2]?e[2].split(":")[0]:void 0,mkiLength:e[2]?e[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(r){return r.keyMethod+":"+r.keySalt+(r.lifeTime?"|"+r.lifeTime:"")+(r.mkiValue&&r.mkiLength?"|"+r.mkiValue+":"+r.mkiLength:"")},r.getCryptoParameters=function(e,t){return r.matchPrefix(e+t,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(e,t){var a=r.matchPrefix(e+t,"a=ice-ufrag:")[0],n=r.matchPrefix(e+t,"a=ice-pwd:")[0];return a&&n?{usernameFragment:a.substr(12),password:n.substr(10)}:null},r.writeIceParameters=function(r){return"a=ice-ufrag:"+r.usernameFragment+"\r\na=ice-pwd:"+r.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=r.splitLines(e)[0].split(" "),n=3;n<a.length;n++){var s=a[n],i=r.matchPrefix(e,"a=rtpmap:"+s+" ")[0];if(i){var p=r.parseRtpMap(i),c=r.matchPrefix(e,"a=fmtp:"+s+" ");switch(p.parameters=c.length?r.parseFmtp(c[0]):{},p.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+s+" ").map(r.parseRtcpFb),t.codecs.push(p),p.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(p.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var a="";a+="m="+e+" ",a+=t.codecs.length>0?"9":"0",a+=" UDP/TLS/RTP/SAVPF ",a+=t.codecs.map(function(r){return void 0!==r.preferredPayloadType?r.preferredPayloadType:r.payloadType}).join(" ")+"\r\n",a+="c=IN IP4 0.0.0.0\r\n",a+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){a+=r.writeRtpMap(e),a+=r.writeFmtp(e),a+=r.writeRtcpFb(e)});var n=0;return t.codecs.forEach(function(r){r.maxptime>n&&(n=r.maxptime)}),n>0&&(a+="a=maxptime:"+n+"\r\n"),a+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){a+=r.writeExtmap(e)}),a},r.parseRtpEncodingParameters=function(e){var t,a=[],n=r.parseRtpParameters(e),s=-1!==n.fecMechanisms.indexOf("RED"),i=-1!==n.fecMechanisms.indexOf("ULPFEC"),p=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(r){return"cname"===r.attribute}),c=p.length>0&&p[0].ssrc,o=r.matchPrefix(e,"a=ssrc-group:FID").map(function(r){return r.substr(17).split(" ").map(function(r){return parseInt(r,10)})});o.length>0&&o[0].length>1&&o[0][0]===c&&(t=o[0][1]),n.codecs.forEach(function(r){if("RTX"===r.name.toUpperCase()&&r.parameters.apt){var e={ssrc:c,codecPayloadType:parseInt(r.parameters.apt,10)};c&&t&&(e.rtx={ssrc:t}),a.push(e),s&&((e=JSON.parse(JSON.stringify(e))).fec={ssrc:c,mechanism:i?"red+ulpfec":"red"},a.push(e))}}),0===a.length&&c&&a.push({ssrc:c});var u=r.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,a.forEach(function(r){r.maxBitrate=u})),a},r.parseRtcpParameters=function(e){var t={},a=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(r){return"cname"===r.attribute})[0];a&&(t.cname=a.value,t.ssrc=a.ssrc);var n=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=n.length>0,t.compound=0===n.length;var s=r.matchPrefix(e,"a=rtcp-mux");return t.mux=s.length>0,t},r.parseMsid=function(e){var t,a=r.matchPrefix(e,"a=msid:");if(1===a.length)return{stream:(t=a[0].substr(7).split(" "))[0],track:t[1]};var n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(r){return"msid"===r.attribute});return n.length>0?{stream:(t=n[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,a=r.parseMLine(e),n=r.matchPrefix(e,"a=max-message-size:");n.length>0&&(t=parseInt(n[0].substr(19),10)),isNaN(t)&&(t=65536);var s=r.matchPrefix(e,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substr(12),10),protocol:a.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var i=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(i[0],10),protocol:i[1],maxMessageSize:t}}},r.writeSctpDescription=function(r,e){var t=[];return t="DTLS/SCTP"!==r.protocol?["m="+r.kind+" 9 "+r.protocol+" "+e.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+e.port+"\r\n"]:["m="+r.kind+" 9 "+r.protocol+" "+e.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+e.port+" "+e.protocol+" 65535\r\n"],void 0!==e.maxMessageSize&&t.push("a=max-message-size:"+e.maxMessageSize+"\r\n"),t.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,a){var n=void 0!==t?t:2;return"v=0\r\no="+(a||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,a,n){var s=r.writeRtpDescription(e.kind,t);if(s+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),s+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===a?"actpass":"active"),s+="a=mid:"+e.mid+"\r\n",e.direction?s+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?s+="a=sendrecv\r\n":e.rtpSender?s+="a=sendonly\r\n":e.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",e.rtpSender){var i="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";s+="a="+i,s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+i,e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+i,s+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),s},r.getDirection=function(e,t){for(var a=r.splitLines(e),n=0;n<a.length;n++)switch(a[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return a[n].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(r){return"0"===r.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),a=0;a<t.length;a++)if(t[a].length<2||"="!==t[a].charAt(1))return!1;return!0},"object"==typeof module&&(module.exports=r);
},{}],"heG5":[function(require,module,exports) {
"use strict";var e=require("sdp");function t(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}function r(t,r,n,a,i){var s=e.writeRtpDescription(t.kind,r);if(s+=e.writeIceParameters(t.iceGatherer.getLocalParameters()),s+=e.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":i||"active"),s+="a=mid:"+t.mid+"\r\n",t.rtpSender&&t.rtpReceiver?s+="a=sendrecv\r\n":t.rtpSender?s+="a=sendonly\r\n":t.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",t.rtpSender){var o=t.rtpSender._initialTrackId||t.rtpSender.track.id;t.rtpSender._initialTrackId=o;var c="msid:"+(a?a.id:"-")+" "+o+"\r\n";s+="a="+c,s+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+c,t.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+c,s+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+e.localCName+"\r\n",t.rtpSender&&t.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+e.localCName+"\r\n"),s}function n(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var a="string"==typeof n;return a&&(n=[n]),n=n.filter(function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!r?(r=!0,!0):0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp")}),delete e.url,e.urls=a?n[0]:n,!!n.length}})}function a(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},a=function(e,t,r,a){var i=n(e.parameters.apt,r),s=n(t.parameters.apt,a);return i&&s&&i.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach(function(n){for(var i=0;i<t.codecs.length;i++){var s=t.codecs[i];if(n.name.toLowerCase()===s.name.toLowerCase()&&n.clockRate===s.clockRate){if("rtx"===n.name.toLowerCase()&&n.parameters&&s.parameters.apt&&!a(n,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(n.numChannels,s.numChannels),r.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter(function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var n=0;n<t.headerExtensions.length;n++){var a=t.headerExtensions[n];if(e.uri===a.uri){r.headerExtensions.push(a);break}}}),r}function i(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function s(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return r||e.addRemoteCandidate(t),!r}function o(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}module.exports=function(c,d){function p(e,t){t.addTrack(e),t.dispatchEvent(new c.MediaStreamTrackEvent("addtrack",{track:e}))}function l(e,t,r,n){var a=new Event("track");a.track=t,a.receiver=r,a.transceiver={receiver:r},a.streams=n,c.setTimeout(function(){e._dispatchEvent("track",a)})}var f=function(t){var r=this,a=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){r[e]=a[e].bind(a)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",t=JSON.parse(JSON.stringify(t||{})),this.usingBundle="max-bundle"===t.bundlePolicy,"negotiate"===t.rtcpMuxPolicy)throw o("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(t.rtcpMuxPolicy||(t.rtcpMuxPolicy="require"),t.iceTransportPolicy){case"all":case"relay":break;default:t.iceTransportPolicy="all"}switch(t.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:t.bundlePolicy="balanced"}if(t.iceServers=n(t.iceServers||[],d),this._iceGatherers=[],t.iceCandidatePoolSize)for(var i=t.iceCandidatePoolSize;i>0;i--)this._iceGatherers.push(new c.RTCIceGatherer({iceServers:t.iceServers,gatherPolicy:t.iceTransportPolicy}));else t.iceCandidatePoolSize=0;this._config=t,this.transceivers=[],this._sdpSessionId=e.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(f.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(f.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),f.prototype.onicecandidate=null,f.prototype.onaddstream=null,f.prototype.ontrack=null,f.prototype.onremovestream=null,f.prototype.onsignalingstatechange=null,f.prototype.oniceconnectionstatechange=null,f.prototype.onconnectionstatechange=null,f.prototype.onicegatheringstatechange=null,f.prototype.onnegotiationneeded=null,f.prototype.ondatachannel=null,f.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},f.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},f.prototype.getConfiguration=function(){return this._config},f.prototype.getLocalStreams=function(){return this.localStreams},f.prototype.getRemoteStreams=function(){return this.remoteStreams},f.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var a=this._createIceAndDtlsTransports();n.iceTransport=a.iceTransport,n.dtlsTransport=a.dtlsTransport}return t||this.transceivers.push(n),n},f.prototype.addTrack=function(e,t){if(this._isClosed)throw o("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find(function(t){return t.track===e}))throw o("InvalidAccessError","Track already exists.");for(var n=0;n<this.transceivers.length;n++)this.transceivers[n].track||this.transceivers[n].kind!==e.kind||(r=this.transceivers[n]);return r||(r=this._createTransceiver(e.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(t)&&this.localStreams.push(t),r.track=e,r.stream=t,r.rtpSender=new c.RTCRtpSender(e,r.dtlsTransport),r.rtpSender},f.prototype.addStream=function(e){var t=this;if(d>=15025)e.getTracks().forEach(function(r){t.addTrack(r,e)});else{var r=e.clone();e.getTracks().forEach(function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),r.getTracks().forEach(function(e){t.addTrack(e,r)})}},f.prototype.removeTrack=function(e){if(this._isClosed)throw o("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(e instanceof c.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var t=this.transceivers.find(function(t){return t.rtpSender===e});if(!t)throw o("InvalidAccessError","Sender was not created by this connection.");var r=t.stream;t.rtpSender.stop(),t.rtpSender=null,t.track=null,t.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},f.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var r=t.getSenders().find(function(t){return t.track===e});r&&t.removeTrack(r)})},f.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},f.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},f.prototype._createIceGatherer=function(e,t){var r=this;if(t&&e>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var n=new c.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(n,"state",{value:"new",writable:!0}),this.transceivers[e].bufferedCandidateEvents=[],this.transceivers[e].bufferCandidates=function(t){var a=!t.candidate||0===Object.keys(t.candidate).length;n.state=a?"completed":"gathering",null!==r.transceivers[e].bufferedCandidateEvents&&r.transceivers[e].bufferedCandidateEvents.push(t)},n.addEventListener("localcandidate",this.transceivers[e].bufferCandidates),n},f.prototype._gather=function(t,r){var n=this,a=this.transceivers[r].iceGatherer;if(!a.onlocalcandidate){var i=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,a.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),a.onlocalcandidate=function(i){if(!(n.usingBundle&&r>0)){var s=new Event("icecandidate");s.candidate={sdpMid:t,sdpMLineIndex:r};var o=i.candidate,c=!o||0===Object.keys(o).length;if(c)"new"!==a.state&&"gathering"!==a.state||(a.state="completed");else{"new"===a.state&&(a.state="gathering"),o.component=1,o.ufrag=a.getLocalParameters().usernameFragment;var d=e.writeCandidate(o);s.candidate=Object.assign(s.candidate,e.parseCandidate(d)),s.candidate.candidate=d,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var p=e.getMediaSections(n._localDescription.sdp);p[s.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",n._localDescription.sdp=e.getDescription(n._localDescription.sdp)+p.join("");var l=n.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==n.iceGatheringState&&(n.iceGatheringState="gathering",n._emitGatheringStateChange()),c||n._dispatchEvent("icecandidate",s),l&&(n._dispatchEvent("icecandidate",new Event("icecandidate")),n.iceGatheringState="complete",n._emitGatheringStateChange())}},c.setTimeout(function(){i.forEach(function(e){a.onlocalcandidate(e)})},0)}},f.prototype._createIceAndDtlsTransports=function(){var e=this,t=new c.RTCIceTransport(null);t.onicestatechange=function(){e._updateIceConnectionState(),e._updateConnectionState()};var r=new c.RTCDtlsTransport(t);return r.ondtlsstatechange=function(){e._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:t,dtlsTransport:r}},f.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},f.prototype._transceive=function(t,r,n){var i=a(t.localCapabilities,t.remoteCapabilities);r&&t.rtpSender&&(i.encodings=t.sendEncodingParameters,i.rtcp={cname:e.localCName,compound:t.rtcpParameters.compound},t.recvEncodingParameters.length&&(i.rtcp.ssrc=t.recvEncodingParameters[0].ssrc),t.rtpSender.send(i)),n&&t.rtpReceiver&&i.codecs.length>0&&("video"===t.kind&&t.recvEncodingParameters&&d<15019&&t.recvEncodingParameters.forEach(function(e){delete e.rtx}),t.recvEncodingParameters.length?i.encodings=t.recvEncodingParameters:i.encodings=[{}],i.rtcp={compound:t.rtcpParameters.compound},t.rtcpParameters.cname&&(i.rtcp.cname=t.rtcpParameters.cname),t.sendEncodingParameters.length&&(i.rtcp.ssrc=t.sendEncodingParameters[0].ssrc),t.rtpReceiver.receive(i))},f.prototype.setLocalDescription=function(t){var r,n,s=this;if(-1===["offer","answer"].indexOf(t.type))return Promise.reject(o("TypeError",'Unsupported type "'+t.type+'"'));if(!i("setLocalDescription",t.type,s.signalingState)||s._isClosed)return Promise.reject(o("InvalidStateError","Can not set local "+t.type+" in state "+s.signalingState));if("offer"===t.type)r=e.splitSections(t.sdp),n=r.shift(),r.forEach(function(t,r){var n=e.parseRtpParameters(t);s.transceivers[r].localCapabilities=n}),s.transceivers.forEach(function(e,t){s._gather(e.mid,t)});else if("answer"===t.type){r=e.splitSections(s._remoteDescription.sdp),n=r.shift();var c=e.matchPrefix(n,"a=ice-lite").length>0;r.forEach(function(t,r){var i=s.transceivers[r],o=i.iceGatherer,d=i.iceTransport,p=i.dtlsTransport,l=i.localCapabilities,f=i.remoteCapabilities;if(!(e.isRejected(t)&&0===e.matchPrefix(t,"a=bundle-only").length)&&!i.rejected){var u=e.getIceParameters(t,n),v=e.getDtlsParameters(t,n);c&&(v.role="server"),s.usingBundle&&0!==r||(s._gather(i.mid,r),"new"===d.state&&d.start(o,u,c?"controlling":"controlled"),"new"===p.state&&p.start(v));var h=a(l,f);s._transceive(i,h.codecs.length>0,!1)}})}return s._localDescription={type:t.type,sdp:t.sdp},"offer"===t.type?s._updateSignalingState("have-local-offer"):s._updateSignalingState("stable"),Promise.resolve()},f.prototype.setRemoteDescription=function(t){var r=this;if(-1===["offer","answer"].indexOf(t.type))return Promise.reject(o("TypeError",'Unsupported type "'+t.type+'"'));if(!i("setRemoteDescription",t.type,r.signalingState)||r._isClosed)return Promise.reject(o("InvalidStateError","Can not set remote "+t.type+" in state "+r.signalingState));var n={};r.remoteStreams.forEach(function(e){n[e.id]=e});var f=[],u=e.splitSections(t.sdp),v=u.shift(),h=e.matchPrefix(v,"a=ice-lite").length>0,m=e.matchPrefix(v,"a=group:BUNDLE ").length>0;r.usingBundle=m;var g=e.matchPrefix(v,"a=ice-options:")[0];return r.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,u.forEach(function(i,o){var l=e.splitLines(i),u=e.getKind(i),g=e.isRejected(i)&&0===e.matchPrefix(i,"a=bundle-only").length,y=l[0].substr(2).split(" ")[2],S=e.getDirection(i,v),T=e.parseMsid(i),E=e.getMid(i)||e.generateIdentifier();if(g||"application"===u&&("DTLS/SCTP"===y||"UDP/DTLS/SCTP"===y))r.transceivers[o]={mid:E,kind:u,protocol:y,rejected:!0};else{var C,P,w,R,_,k,b,x,D;!g&&r.transceivers[o]&&r.transceivers[o].rejected&&(r.transceivers[o]=r._createTransceiver(u,!0));var I,L,M=e.parseRtpParameters(i);g||(I=e.getIceParameters(i,v),(L=e.getDtlsParameters(i,v)).role="client"),b=e.parseRtpEncodingParameters(i);var O=e.parseRtcpParameters(i),G=e.matchPrefix(i,"a=end-of-candidates",v).length>0,j=e.matchPrefix(i,"a=candidate:").map(function(t){return e.parseCandidate(t)}).filter(function(e){return 1===e.component});if(("offer"===t.type||"answer"===t.type)&&!g&&m&&o>0&&r.transceivers[o]&&(r._disposeIceAndDtlsTransports(o),r.transceivers[o].iceGatherer=r.transceivers[0].iceGatherer,r.transceivers[o].iceTransport=r.transceivers[0].iceTransport,r.transceivers[o].dtlsTransport=r.transceivers[0].dtlsTransport,r.transceivers[o].rtpSender&&r.transceivers[o].rtpSender.setTransport(r.transceivers[0].dtlsTransport),r.transceivers[o].rtpReceiver&&r.transceivers[o].rtpReceiver.setTransport(r.transceivers[0].dtlsTransport)),"offer"!==t.type||g){if("answer"===t.type&&!g){P=(C=r.transceivers[o]).iceGatherer,w=C.iceTransport,R=C.dtlsTransport,_=C.rtpReceiver,k=C.sendEncodingParameters,x=C.localCapabilities,r.transceivers[o].recvEncodingParameters=b,r.transceivers[o].remoteCapabilities=M,r.transceivers[o].rtcpParameters=O,j.length&&"new"===w.state&&(!h&&!G||m&&0!==o?j.forEach(function(e){s(C.iceTransport,e)}):w.setRemoteCandidates(j)),m&&0!==o||("new"===w.state&&w.start(P,I,"controlling"),"new"===R.state&&R.start(L)),!a(C.localCapabilities,C.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&C.sendEncodingParameters[0].rtx&&delete C.sendEncodingParameters[0].rtx,r._transceive(C,"sendrecv"===S||"recvonly"===S,"sendrecv"===S||"sendonly"===S),!_||"sendrecv"!==S&&"sendonly"!==S?delete C.rtpReceiver:(D=_.track,T?(n[T.stream]||(n[T.stream]=new c.MediaStream),p(D,n[T.stream]),f.push([D,_,n[T.stream]])):(n.default||(n.default=new c.MediaStream),p(D,n.default),f.push([D,_,n.default])))}}else{(C=r.transceivers[o]||r._createTransceiver(u)).mid=E,C.iceGatherer||(C.iceGatherer=r._createIceGatherer(o,m)),j.length&&"new"===C.iceTransport.state&&(!G||m&&0!==o?j.forEach(function(e){s(C.iceTransport,e)}):C.iceTransport.setRemoteCandidates(j)),x=c.RTCRtpReceiver.getCapabilities(u),d<15019&&(x.codecs=x.codecs.filter(function(e){return"rtx"!==e.name})),k=C.sendEncodingParameters||[{ssrc:1001*(2*o+2)}];var N,A=!1;if("sendrecv"===S||"sendonly"===S){if(A=!C.rtpReceiver,_=C.rtpReceiver||new c.RTCRtpReceiver(C.dtlsTransport,u),A)D=_.track,T&&"-"===T.stream||(T?(n[T.stream]||(n[T.stream]=new c.MediaStream,Object.defineProperty(n[T.stream],"id",{get:function(){return T.stream}})),Object.defineProperty(D,"id",{get:function(){return T.track}}),N=n[T.stream]):(n.default||(n.default=new c.MediaStream),N=n.default)),N&&(p(D,N),C.associatedRemoteMediaStreams.push(N)),f.push([D,_,N])}else C.rtpReceiver&&C.rtpReceiver.track&&(C.associatedRemoteMediaStreams.forEach(function(e){var t,r,n=e.getTracks().find(function(e){return e.id===C.rtpReceiver.track.id});n&&(t=n,(r=e).removeTrack(t),r.dispatchEvent(new c.MediaStreamTrackEvent("removetrack",{track:t})))}),C.associatedRemoteMediaStreams=[]);C.localCapabilities=x,C.remoteCapabilities=M,C.rtpReceiver=_,C.rtcpParameters=O,C.sendEncodingParameters=k,C.recvEncodingParameters=b,r._transceive(r.transceivers[o],!1,A)}}}),void 0===r._dtlsRole&&(r._dtlsRole="offer"===t.type?"active":"passive"),r._remoteDescription={type:t.type,sdp:t.sdp},"offer"===t.type?r._updateSignalingState("have-remote-offer"):r._updateSignalingState("stable"),Object.keys(n).forEach(function(e){var t=n[e];if(t.getTracks().length){if(-1===r.remoteStreams.indexOf(t)){r.remoteStreams.push(t);var a=new Event("addstream");a.stream=t,c.setTimeout(function(){r._dispatchEvent("addstream",a)})}f.forEach(function(e){var n=e[0],a=e[1];t.id===e[2].id&&l(r,n,a,[t])})}}),f.forEach(function(e){e[2]||l(r,e[0],e[1],[])}),c.setTimeout(function(){r&&r.transceivers&&r.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},f.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},f.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},f.prototype._maybeFireNegotiationNeeded=function(){var e=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,c.setTimeout(function(){if(e.needNegotiation){e.needNegotiation=!1;var t=new Event("negotiationneeded");e._dispatchEvent("negotiationneeded",t)}},0))},f.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},f.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},f.prototype.createOffer=function(){var t=this;if(t._isClosed)return Promise.reject(o("InvalidStateError","Can not call createOffer after close"));var n=t.transceivers.filter(function(e){return"audio"===e.kind}).length,a=t.transceivers.filter(function(e){return"video"===e.kind}).length,i=arguments[0];if(i){if(i.mandatory||i.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==i.offerToReceiveAudio&&(n=!0===i.offerToReceiveAudio?1:!1===i.offerToReceiveAudio?0:i.offerToReceiveAudio),void 0!==i.offerToReceiveVideo&&(a=!0===i.offerToReceiveVideo?1:!1===i.offerToReceiveVideo?0:i.offerToReceiveVideo)}for(t.transceivers.forEach(function(e){"audio"===e.kind?--n<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)});n>0||a>0;)n>0&&(t._createTransceiver("audio"),n--),a>0&&(t._createTransceiver("video"),a--);var s=e.writeSessionBoilerplate(t._sdpSessionId,t._sdpSessionVersion++);t.transceivers.forEach(function(r,n){var a=r.track,i=r.kind,s=r.mid||e.generateIdentifier();r.mid=s,r.iceGatherer||(r.iceGatherer=t._createIceGatherer(n,t.usingBundle));var o=c.RTCRtpSender.getCapabilities(i);d<15019&&(o.codecs=o.codecs.filter(function(e){return"rtx"!==e.name})),o.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),r.remoteCapabilities&&r.remoteCapabilities.codecs&&r.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})}),o.headerExtensions.forEach(function(e){(r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[]).forEach(function(t){e.uri===t.uri&&(e.id=t.id)})});var p=r.sendEncodingParameters||[{ssrc:1001*(2*n+1)}];a&&d>=15019&&"video"===i&&!p[0].rtx&&(p[0].rtx={ssrc:p[0].ssrc+1}),r.wantReceive&&(r.rtpReceiver=new c.RTCRtpReceiver(r.dtlsTransport,i)),r.localCapabilities=o,r.sendEncodingParameters=p}),"max-compat"!==t._config.bundlePolicy&&(s+="a=group:BUNDLE "+t.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n",t.transceivers.forEach(function(n,a){s+=r(n,n.localCapabilities,"offer",n.stream,t._dtlsRole),s+="a=rtcp-rsize\r\n",!n.iceGatherer||"new"===t.iceGatheringState||0!==a&&t.usingBundle||(n.iceGatherer.getLocalCandidates().forEach(function(t){t.component=1,s+="a="+e.writeCandidate(t)+"\r\n"}),"completed"===n.iceGatherer.state&&(s+="a=end-of-candidates\r\n"))});var p=new c.RTCSessionDescription({type:"offer",sdp:s});return Promise.resolve(p)},f.prototype.createAnswer=function(){var t=this;if(t._isClosed)return Promise.reject(o("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==t.signalingState&&"have-local-pranswer"!==t.signalingState)return Promise.reject(o("InvalidStateError","Can not call createAnswer in signalingState "+t.signalingState));var n=e.writeSessionBoilerplate(t._sdpSessionId,t._sdpSessionVersion++);t.usingBundle&&(n+="a=group:BUNDLE "+t.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),n+="a=ice-options:trickle\r\n";var i=e.getMediaSections(t._remoteDescription.sdp).length;t.transceivers.forEach(function(e,s){if(!(s+1>i)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?n+="m=application 0 DTLS/SCTP 5000\r\n":n+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?n+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(n+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(n+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var o;if(e.stream)"audio"===e.kind?o=e.stream.getAudioTracks()[0]:"video"===e.kind&&(o=e.stream.getVideoTracks()[0]),o&&d>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var c=a(e.localCapabilities,e.remoteCapabilities);!c.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,n+=r(e,c,"answer",e.stream,t._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(n+="a=rtcp-rsize\r\n")}});var s=new c.RTCSessionDescription({type:"answer",sdp:n});return Promise.resolve(s)},f.prototype.addIceCandidate=function(t){var r,n=this;return t&&void 0===t.sdpMLineIndex&&!t.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(a,i){if(!n._remoteDescription)return i(o("InvalidStateError","Can not add ICE candidate without a remote description"));if(t&&""!==t.candidate){var c=t.sdpMLineIndex;if(t.sdpMid)for(var d=0;d<n.transceivers.length;d++)if(n.transceivers[d].mid===t.sdpMid){c=d;break}var p=n.transceivers[c];if(!p)return i(o("OperationError","Can not add ICE candidate"));if(p.rejected)return a();var l=Object.keys(t.candidate).length>0?e.parseCandidate(t.candidate):{};if("tcp"===l.protocol&&(0===l.port||9===l.port))return a();if(l.component&&1!==l.component)return a();if((0===c||c>0&&p.iceTransport!==n.transceivers[0].iceTransport)&&!s(p.iceTransport,l))return i(o("OperationError","Can not add ICE candidate"));var f=t.candidate.trim();0===f.indexOf("a=")&&(f=f.substr(2)),(r=e.getMediaSections(n._remoteDescription.sdp))[c]+="a="+(l.type?f:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=e.getDescription(n._remoteDescription.sdp)+r.join("")}else for(var u=0;u<n.transceivers.length&&(n.transceivers[u].rejected||(n.transceivers[u].iceTransport.addRemoteCandidate({}),(r=e.getMediaSections(n._remoteDescription.sdp))[u]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=e.getDescription(n._remoteDescription.sdp)+r.join(""),!n.usingBundle));u++);a()})},f.prototype.getStats=function(e){if(e&&e instanceof c.MediaStreamTrack){var t=null;if(this.transceivers.forEach(function(r){r.rtpSender&&r.rtpSender.track===e?t=r.rtpSender:r.rtpReceiver&&r.rtpReceiver.track===e&&(t=r.rtpReceiver)}),!t)throw o("InvalidAccessError","Invalid selector.");return t.getStats()}var r=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&r.push(e[t].getStats())})}),Promise.all(r).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(e){var r=c[e];if(r&&r.prototype&&r.prototype.getStats){var n=r.prototype.getStats;r.prototype.getStats=function(){return n.apply(this).then(function(e){var r=new Map;return Object.keys(e).forEach(function(n){e[n].type=t(e[n]),r.set(n,e[n])}),r})}}});var u=["createOffer","createAnswer"];return u.forEach(function(e){var t=f.prototype[e];f.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t.apply(this,arguments)}}),(u=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var t=f.prototype[e];f.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&e[2].apply(null,[t])}):t.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=f.prototype[e];f.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),f};
},{"sdp":"jIWI"}],"uWR5":[function(require,module,exports) {
"use strict";function e(e){var r=e&&e.navigator,t=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return t(e).catch(function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimGetUserMedia=e;
},{}],"zgJ4":[function(require,module,exports) {
"use strict";function e(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimGetDisplayMedia=e;
},{}],"F7IB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),Object.defineProperty(exports,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}}),exports.shimPeerConnection=p,exports.shimReplaceTrack=s;var e=c(require("../utils")),t=require("./filtericeservers"),r=o(require("rtcpeerconnection-shim")),n=require("./getusermedia"),i=require("./getdisplaymedia");function o(e){return e&&e.__esModule?e:{default:e}}function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}function c(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var c=i?Object.getOwnPropertyDescriptor(e,o):null;c&&(c.get||c.set)?Object.defineProperty(n,o,c):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function p(n,i){if(n.RTCIceGatherer&&(n.RTCIceCandidate||(n.RTCIceCandidate=function(e){return e}),n.RTCSessionDescription||(n.RTCSessionDescription=function(e){return e}),i.version<15025)){var o=Object.getOwnPropertyDescriptor(n.MediaStreamTrack.prototype,"enabled");Object.defineProperty(n.MediaStreamTrack.prototype,"enabled",{set:function(e){o.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!n.RTCRtpSender||"dtmf"in n.RTCRtpSender.prototype||Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new n.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),n.RTCDtmfSender&&!n.RTCDTMFSender&&(n.RTCDTMFSender=n.RTCDtmfSender);var a=(0,r.default)(n,i.version);n.RTCPeerConnection=function(r){return r&&r.iceServers&&(r.iceServers=(0,t.filterIceServers)(r.iceServers,i.version),e.log("ICE servers after filtering:",r.iceServers)),new a(r)},n.RTCPeerConnection.prototype=a.prototype}function s(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}
},{"../utils":"RsyN","./filtericeservers":"uuCd","rtcpeerconnection-shim":"heG5","./getusermedia":"uWR5","./getdisplaymedia":"zgJ4"}],"OQLX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimGetUserMedia=n;var e=o(require("../utils"));function t(e){if("function"!=typeof WeakMap)return null;var o=new WeakMap,r=new WeakMap;return(t=function(e){return e?r:o})(e)}function o(e,o){if(!o&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=t(o);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(t,o){var n=t&&t.navigator,i=t&&t.MediaStreamTrack;if(n.getUserMedia=function(t,o,r){e.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(t).then(o,r)},!(o.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(e,t,o){t in e&&!(o in e)&&(e[o]=e[t],delete e[t])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===r(e)&&"object"===r(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},i&&i.prototype.getSettings){var p=i.prototype.getSettings;i.prototype.getSettings=function(){var e=p.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(i&&i.prototype.applyConstraints){var u=i.prototype.applyConstraints;i.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===r(e)&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[e])}}}}
},{"../utils":"RsyN"}],"Hsc4":[function(require,module,exports) {
"use strict";function e(e,i){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(a){if(!a||!a.video){var t=new DOMException("getDisplayMedia without video constraints is undefined");return t.name="NotFoundError",t.code=8,Promise.reject(t)}return!0===a.video?a.video={mediaSource:i}:a.video.mediaSource=i,e.navigator.mediaDevices.getUserMedia(a)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimGetDisplayMedia=e;
},{}],"vPl0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimAddTransceiver=m,exports.shimCreateAnswer=R,exports.shimCreateOffer=h,Object.defineProperty(exports,"shimGetDisplayMedia",{enumerable:!0,get:function(){return n.shimGetDisplayMedia}}),exports.shimGetParameters=y,Object.defineProperty(exports,"shimGetUserMedia",{enumerable:!0,get:function(){return t.shimGetUserMedia}}),exports.shimOnTrack=p,exports.shimPeerConnection=u,exports.shimRTCDataChannel=l,exports.shimReceiverGetStats=d,exports.shimRemoveStream=C,exports.shimSenderGetStats=f;var e=o(require("../utils")),t=require("./getusermedia"),n=require("./getdisplaymedia");function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}function o(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(o,a,s):o[a]=e[a]}return o.default=e,n&&n.set(e,o),o}function i(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){var t=s(e,"string");return"symbol"===c(t)?t:String(t)}function s(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e){"object"===c(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function u(e,t){if("object"===c(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t],r=i({},t,function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=r[t]});var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var[e,o,i]=arguments;return r.apply(this,[e||null]).then(function(e){if(t.version<53&&!o)try{e.forEach(function(e){e.type=n[e.type]||e.type})}catch(r){if("TypeError"!==r.name)throw r;e.forEach(function(t,r){e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(o,i)}}}function f(e){if("object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach(function(t){return t._pc=e}),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function d(t){if("object"===c(t)&&t.RTCPeerConnection&&t.RTCRtpSender&&!(t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)){var n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=n.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t}),e.wrapPeerConnectionEvent(t,"track",function(e){return e.receiver._pc=e.srcElement,e}),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function C(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(t){var n=this;e.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(e){e.track&&t.getTracks().includes(e.track)&&n.removeTrack(e)})})}function l(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function m(e){if("object"===c(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach(function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});var r=t.apply(this,arguments);if(n){var{sender:o}=r,i=o.getParameters();"encodings"in i&&(1!==i.encodings.length||0!==Object.keys(i.encodings[0]).length)||(i.encodings=e.sendEncodings,o.sendEncodings=e.sendEncodings,this.setParametersPromises.push(o.setParameters(i).then(function(){delete o.sendEncodings}).catch(function(){delete o.sendEncodings})))}return r})}}function y(e){if("object"===c(e)&&e.RTCRtpSender){var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}}function h(e){if("object"===c(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return t.apply(n,e)}).finally(function(){n.setParametersPromises=[]}):t.apply(this,arguments)}}}function R(e){if("object"===c(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return t.apply(n,e)}).finally(function(){n.setParametersPromises=[]}):t.apply(this,arguments)}}}
},{"../utils":"RsyN","./getusermedia":"OQLX","./getdisplaymedia":"Hsc4"}],"aXmZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimAudioContext=u,exports.shimCallbacksAPI=a,exports.shimConstraints=s,exports.shimCreateOfferLegacy=p,exports.shimGetUserMedia=c,exports.shimLocalStreamsAPI=n,exports.shimRTCIceServerUrls=d,exports.shimRemoteStreamsAPI=i,exports.shimTrackEventTransceiver=f;var e=r(require("../utils"));function t(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,o=new WeakMap;return(t=function(e){return e?o:r})(e)}function r(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var o=t(r);if(o&&o.has(e))return o.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=i?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(n,a,c):n[a]=e[a]}return n.default=e,o&&o.set(e,n),n}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){if("object"===o(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(function(o){return t.call(r,o,e)}),e.getVideoTracks().forEach(function(o){return t.call(r,o,e)})},e.RTCPeerConnection.prototype.addTrack=function(e){for(var r=this,o=arguments.length,n=new Array(o>1?o-1:0),i=1;i<o;i++)n[i-1]=arguments[i];return n&&n.forEach(function(e){r._localStreams?r._localStreams.includes(e)||r._localStreams.push(e):r._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var o=e.getTracks();this.getSenders().forEach(function(e){o.includes(e.track)&&t.removeTrack(e)})}})}}function i(e){if("object"===o(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}})})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}})}),t.apply(e,arguments)}}}function a(e){if("object"===o(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,a=t.setRemoteDescription,c=t.addIceCandidate;t.createOffer=function(e,t){var o=arguments.length>=2?arguments[2]:arguments[0],n=r.apply(this,[o]);return t?(n.then(e,t),Promise.resolve()):n},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],o=n.apply(this,[r]);return t?(o.then(e,t),Promise.resolve()):o};var s=function(e,t,r){var o=i.apply(this,[e]);return r?(o.then(t,r),Promise.resolve()):o};t.setLocalDescription=s,s=function(e,t,r){var o=a.apply(this,[e]);return r?(o.then(t,r),Promise.resolve()):o},t.setRemoteDescription=s,s=function(e,t,r){var o=c.apply(this,[e]);return r?(o.then(t,r),Promise.resolve()):o},t.addIceCandidate=s}}function c(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,o=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return o(s(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,o){t.mediaDevices.getUserMedia(e).then(r,o)}.bind(t))}function s(t){return t&&void 0!==t.video?Object.assign({},t,{video:e.compactObject(t.video)}):t}function d(t){if(t.RTCPeerConnection){var r=t.RTCPeerConnection;t.RTCPeerConnection=function(t,o){if(t&&t.iceServers){for(var n=[],i=0;i<t.iceServers.length;i++){var a=t.iceServers[i];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(e.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,n.push(a)):n.push(t.iceServers[i])}t.iceServers=n}return new r(t,o)},t.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in r&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function(){return r.generateCertificate}})}}function f(e){"object"===o(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function p(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var o=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind});!1===e.offerToReceiveVideo&&o?"sendrecv"===o.direction?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":"recvonly"===o.direction&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):!0!==e.offerToReceiveVideo||o||this.addTransceiver("video")}return t.apply(this,arguments)}}function u(e){"object"!==o(e)||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}
},{"../utils":"RsyN"}],"WlzA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.removeExtmapAllowMixed=d,exports.shimAddIceCandidateNullOrEmpty=u,exports.shimConnectionState=p,exports.shimMaxMessageSize=c,exports.shimRTCIceCandidate=a,exports.shimSendThrowTypeError=s;var e=r(require("sdp")),t=o(require("./utils"));function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,o=new WeakMap;return(n=function(e){return e?o:t})(e)}function o(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var o=n(t);if(o&&o.has(e))return o.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=i?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,o&&o.set(e,r),r}function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(n){if(n.RTCIceCandidate&&!(n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)){var o=n.RTCIceCandidate;n.RTCIceCandidate=function(t){if("object"===i(t)&&t.candidate&&0===t.candidate.indexOf("a=")&&((t=JSON.parse(JSON.stringify(t))).candidate=t.candidate.substr(2)),t.candidate&&t.candidate.length){var n=new o(t),r=e.default.parseCandidate(t.candidate),a=Object.assign(n,r);return a.toJSON=function(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new o(t)},n.RTCIceCandidate.prototype=o.prototype,t.wrapPeerConnectionEvent(n,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new n.RTCIceCandidate(e.candidate),writable:"false"}),e})}}function c(t,n){if(t.RTCPeerConnection){"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var o=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===n.browser&&n.version>=76){var{sdpSemantics:t}=this.getConfiguration();"plan-b"===t&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(t){if(!t||!t.sdp)return!1;var n=e.default.splitSections(t.sdp);return n.shift(),n.some(function(t){var n=e.default.parseMLine(t);return n&&"application"===n.kind&&-1!==n.protocol.indexOf("SCTP")})}(arguments[0])){var r,i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),a=(p=i,d=65536,"firefox"===n.browser&&(d=n.version<57?-1===p?16384:2147483637:n.version<60?57===n.version?65535:65536:2147483637),d),c=function(t,o){var r=65536;"firefox"===n.browser&&57===n.version&&(r=65535);var i=e.default.matchPrefix(t.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===n.browser&&-1!==o&&(r=2147483637),r}(arguments[0],i);r=0===a&&0===c?Number.POSITIVE_INFINITY:0===a||0===c?Math.max(a,c):Math.min(a,c);var s={};Object.defineProperty(s,"maxMessageSize",{get:function(){return r}}),this._sctp=s}var p,d;return o.apply(this,arguments)}}}function s(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=n.apply(this,arguments);return o(e,this),e},t.wrapPeerConnectionEvent(e,"datachannel",function(e){return o(e.channel,e.target),e})}function o(e,t){var n=e.send;e.send=function(){var o=arguments[0],r=o.length||o.size||o.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}}function p(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}}function d(e,t){if(e.RTCPeerConnection&&!("chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var o=t.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:o}):t.sdp=o}return n.apply(this,arguments)}}}function u(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}}
},{"sdp":"jIWI","./utils":"RsyN"}],"elb5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.adapterFactory=o;var e=m(require("./utils")),i=m(require("./chrome/chrome_shim")),r=m(require("./edge/edge_shim")),s=m(require("./firefox/firefox_shim")),t=m(require("./safari/safari_shim")),a=m(require("./common_shim"));function n(e){if("function"!=typeof WeakMap)return null;var i=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:i})(e)}function m(e,i){if(!i&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(i);if(r&&r.has(e))return r.get(e);var s={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var m=t?Object.getOwnPropertyDescriptor(e,a):null;m&&(m.get||m.set)?Object.defineProperty(s,a,m):s[a]=e[a]}return s.default=e,r&&r.set(e,s),s}function o(){var{window:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},o=e.log,h=e.detectBrowser(n),d={browserDetails:h,commonShim:a,extractVersion:e.extractVersion,disableLog:e.disableLog,disableWarnings:e.disableWarnings};switch(h.browser){case"chrome":if(!i||!i.shimPeerConnection||!m.shimChrome)return o("Chrome shim is not included in this adapter release."),d;if(null===h.version)return o("Chrome shim can not determine version, not shimming."),d;o("adapter.js shimming chrome."),d.browserShim=i,a.shimAddIceCandidateNullOrEmpty(n,h),i.shimGetUserMedia(n,h),i.shimMediaStream(n,h),i.shimPeerConnection(n,h),i.shimOnTrack(n,h),i.shimAddTrackRemoveTrack(n,h),i.shimGetSendersWithDtmf(n,h),i.shimGetStats(n,h),i.shimSenderReceiverGetStats(n,h),i.fixNegotiationNeeded(n,h),a.shimRTCIceCandidate(n,h),a.shimConnectionState(n,h),a.shimMaxMessageSize(n,h),a.shimSendThrowTypeError(n,h),a.removeExtmapAllowMixed(n,h);break;case"firefox":if(!s||!s.shimPeerConnection||!m.shimFirefox)return o("Firefox shim is not included in this adapter release."),d;o("adapter.js shimming firefox."),d.browserShim=s,a.shimAddIceCandidateNullOrEmpty(n,h),s.shimGetUserMedia(n,h),s.shimPeerConnection(n,h),s.shimOnTrack(n,h),s.shimRemoveStream(n,h),s.shimSenderGetStats(n,h),s.shimReceiverGetStats(n,h),s.shimRTCDataChannel(n,h),s.shimAddTransceiver(n,h),s.shimGetParameters(n,h),s.shimCreateOffer(n,h),s.shimCreateAnswer(n,h),a.shimRTCIceCandidate(n,h),a.shimConnectionState(n,h),a.shimMaxMessageSize(n,h),a.shimSendThrowTypeError(n,h);break;case"edge":if(!r||!r.shimPeerConnection||!m.shimEdge)return o("MS edge shim is not included in this adapter release."),d;o("adapter.js shimming edge."),d.browserShim=r,r.shimGetUserMedia(n,h),r.shimGetDisplayMedia(n,h),r.shimPeerConnection(n,h),r.shimReplaceTrack(n,h),a.shimMaxMessageSize(n,h),a.shimSendThrowTypeError(n,h);break;case"safari":if(!t||!m.shimSafari)return o("Safari shim is not included in this adapter release."),d;o("adapter.js shimming safari."),d.browserShim=t,a.shimAddIceCandidateNullOrEmpty(n,h),t.shimRTCIceServerUrls(n,h),t.shimCreateOfferLegacy(n,h),t.shimCallbacksAPI(n,h),t.shimLocalStreamsAPI(n,h),t.shimRemoteStreamsAPI(n,h),t.shimTrackEventTransceiver(n,h),t.shimGetUserMedia(n,h),t.shimAudioContext(n,h),a.shimRTCIceCandidate(n,h),a.shimMaxMessageSize(n,h),a.shimSendThrowTypeError(n,h),a.removeExtmapAllowMixed(n,h);break;default:o("Unsupported browser!")}return d}
},{"./utils":"RsyN","./chrome/chrome_shim":"RNlo","./edge/edge_shim":"F7IB","./firefox/firefox_shim":"vPl0","./safari/safari_shim":"aXmZ","./common_shim":"WlzA"}],"WzOL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("./adapter_factory.js"),t=(0,e.adapterFactory)({window:"undefined"==typeof window?void 0:window}),d=t;exports.default=d;
},{"./adapter_factory.js":"elb5"}],"auwL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.protocolVersion=exports.version=void 0,exports.version="0.14.3",exports.protocolVersion=5;
},{}],"G7lO":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))(function(o,i){function r(e){try{c(s.next(e))}catch(t){i(t)}}function a(e){try{c(s.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,a)}c((s=s.apply(e,t||[])).next())})},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.WSSignalClient=void 0,require("webrtc-adapter");const n=t(require("../logger")),s=require("../proto/livekit_rtc"),o=require("../room/errors"),i=require("../version");class r{constructor(e=!1){this.isConnected=!1,this.useJSON=e}join(t,n,s){return e(this,void 0,void 0,function*(){return yield this.connect(t,n,{autoSubscribe:null==s?void 0:s.autoSubscribe})})}reconnect(t,n){return e(this,void 0,void 0,function*(){yield this.connect(t,n,{reconnect:!0})})}connect(t,r,a){t.startsWith("http")&&(t=t.replace("http","ws")),t=t.replace(/\/$/,""),t+="/rtc";let c=`?access_token=${r}&protocol=${i.protocolVersion}&sdk=js&version=${i.version}`;return a.reconnect&&(c+="&reconnect=1"),void 0!==a.autoSubscribe&&(c+=`&auto_subscribe=${a.autoSubscribe?"1":"0"}`),new Promise((i,r)=>{n.default.debug("connecting to",t+c),this.ws=void 0;const d=new WebSocket(t+c);d.binaryType="arraybuffer",d.onerror=(n=>e(this,void 0,void 0,function*(){if(this.ws)this.handleWSError(n);else try{const n=yield fetch(`http${t.substr(2)}/validate${c}`);if(n.ok)r(new o.ConnectionError("Internal error"));else{const e=yield n.text();r(new o.ConnectionError(e))}}catch(e){r(new o.ConnectionError("server was not reachable"))}})),d.onopen=(()=>{this.ws=d,a.reconnect&&(this.isConnected=!0,i())}),d.onmessage=(e=>{let t;if("string"==typeof e.data){const n=JSON.parse(e.data);t=s.SignalResponse.fromJSON(n)}else{if(!(e.data instanceof ArrayBuffer))return void n.default.error("could not decode websocket message",typeof e.data);t=s.SignalResponse.decode(new Uint8Array(e.data))}this.isConnected?this.handleSignalResponse(t):t.join?(this.isConnected=!0,i(t.join)):r(new o.ConnectionError("did not receive join response"))}),d.onclose=(e=>{this.isConnected&&(n.default.debug("websocket connection closed",e.reason),this.isConnected=!1,this.onClose&&this.onClose(e.reason))})})}close(){var e;this.isConnected=!1,this.ws&&(this.ws.onclose=null),null===(e=this.ws)||void 0===e||e.close()}sendOffer(e){n.default.debug("sending offer",e),this.sendRequest({offer:c(e)})}sendAnswer(e){n.default.debug("sending answer"),this.sendRequest({answer:c(e)})}sendIceCandidate(e,t){n.default.debug("sending ice candidate",e),this.sendRequest({trickle:{candidateInit:JSON.stringify(e),target:t}})}sendMuteTrack(e,t){this.sendRequest({mute:{sid:e,muted:t}})}sendAddTrack(e){this.sendRequest({addTrack:s.AddTrackRequest.fromPartial(e)})}sendUpdateTrackSettings(e){this.sendRequest({trackSetting:e})}sendUpdateSubscription(e){this.sendRequest({subscription:e})}sendLeave(){this.sendRequest(s.SignalRequest.fromPartial({leave:{}}))}sendRequest(e){if(!this.ws)throw new o.ConnectionError("cannot send signal request before connected");this.useJSON?this.ws.send(JSON.stringify(s.SignalRequest.toJSON(e))):this.ws.send(s.SignalRequest.encode(e).finish())}handleSignalResponse(e){if(e.answer){const t=a(e.answer);this.onAnswer&&this.onAnswer(t)}else if(e.offer){const t=a(e.offer);this.onOffer&&this.onOffer(t)}else if(e.trickle){const t=JSON.parse(e.trickle.candidateInit);this.onTrickle&&this.onTrickle(t,e.trickle.target)}else e.update?this.onParticipantUpdate&&this.onParticipantUpdate(e.update.participants):e.trackPublished?this.onLocalTrackPublished&&this.onLocalTrackPublished(e.trackPublished):e.speakersChanged?this.onSpeakersChanged&&this.onSpeakersChanged(e.speakersChanged.speakers):e.leave?this.onLeave&&this.onLeave():e.mute?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(e.mute.sid,e.mute.muted):e.roomUpdate?this.onRoomUpdate&&this.onRoomUpdate(e.roomUpdate.room):e.connectionQuality?this.onConnectionQuality&&this.onConnectionQuality(e.connectionQuality):n.default.debug("unsupported message",e)}handleWSError(e){n.default.error("websocket error",e)}}function a(e){const t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type}return t}function c(e){return{sdp:e.sdp,type:e.type}}exports.WSSignalClient=r;
},{"webrtc-adapter":"WzOL","../logger":"mQuM","../proto/livekit_rtc":"Jka9","../room/errors":"k3b3","../version":"auwL"}],"GfX1":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.LogLevel=void 0,function(e){e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.silent="silent"}(e=exports.LogLevel||(exports.LogLevel={}));
},{}],"RZTP":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,i,r,t){return new(r||(r=Promise))(function(o,a){function n(e){try{u(t.next(e))}catch(i){a(i)}}function c(e){try{u(t.throw(e))}catch(i){a(i)}}function u(e){var i;e.done?o(e.value):(i=e.value,i instanceof r?i:new r(function(e){e(i)})).then(n,c)}u((t=t.apply(e,i||[])).next())})},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.connect=exports.version=void 0;const r=require("./api/SignalClient"),t=i(require("./logger")),o=require("./options"),a=require("./room/errors"),n=require("./room/events"),c=i(require("./room/Room")),u=require("./room/track/create"),l=require("./room/track/Track");var s=require("./version");function d(i,s,d){var v;return e(this,void 0,void 0,function*(){d||(d={}),d.logLevel||(d.logLevel=o.LogLevel.info),void 0===d.audio&&(d.audio=!1),void 0===d.video&&(d.video=!1),t.default.setLevel(d.logLevel);const f=null!==(v=d.rtcConfig)&&void 0!==v?v:{};d.iceServers&&(f.iceServers=d.iceServers);const p=new r.WSSignalClient,h=new c.default(p,{rtcConfig:d.rtcConfig,autoManageVideo:d.autoManageVideo});yield h.connect(i,s,{autoSubscribe:null==d?void 0:d.autoSubscribe}),d.publishDefaults&&Object.assign(h.defaultPublishOptions,d.publishDefaults),d.captureDefaults&&Object.assign(h.defaultCaptureOptions,d.captureDefaults);const g=d.audio,m=d.video,b=[];return g&&b.push(l.Track.Source.Microphone),m&&b.push(l.Track.Source.Camera),b.forEach(e=>h.localParticipant.pendingPublishing.add(e)),(g||m)&&setTimeout(()=>e(this,void 0,void 0,function*(){let e;try{e=yield u.createLocalTracks({audio:g,video:m})}catch(i){const o=a.MediaDeviceFailure.getFailure(i);if(t.default.warn("received error while creating media",o),i instanceof Error&&t.default.warn(i.message),(o===a.MediaDeviceFailure.NotFound||o===a.MediaDeviceFailure.DeviceInUse)&&g&&m)try{e=yield u.createLocalTracks({audio:g,video:!1})}catch(r){}if(!e)return h.emit(n.RoomEvent.MediaDevicesError,i),t.default.error("could not create media",i),void b.forEach(e=>h.localParticipant.pendingPublishing.delete(e))}try{yield Promise.all(e.map(e=>h.localParticipant.publishTrack(e)))}finally{b.forEach(e=>h.localParticipant.pendingPublishing.delete(e))}})),h})}Object.defineProperty(exports,"version",{enumerable:!0,get:function(){return s.version}}),exports.connect=d;
},{"./api/SignalClient":"G7lO","./logger":"mQuM","./options":"GfX1","./room/errors":"k3b3","./room/events":"q9Tz","./room/Room":"WwD1","./room/track/create":"JpFY","./room/track/Track":"UBMR","./version":"auwL"}],"bjh5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});
},{}],"GkDQ":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),t=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var o={};if(null!=r)for(var a in r)"default"!==a&&Object.prototype.hasOwnProperty.call(r,a)&&e(o,r,a);return t(o,r),o},o=this&&this.__exportStar||function(t,r){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(r,o)||e(r,t,o)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.VideoQuality=exports.TrackPublication=exports.RemoteTrackPublication=exports.RemoteVideoTrack=exports.RemoteAudioTrack=exports.LocalTrackPublication=exports.LocalTrack=exports.LocalVideoTrack=exports.LocalAudioTrack=exports.LocalParticipant=exports.RemoteParticipant=exports.Participant=exports.ConnectionQuality=exports.DataPacket_Kind=exports.RoomState=exports.Room=void 0;const i=require("./proto/livekit_models");Object.defineProperty(exports,"DataPacket_Kind",{enumerable:!0,get:function(){return i.DataPacket_Kind}});const c=require("./proto/livekit_rtc");Object.defineProperty(exports,"VideoQuality",{enumerable:!0,get:function(){return c.VideoQuality}});const n=a(require("./room/participant/LocalParticipant"));exports.LocalParticipant=n.default;const u=r(require("./room/participant/Participant"));exports.Participant=u.default,Object.defineProperty(exports,"ConnectionQuality",{enumerable:!0,get:function(){return u.ConnectionQuality}});const s=a(require("./room/participant/RemoteParticipant"));exports.RemoteParticipant=s.default;const p=r(require("./room/Room"));exports.Room=p.default,Object.defineProperty(exports,"RoomState",{enumerable:!0,get:function(){return p.RoomState}});const l=a(require("./room/track/LocalAudioTrack"));exports.LocalAudioTrack=l.default;const d=a(require("./room/track/LocalTrack"));exports.LocalTrack=d.default;const m=a(require("./room/track/LocalTrackPublication"));exports.LocalTrackPublication=m.default;const x=a(require("./room/track/LocalVideoTrack"));exports.LocalVideoTrack=x.default;const f=a(require("./room/track/RemoteAudioTrack"));exports.RemoteAudioTrack=f.default;const k=a(require("./room/track/RemoteTrackPublication"));exports.RemoteTrackPublication=k.default;const P=a(require("./room/track/RemoteVideoTrack"));exports.RemoteVideoTrack=P.default;const b=a(require("./room/track/TrackPublication"));exports.TrackPublication=b.default,o(require("./connect"),exports),o(require("./options"),exports),o(require("./room/errors"),exports),o(require("./room/events"),exports),o(require("./room/track/create"),exports),o(require("./room/track/options"),exports),o(require("./room/track/Track"),exports),o(require("./room/track/types"),exports),o(require("./version"),exports);
},{"./proto/livekit_models":"OxfL","./proto/livekit_rtc":"Jka9","./room/participant/LocalParticipant":"n9xZ","./room/participant/Participant":"qfmo","./room/participant/RemoteParticipant":"gZZ1","./room/Room":"WwD1","./room/track/LocalAudioTrack":"fkZQ","./room/track/LocalTrack":"Tqjs","./room/track/LocalTrackPublication":"iXhr","./room/track/LocalVideoTrack":"KIm9","./room/track/RemoteAudioTrack":"GW7Y","./room/track/RemoteTrackPublication":"aNnA","./room/track/RemoteVideoTrack":"q4mV","./room/track/TrackPublication":"vflL","./connect":"RZTP","./options":"GfX1","./room/errors":"k3b3","./room/events":"q9Tz","./room/track/create":"JpFY","./room/track/options":"ZNBW","./room/track/Track":"UBMR","./room/track/types":"bjh5","./version":"auwL"}],"H99C":[function(require,module,exports) {
"use strict";require("./styles.css");var t=require("livekit-client");function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(){r=function(){return t};var t={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(I){f=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),c=new O(n||[]);return i(a,"_invoke",{value:E(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(I){return{type:"throw",arg:I}}}t.wrap=s;var p={};function v(){}function y(){}function d(){}var m={};f(m,c,function(){return this});var g=Object.getPrototypeOf,w=g&&g(g(_([])));w&&w!==n&&o.call(w,c)&&(m=w);var b=d.prototype=v.prototype=Object.create(m);function x(t){["next","throw","return"].forEach(function(e){f(t,e,function(t){return this._invoke(e,t)})})}function L(t,r){var n;i(this,"_invoke",{value:function(i,a){function c(){return new r(function(n,c){!function n(i,a,c,u){var l=h(t[i],t,a);if("throw"!==l.type){var f=l.arg,s=f.value;return s&&"object"==e(s)&&o.call(s,"__await")?r.resolve(s.__await).then(function(t){n("next",t,c,u)},function(t){n("throw",t,c,u)}):r.resolve(s).then(function(t){f.value=t,c(f)},function(t){return n("throw",t,c,u)})}u(l.arg)}(i,a,n,c)})}return n=n?n.then(c,c):c()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return P()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=k(a,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=h(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function k(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function _(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return y.prototype=d,i(b,"constructor",{value:d,configurable:!0}),i(d,"constructor",{value:y,configurable:!0}),y.displayName=f(d,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,f(t,l,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},x(L.prototype),f(L.prototype,u,function(){return this}),t.AsyncIterator=L,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new L(s(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},x(b),f(b,l,"Generator"),f(b,c,function(){return this}),f(b,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function n(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=o(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return c=t.done,t},e:function(t){u=!0,a=t},f:function(){try{c||null==r.return||r.return()}finally{if(u)throw a}}}}function o(t,e){if(t){if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(l){return void r(l)}c.done?e(u):Promise.resolve(u).then(n,o)}function c(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function c(t){a(i,n,o,c,u,"next",t)}function u(t){a(i,n,o,c,u,"throw",t)}c(void 0)})}}function u(){return l.apply(this,arguments)}function l(){return(l=c(r().mark(function e(){var o,i,a,c,u,l,s;return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=document.getElementById("jwt").value,console.log(o),"wss://livekit.mux.dev",e.next=5,(0,t.connect)("wss://livekit.mux.dev",o);case 5:return(i=e.sent).on(t.RoomEvent.TrackSubscribed,function(t,e,r){console.log("Participant Subscribed"),f(t,r)}),e.next=9,(0,t.createLocalTracks)({audio:!0,video:!0});case 9:a=e.sent,c=n(a),e.prev=11,c.s();case 13:if((u=c.n()).done){e.next=22;break}return l=u.value,e.next=17,i.localParticipant.publishTrack(l);case 17:console.log("Publishing Track"),console.log(l),"video"===l.kind&&(s=document.getElementById("us"),l.attach(s));case 20:e.next=13;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(11),c.e(e.t0);case 27:return e.prev=27,c.f(),e.finish(27);case 30:case"end":return e.stop()}},e,null,[[11,24,27,30]])}))).apply(this,arguments)}function f(t,e){var r=document.getElementById("them");t.attach(r)}document.getElementById("connect").addEventListener("click",function(t){u()});
},{"./styles.css":"D9Nj","livekit-client":"GkDQ"}]},{},["H99C"], null)
//# sourceMappingURL=/csb-5cl5g4/src.cec5dedc.js.map